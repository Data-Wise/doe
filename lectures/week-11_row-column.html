<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Davood Tofighi, Ph.D.">

<title>Row and Column Designs – STAT 454/545 - Analysis of Variance and Experimental Design</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-1092c56c6cadf2eb47b1bc8063ab382a.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-aff2639e191a0a8d05f4f3608923e904.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<meta property="og:title" content="Row and Column Designs – STAT 454/545 - Analysis of Variance and Experimental Design">
<meta property="og:description" content="Designs with Two Blocking Factors">
<meta property="og:image" content="https://Data-Wise.github.io/doe/lectures/week-11_row-column_files/figure-html/tab-rcbd-diagnostic-plots-example2-1.png">
<meta property="og:site_name" content="STAT 454/545 - Analysis of Variance and Experimental Design">
<meta property="og:image:height" content="960">
<meta property="og:image:width" content="1344">
</head><body class="nav-fixed"><img src="../assets/images/home.png" alt="Course Banner" style="width: 100%; height: auto;">
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&amp;family=Montserrat:wght@400;700&amp;family=Fira+Code:wght@400;700&amp;display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../assets/styles/css/home.css">




<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">STAT 454/545 - Analysis of Variance and Experimental Design</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus/syllabus-final.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_lectures.html"> 
<span class="menu-text">Lecture Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus/schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_assignments.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../contents.html"> 
<span class="menu-text">Contents</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_appendix.html"> 
<span class="menu-text">Appendix</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <h1 class="title">Row and Column Designs</h1>
            <p class="subtitle lead">Designs with Two Blocking Factors</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta column-page-left">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Davood Tofighi, Ph.D. </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">05-Jan-2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="-1">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">Objectives</a></li>
  </ul></li>
  <li><a href="#fundamentals-of-rowcolumn-designs" id="toc-fundamentals-of-rowcolumn-designs" class="nav-link" data-scroll-target="#fundamentals-of-rowcolumn-designs">Fundamentals of Row–Column Designs</a>
  <ul class="collapse">
  <li><a href="#key-concepts" id="toc-key-concepts" class="nav-link" data-scroll-target="#key-concepts">Key Concepts</a>
  <ul class="collapse">
  <li><a href="#rowcolumn-design-structure" id="toc-rowcolumn-design-structure" class="nav-link" data-scroll-target="#rowcolumn-design-structure">Row–Column Design Structure</a></li>
  <li><a href="#blocking-factors" id="toc-blocking-factors" class="nav-link" data-scroll-target="#blocking-factors">Blocking Factors</a></li>
  <li><a href="#advantages" id="toc-advantages" class="nav-link" data-scroll-target="#advantages">Advantages</a></li>
  </ul></li>
  <li><a href="#latin-square-designs" id="toc-latin-square-designs" class="nav-link" data-scroll-target="#latin-square-designs">Latin Square Designs</a>
  <ul class="collapse">
  <li><a href="#definition" id="toc-definition" class="nav-link" data-scroll-target="#definition">Definition</a></li>
  <li><a href="#construction" id="toc-construction" class="nav-link" data-scroll-target="#construction">Construction</a></li>
  <li><a href="#analysis-of-variance-anova" id="toc-analysis-of-variance-anova" class="nav-link" data-scroll-target="#analysis-of-variance-anova">Analysis of Variance (ANOVA)</a></li>
  <li><a href="#example-in-r" id="toc-example-in-r" class="nav-link" data-scroll-target="#example-in-r">Example in R</a></li>
  </ul></li>
  <li><a href="#youden-designs" id="toc-youden-designs" class="nav-link" data-scroll-target="#youden-designs">Youden Designs</a>
  <ul class="collapse">
  <li><a href="#definition-1" id="toc-definition-1" class="nav-link" data-scroll-target="#definition-1">Definition</a></li>
  <li><a href="#construction-1" id="toc-construction-1" class="nav-link" data-scroll-target="#construction-1">Construction</a></li>
  <li><a href="#applications" id="toc-applications" class="nav-link" data-scroll-target="#applications">Applications</a></li>
  <li><a href="#analysis-of-youden-designs" id="toc-analysis-of-youden-designs" class="nav-link" data-scroll-target="#analysis-of-youden-designs">Analysis of Youden Designs</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#analysis-of-variance-for-rowcolumn-designs" id="toc-analysis-of-variance-for-rowcolumn-designs" class="nav-link" data-scroll-target="#analysis-of-variance-for-rowcolumn-designs">Analysis of Variance for Row–Column Designs</a>
  <ul class="collapse">
  <li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model">Model</a>
  <ul class="collapse">
  <li><a href="#key-assumptions" id="toc-key-assumptions" class="nav-link" data-scroll-target="#key-assumptions">Key Assumptions</a></li>
  <li><a href="#anova-table" id="toc-anova-table" class="nav-link" data-scroll-target="#anova-table">ANOVA Table</a></li>
  <li><a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing">Hypothesis Testing</a></li>
  <li><a href="#example-interpretation" id="toc-example-interpretation" class="nav-link" data-scroll-target="#example-interpretation">Example Interpretation</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#practical-extensions" id="toc-practical-extensions" class="nav-link" data-scroll-target="#practical-extensions">Practical Extensions</a>
  <ul class="collapse">
  <li><a href="#factorial-experiments-in-rowcolumn-designs" id="toc-factorial-experiments-in-rowcolumn-designs" class="nav-link" data-scroll-target="#factorial-experiments-in-rowcolumn-designs">Factorial Experiments in Row–Column Designs</a>
  <ul class="collapse">
  <li><a href="#model-with-interaction-terms" id="toc-model-with-interaction-terms" class="nav-link" data-scroll-target="#model-with-interaction-terms">Model with Interaction Terms</a></li>
  <li><a href="#r-example-two-way-factorial-in-rowcolumn-design" id="toc-r-example-two-way-factorial-in-rowcolumn-design" class="nav-link" data-scroll-target="#r-example-two-way-factorial-in-rowcolumn-design">R Example: Two-Way Factorial in Row–Column Design</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#practical-applications" id="toc-practical-applications" class="nav-link" data-scroll-target="#practical-applications">Practical Applications</a>
  <ul class="collapse">
  <li><a href="#example-resting-metabolic-rate" id="toc-example-resting-metabolic-rate" class="nav-link" data-scroll-target="#example-resting-metabolic-rate">Example: Resting Metabolic Rate</a>
  <ul class="collapse">
  <li><a href="#scenario" id="toc-scenario" class="nav-link" data-scroll-target="#scenario">Scenario</a></li>
  <li><a href="#step-by-step-r-code" id="toc-step-by-step-r-code" class="nav-link" data-scroll-target="#step-by-step-r-code">Step-by-Step R Code</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#appendix-advanced-mathematical-derivations" id="toc-appendix-advanced-mathematical-derivations" class="nav-link" data-scroll-target="#appendix-advanced-mathematical-derivations">Appendix: Advanced Mathematical Derivations</a>
  <ul class="collapse">
  <li><a href="#variance-calculations-for-latin-square-designs" id="toc-variance-calculations-for-latin-square-designs" class="nav-link" data-scroll-target="#variance-calculations-for-latin-square-designs">Variance Calculations for Latin Square Designs</a>
  <ul class="collapse">
  <li><a href="#formula" id="toc-formula" class="nav-link" data-scroll-target="#formula">Formula</a></li>
  <li><a href="#derivation" id="toc-derivation" class="nav-link" data-scroll-target="#derivation">Derivation</a></li>
  </ul></li>
  <li><a href="#degrees-of-freedom-in-youden-designs" id="toc-degrees-of-freedom-in-youden-designs" class="nav-link" data-scroll-target="#degrees-of-freedom-in-youden-designs">Degrees of Freedom in Youden Designs</a>
  <ul class="collapse">
  <li><a href="#formula-1" id="toc-formula-1" class="nav-link" data-scroll-target="#formula-1">Formula</a></li>
  <li><a href="#calculation" id="toc-calculation" class="nav-link" data-scroll-target="#calculation">Calculation</a></li>
  </ul></li>
  <li><a href="#proof-of-interaction-contrasts" id="toc-proof-of-interaction-contrasts" class="nav-link" data-scroll-target="#proof-of-interaction-contrasts">Proof of Interaction Contrasts</a>
  <ul class="collapse">
  <li><a href="#interaction-contrasts-measure-deviations-from-additivity" id="toc-interaction-contrasts-measure-deviations-from-additivity" class="nav-link" data-scroll-target="#interaction-contrasts-measure-deviations-from-additivity">Interaction Contrasts Measure Deviations from Additivity</a></li>
  <li><a href="#proof-steps" id="toc-proof-steps" class="nav-link" data-scroll-target="#proof-steps">Proof Steps</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a>
  <ul class="collapse">
  <li><a href="#medium-difficulty" id="toc-medium-difficulty" class="nav-link" data-scroll-target="#medium-difficulty">Medium Difficulty</a>
  <ul class="collapse">
  <li><a href="#two-way-ancova-with-interaction" id="toc-two-way-ancova-with-interaction" class="nav-link" data-scroll-target="#two-way-ancova-with-interaction">1. Two-Way ANCOVA with Interaction</a></li>
  <li><a href="#balloon-data-analysis" id="toc-balloon-data-analysis" class="nav-link" data-scroll-target="#balloon-data-analysis">2. Balloon Data Analysis</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#advanced-topics" id="toc-advanced-topics" class="nav-link" data-scroll-target="#advanced-topics">Advanced Topics</a>
  <ul class="collapse">
  <li><a href="#general-complete-block-designs" id="toc-general-complete-block-designs" class="nav-link" data-scroll-target="#general-complete-block-designs">General Complete Block Designs</a>
  <ul class="collapse">
  <li><a href="#model-1" id="toc-model-1" class="nav-link" data-scroll-target="#model-1">Model</a></li>
  <li><a href="#sample-size-calculations" id="toc-sample-size-calculations" class="nav-link" data-scroll-target="#sample-size-calculations">Sample Size Calculations</a></li>
  </ul></li>
  <li><a href="#handling-block-treatment-interactions" id="toc-handling-block-treatment-interactions" class="nav-link" data-scroll-target="#handling-block-treatment-interactions">Handling Block-Treatment Interactions</a>
  <ul class="collapse">
  <li><a href="#importance-of-interaction-terms" id="toc-importance-of-interaction-terms" class="nav-link" data-scroll-target="#importance-of-interaction-terms">Importance of Interaction Terms</a></li>
  <li><a href="#model-with-interaction" id="toc-model-with-interaction" class="nav-link" data-scroll-target="#model-with-interaction">Model with Interaction</a></li>
  <li><a href="#r-example-testing-for-block-treatment-interaction" id="toc-r-example-testing-for-block-treatment-interaction" class="nav-link" data-scroll-target="#r-example-testing-for-block-treatment-interaction">R Example: Testing for Block-Treatment Interaction</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#exercises-1" id="toc-exercises-1" class="nav-link" data-scroll-target="#exercises-1">Exercises</a>
  <ul class="collapse">
  <li><a href="#medium-difficulty-1" id="toc-medium-difficulty-1" class="nav-link" data-scroll-target="#medium-difficulty-1">Medium Difficulty</a>
  <ul class="collapse">
  <li><a href="#two-way-ancova-with-interaction-1" id="toc-two-way-ancova-with-interaction-1" class="nav-link" data-scroll-target="#two-way-ancova-with-interaction-1">1. Two-Way ANCOVA with Interaction</a></li>
  <li><a href="#balloon-data-analysis-1" id="toc-balloon-data-analysis-1" class="nav-link" data-scroll-target="#balloon-data-analysis-1">2. Balloon Data Analysis</a></li>
  </ul></li>
  <li><a href="#challenging-problems" id="toc-challenging-problems" class="nav-link" data-scroll-target="#challenging-problems">Challenging Problems</a>
  <ul class="collapse">
  <li><a href="#unbalanced-two-factor-ancova-analysis" id="toc-unbalanced-two-factor-ancova-analysis" class="nav-link" data-scroll-target="#unbalanced-two-factor-ancova-analysis">1. Unbalanced Two-Factor ANCOVA Analysis</a></li>
  <li><a href="#three-factor-interaction-interpretation" id="toc-three-factor-interaction-interpretation" class="nav-link" data-scroll-target="#three-factor-interaction-interpretation">2. Three-Factor Interaction Interpretation</a></li>
  <li><a href="#mathematical-proof-of-interaction-contrasts" id="toc-mathematical-proof-of-interaction-contrasts" class="nav-link" data-scroll-target="#mathematical-proof-of-interaction-contrasts">3. Mathematical Proof of Interaction Contrasts</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#appendix-advanced-mathematical-derivations-1" id="toc-appendix-advanced-mathematical-derivations-1" class="nav-link" data-scroll-target="#appendix-advanced-mathematical-derivations-1">Appendix: Advanced Mathematical Derivations</a>
  <ul class="collapse">
  <li><a href="#variance-calculations-for-latin-square-designs-1" id="toc-variance-calculations-for-latin-square-designs-1" class="nav-link" data-scroll-target="#variance-calculations-for-latin-square-designs-1">Variance Calculations for Latin Square Designs</a>
  <ul class="collapse">
  <li><a href="#formula-2" id="toc-formula-2" class="nav-link" data-scroll-target="#formula-2">Formula</a></li>
  <li><a href="#derivation-1" id="toc-derivation-1" class="nav-link" data-scroll-target="#derivation-1">Derivation</a></li>
  </ul></li>
  <li><a href="#degrees-of-freedom-in-youden-designs-1" id="toc-degrees-of-freedom-in-youden-designs-1" class="nav-link" data-scroll-target="#degrees-of-freedom-in-youden-designs-1">Degrees of Freedom in Youden Designs</a>
  <ul class="collapse">
  <li><a href="#formula-3" id="toc-formula-3" class="nav-link" data-scroll-target="#formula-3">Formula</a></li>
  <li><a href="#calculation-1" id="toc-calculation-1" class="nav-link" data-scroll-target="#calculation-1">Calculation</a></li>
  </ul></li>
  <li><a href="#proof-of-interaction-contrasts-1" id="toc-proof-of-interaction-contrasts-1" class="nav-link" data-scroll-target="#proof-of-interaction-contrasts-1">Proof of Interaction Contrasts</a>
  <ul class="collapse">
  <li><a href="#interaction-contrasts-measure-deviations-from-additivity-1" id="toc-interaction-contrasts-measure-deviations-from-additivity-1" class="nav-link" data-scroll-target="#interaction-contrasts-measure-deviations-from-additivity-1">Interaction Contrasts Measure Deviations from Additivity</a></li>
  <li><a href="#proof-steps-1" id="toc-proof-steps-1" class="nav-link" data-scroll-target="#proof-steps-1">Proof Steps</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#appendix-advanced-mathematical-derivations-2" id="toc-appendix-advanced-mathematical-derivations-2" class="nav-link" data-scroll-target="#appendix-advanced-mathematical-derivations-2">Appendix: Advanced Mathematical Derivations</a>
  <ul class="collapse">
  <li><a href="#variance-calculations-for-latin-square-designs-2" id="toc-variance-calculations-for-latin-square-designs-2" class="nav-link" data-scroll-target="#variance-calculations-for-latin-square-designs-2">Variance Calculations for Latin Square Designs</a>
  <ul class="collapse">
  <li><a href="#formula-4" id="toc-formula-4" class="nav-link" data-scroll-target="#formula-4">Formula</a></li>
  <li><a href="#derivation-2" id="toc-derivation-2" class="nav-link" data-scroll-target="#derivation-2">Derivation</a></li>
  </ul></li>
  <li><a href="#degrees-of-freedom-in-youden-designs-2" id="toc-degrees-of-freedom-in-youden-designs-2" class="nav-link" data-scroll-target="#degrees-of-freedom-in-youden-designs-2">Degrees of Freedom in Youden Designs</a>
  <ul class="collapse">
  <li><a href="#formula-5" id="toc-formula-5" class="nav-link" data-scroll-target="#formula-5">Formula</a></li>
  <li><a href="#calculation-2" id="toc-calculation-2" class="nav-link" data-scroll-target="#calculation-2">Calculation</a></li>
  </ul></li>
  <li><a href="#proof-of-interaction-contrasts-2" id="toc-proof-of-interaction-contrasts-2" class="nav-link" data-scroll-target="#proof-of-interaction-contrasts-2">Proof of Interaction Contrasts</a>
  <ul class="collapse">
  <li><a href="#interaction-contrasts-measure-deviations-from-additivity-2" id="toc-interaction-contrasts-measure-deviations-from-additivity-2" class="nav-link" data-scroll-target="#interaction-contrasts-measure-deviations-from-additivity-2">Interaction Contrasts Measure Deviations from Additivity</a></li>
  <li><a href="#proof-steps-2" id="toc-proof-steps-2" class="nav-link" data-scroll-target="#proof-steps-2">Proof Steps</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#appendix-advanced-mathematical-derivations-3" id="toc-appendix-advanced-mathematical-derivations-3" class="nav-link" data-scroll-target="#appendix-advanced-mathematical-derivations-3">Appendix: Advanced Mathematical Derivations</a>
  <ul class="collapse">
  <li><a href="#adjusted-treatment-means" id="toc-adjusted-treatment-means" class="nav-link" data-scroll-target="#adjusted-treatment-means">Adjusted Treatment Means</a>
  <ul class="collapse">
  <li><a href="#derivation-3" id="toc-derivation-3" class="nav-link" data-scroll-target="#derivation-3">Derivation</a></li>
  </ul></li>
  <li><a href="#f-test-for-homogeneity-of-slopes" id="toc-f-test-for-homogeneity-of-slopes" class="nav-link" data-scroll-target="#f-test-for-homogeneity-of-slopes">F-Test for Homogeneity of Slopes</a>
  <ul class="collapse">
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison">Model Comparison</a></li>
  <li><a href="#hypothesis-testing-1" id="toc-hypothesis-testing-1" class="nav-link" data-scroll-target="#hypothesis-testing-1">Hypothesis Testing</a></li>
  <li><a href="#test-procedure" id="toc-test-procedure" class="nav-link" data-scroll-target="#test-procedure">Test Procedure</a></li>
  </ul></li>
  <li><a href="#confidence-intervals-for-higher-order-contrasts" id="toc-confidence-intervals-for-higher-order-contrasts" class="nav-link" data-scroll-target="#confidence-intervals-for-higher-order-contrasts">Confidence Intervals for Higher-Order Contrasts</a>
  <ul class="collapse">
  <li><a href="#formula-6" id="toc-formula-6" class="nav-link" data-scroll-target="#formula-6">Formula</a></li>
  <li><a href="#steps-in-r" id="toc-steps-in-r" class="nav-link" data-scroll-target="#steps-in-r">Steps in R</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#exercises-2" id="toc-exercises-2" class="nav-link" data-scroll-target="#exercises-2">Exercises</a>
  <ul class="collapse">
  <li><a href="#medium-difficulty-2" id="toc-medium-difficulty-2" class="nav-link" data-scroll-target="#medium-difficulty-2">Medium Difficulty</a>
  <ul class="collapse">
  <li><a href="#two-way-ancova-with-interaction-2" id="toc-two-way-ancova-with-interaction-2" class="nav-link" data-scroll-target="#two-way-ancova-with-interaction-2">1. Two-Way ANCOVA with Interaction</a></li>
  <li><a href="#balloon-data-analysis-2" id="toc-balloon-data-analysis-2" class="nav-link" data-scroll-target="#balloon-data-analysis-2">2. Balloon Data Analysis</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content">





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In the realm of experimental design, <strong>Row–Column Designs</strong> serve as an extension of traditional blocking techniques by incorporating two independent blocking factors: <strong>rows</strong> and <strong>columns</strong>. These designs are instrumental in controlling multiple sources of variability, thereby enhancing the precision and efficiency of treatment comparisons. By organizing experimental units into a matrix of rows and columns, Row–Column Designs mitigate the influence of two distinct nuisance factors, enabling clearer insights into the effects of the primary treatments under investigation.</p>
<p><strong>Intuitive Example:</strong> Imagine conducting an agricultural experiment to test different crop varieties. The field is naturally divided into rows and columns due to varying sunlight and soil moisture gradients. By applying each variety once per row and column, you control for these environmental gradients, ensuring that differences in crop performance are attributable to the varieties themselves rather than external factors.</p>
<p>This lecture delves into the structure, analysis, and practical applications of Row–Column Designs, with a focus on specific examples like <strong>Latin Square Designs</strong> and <strong>Youden Designs</strong>. We will explore theoretical foundations, implement analyses using R, and engage with advanced topics to provide a comprehensive understanding suitable for graduate-level studies.</p>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives</h2>
<ol type="1">
<li><strong>Understand</strong> the principles and utility of Row–Column Designs.</li>
<li><strong>Explore</strong> specific examples such as Latin Square and Youden Designs.</li>
<li><strong>Analyze</strong> data using ANOVA tailored for Row–Column Designs.</li>
<li><strong>Extend</strong> designs to accommodate factorial experiments.</li>
<li><strong>Implement</strong> Row–Column Designs in R with step-by-step guidance.</li>
<li><strong>Reinforce</strong> concepts through exercises covering numerical examples, conceptual understanding, and mathematical proofs.</li>
<li><strong>Explore</strong> advanced mathematical derivations and proofs in the Appendix.</li>
</ol>
</section>
</section>
<section id="fundamentals-of-rowcolumn-designs" class="level1">
<h1>Fundamentals of Row–Column Designs</h1>
<section id="key-concepts" class="level2">
<h2 class="anchored" data-anchor-id="key-concepts">Key Concepts</h2>
<section id="rowcolumn-design-structure" class="level3">
<h3 class="anchored" data-anchor-id="rowcolumn-design-structure">Row–Column Design Structure</h3>
<p>A <strong>Row–Column Design</strong> arranges experimental units in a two-dimensional grid comprising rows and columns. Each cell in the grid represents an experimental unit to which a treatment is applied. This design incorporates two independent blocking factors:</p>
<ul>
<li><strong>Rows:</strong> Control for variability along the horizontal dimension.</li>
<li><strong>Columns:</strong> Control for variability along the vertical dimension.</li>
</ul>
<p><strong>Diagram of a 3x3 Latin Square:</strong></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th>Column 1</th>
<th>Column 2</th>
<th>Column 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Row 1</td>
<td>A</td>
<td>B</td>
<td>C</td>
</tr>
<tr class="even">
<td>Row 2</td>
<td>B</td>
<td>C</td>
<td>A</td>
</tr>
<tr class="odd">
<td>Row 3</td>
<td>C</td>
<td>A</td>
<td>B</td>
</tr>
</tbody>
</table>
</section>
<section id="blocking-factors" class="level3">
<h3 class="anchored" data-anchor-id="blocking-factors">Blocking Factors</h3>
<ul>
<li><strong>Row Blocks:</strong> Address systematic variability across rows, such as gradients in environmental conditions.</li>
<li><strong>Column Blocks:</strong> Address systematic variability across columns, such as variations in soil composition.</li>
</ul>
<p><strong>Intuitive Explanation:</strong> Consider a greenhouse experiment where temperature gradients run horizontally and light intensity gradients run vertically. By arranging treatments in a row–column grid, you control for these two sources of environmental variability, ensuring that treatment effects are not confounded with spatial gradients.</p>
</section>
<section id="advantages" class="level3">
<h3 class="anchored" data-anchor-id="advantages">Advantages</h3>
<ol type="1">
<li><strong>Reduced Variability:</strong> By controlling two sources of variability, Row–Column Designs offer greater precision in estimating treatment effects.</li>
<li><strong>Efficiency:</strong> These designs make efficient use of experimental units, especially in small-scale experiments with inherent multidimensional variability.</li>
<li><strong>Flexibility:</strong> They can be extended to accommodate factorial experiments and multiple interactions.</li>
<li><strong>Enhanced Analytical Power:</strong> ANOVA tailored for Row–Column Designs can effectively isolate treatment effects from block effects.</li>
</ol>
<p><strong>Reference:</strong> Montgomery, D. C., Peck, E. A., &amp; Vining, G. G. (2020). <em>Introduction to Linear Regression Analysis</em>. Wiley.</p>
</section>
</section>
<section id="latin-square-designs" class="level2">
<h2 class="anchored" data-anchor-id="latin-square-designs">Latin Square Designs</h2>
<section id="definition" class="level3">
<h3 class="anchored" data-anchor-id="definition">Definition</h3>
<p>A <strong>Latin Square Design</strong> is a specialized type of Row–Column Design where:</p>
<ul>
<li>Each treatment appears exactly once in each row.</li>
<li>Each treatment appears exactly once in each column.</li>
</ul>
<p>This ensures that the design is balanced and controls for both row and column effects effectively.</p>
</section>
<section id="construction" class="level3">
<h3 class="anchored" data-anchor-id="construction">Construction</h3>
<ol type="1">
<li><p><strong>Standard Latin Squares:</strong></p>
<p>For <span class="math inline">\(v = 3\)</span> treatments, a Latin Square can be constructed as follows:</p></li>
</ol>
<p><span class="math display">\[
\begin{array}{|c|c|c|}
   \hline
   A &amp; B &amp; C \\
   \hline
   B &amp; C &amp; A \\
   \hline
   C &amp; A &amp; B \\
   \hline
   \end{array}
\]</span></p>
<ul>
<li><strong>Rows and Columns:</strong> Each treatment <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(C\)</span> appears once per row and column.</li>
</ul>
<ol type="1">
<li><p><strong>Randomization:</strong></p>
<p>To prevent systematic bias, randomize the order of treatments within rows and columns. This can be achieved by randomly permuting the treatment labels for rows and columns.</p></li>
</ol>
</section>
<section id="analysis-of-variance-anova" class="level3">
<h3 class="anchored" data-anchor-id="analysis-of-variance-anova">Analysis of Variance (ANOVA)</h3>
<p>For a Latin Square Design with <span class="math inline">\(v\)</span> treatments, the ANOVA model includes:</p>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \tau_k + \epsilon_{ijk},
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(Y_{ijk}\)</span>: Response for treatment <span class="math inline">\(k\)</span> in row <span class="math inline">\(i\)</span> and column <span class="math inline">\(j\)</span>.</li>
<li><span class="math inline">\(\mu\)</span>: Overall mean.</li>
<li><span class="math inline">\(\alpha_i\)</span>: Effect of row <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\beta_j\)</span>: Effect of column <span class="math inline">\(j\)</span>.</li>
<li><span class="math inline">\(\tau_k\)</span>: Effect of treatment <span class="math inline">\(k\)</span>.</li>
<li><span class="math inline">\(\epsilon_{ijk} \sim N(0, \sigma^2)\)</span>: Random error term.</li>
</ul>
<p><strong>Degrees of Freedom:</strong> - Rows: <span class="math inline">\(v - 1\)</span> - Columns: <span class="math inline">\(v - 1\)</span> - Treatments: <span class="math inline">\(v - 1\)</span> - Error: <span class="math inline">\(v^2 - 2v + 1\)</span></p>
<p><strong>Example ANOVA Table for Latin Square:</strong></p>
<table class="table">
<colgroup>
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th>Source of Variation</th>
<th>Degrees of Freedom</th>
<th>Sum of Squares</th>
<th>Mean Square</th>
<th>F-ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Rows</td>
<td><span class="math inline">\(v - 1\)</span></td>
<td><span class="math inline">\(SS_\text{Rows}\)</span></td>
<td><span class="math inline">\(MS_\text{Rows}\)</span></td>
<td><span class="math inline">\(F = \frac{MS_\text{Rows}}{MS_\text{Error}}\)</span></td>
</tr>
<tr class="even">
<td>Columns</td>
<td><span class="math inline">\(v - 1\)</span></td>
<td><span class="math inline">\(SS_\text{Columns}\)</span></td>
<td><span class="math inline">\(MS_\text{Columns}\)</span></td>
<td><span class="math inline">\(F = \frac{MS_\text{Columns}}{MS_\text{Error}}\)</span></td>
</tr>
<tr class="odd">
<td>Treatments</td>
<td><span class="math inline">\(v - 1\)</span></td>
<td><span class="math inline">\(SS_\text{Treatments}\)</span></td>
<td><span class="math inline">\(MS_\text{Treatments}\)</span></td>
<td><span class="math inline">\(F = \frac{MS_\text{Treatments}}{MS_\text{Error}}\)</span></td>
</tr>
<tr class="even">
<td>Error</td>
<td><span class="math inline">\(v^2 - 2v + 1\)</span></td>
<td><span class="math inline">\(SS_\text{Error}\)</span></td>
<td><span class="math inline">\(MS_\text{Error}\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Total</strong></td>
<td><span class="math inline">\(v^2 - 1\)</span></td>
<td><span class="math inline">\(SS_\text{Total}\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Hypothesis Testing:</strong> - <strong>Null Hypothesis (<span class="math inline">\(H_0\)</span>):</strong> All treatment means are equal (<span class="math inline">\(\tau_k = 0\)</span> for all <span class="math inline">\(k\)</span>). - <strong>Alternative Hypothesis (<span class="math inline">\(H_A\)</span>):</strong> At least one treatment mean differs.</p>
<p><strong>Decision Rule:</strong> Reject <span class="math inline">\(H_0\)</span> if the F-ratio for treatments exceeds the critical value from the F-distribution with degrees of freedom <span class="math inline">\((v - 1, v^2 - 2v + 1)\)</span> at the chosen significance level (<span class="math inline">\(\alpha\)</span>).</p>
</section>
<section id="example-in-r" class="level3">
<h3 class="anchored" data-anchor-id="example-in-r">Example in R</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated Data for Latin Square Design</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">row =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each =</span> <span class="dv">3</span>)),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">column =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">times =</span> <span class="dv">3</span>)),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>)),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">response =</span> <span class="fu">c</span>(<span class="fl">10.2</span>, <span class="fl">15.3</span>, <span class="fl">20.1</span>, <span class="fl">14.8</span>, <span class="fl">19.5</span>, <span class="fl">9.7</span>, <span class="fl">19.0</span>, <span class="fl">9.9</span>, <span class="fl">14.2</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANOVA Model</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(response <span class="sc">~</span> row <span class="sc">+</span> column <span class="sc">+</span> treatment, <span class="at">data =</span> data)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Interpretation:</strong> - <strong>Rows and Columns:</strong> Control for row and column effects, ensuring that treatment comparisons are not confounded by these blocking factors. - <strong>Treatments:</strong> Assess the main effect of treatments on the response variable after accounting for row and column effects. - <strong>Error:</strong> Represents variability not explained by rows, columns, or treatments.</p>
</section>
</section>
<section id="youden-designs" class="level2">
<h2 class="anchored" data-anchor-id="youden-designs">Youden Designs</h2>
<section id="definition-1" class="level3">
<h3 class="anchored" data-anchor-id="definition-1">Definition</h3>
<p>A <strong>Youden Design</strong> is a type of Row–Column Design that extends the Latin Square by allowing for multiple treatments per row or column. Specifically, in a Youden Design:</p>
<ol type="1">
<li><strong>Row Blocks:</strong> Form a <strong>balanced incomplete block design</strong>.</li>
<li><strong>Column Blocks:</strong> Each treatment appears once per column.</li>
</ol>
<p>This design is particularly useful when the number of treatments exceeds the number of rows or columns, providing flexibility in experimental layouts.</p>
</section>
<section id="construction-1" class="level3">
<h3 class="anchored" data-anchor-id="construction-1">Construction</h3>
<p>Consider a Youden Design with parameters <span class="math inline">\(v = 4\)</span> treatments, <span class="math inline">\(b = 4\)</span> blocks (rows), and <span class="math inline">\(c = 3\)</span> columns. The design ensures that each treatment appears once in each column and multiple times across rows.</p>
<p><strong>Example Design:</strong></p>
<p><span class="math display">\[
\begin{array}{|c|c|c|}
\hline
A &amp; B &amp; C \\
\hline
B &amp; C &amp; D \\
\hline
C &amp; D &amp; A \\
\hline
D &amp; A &amp; B \\
\hline
\end{array}
\]</span></p>
</section>
<section id="applications" class="level3">
<h3 class="anchored" data-anchor-id="applications">Applications</h3>
<ul>
<li><strong>Clinical Trials:</strong> When treatments need to be tested across different time periods or conditions.</li>
<li><strong>Agricultural Studies:</strong> When testing multiple crop varieties across different soil types and irrigation methods.</li>
<li><strong>Industrial Experiments:</strong> When assessing the effects of various process parameters across different machines or shifts.</li>
</ul>
</section>
<section id="analysis-of-youden-designs" class="level3">
<h3 class="anchored" data-anchor-id="analysis-of-youden-designs">Analysis of Youden Designs</h3>
<p>The ANOVA model for a Youden Design incorporates both row and column effects, along with treatment effects and their interactions.</p>
<p><span class="math display">\[
Y_{hit} = \mu + \theta_h + \phi_i + \tau_t + (\theta \tau)^*_{ht} + \epsilon^*_{hit},
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(Y_{hit}\)</span>: Response for treatment <span class="math inline">\(t\)</span> in row <span class="math inline">\(h\)</span> and column <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\mu\)</span>: Overall mean.</li>
<li><span class="math inline">\(\theta_h\)</span>: Effect of row <span class="math inline">\(h\)</span>.</li>
<li><span class="math inline">\(\phi_i\)</span>: Effect of column <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\tau_t\)</span>: Effect of treatment <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\((\theta \tau)_{ht}\)</span>: Interaction effect between row <span class="math inline">\(h\)</span> and treatment <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(\epsilon_{hit}\)</span>: Random error term.</li>
</ul>
<p><strong>Degrees of Freedom:</strong> - Rows: <span class="math inline">\(b - 1\)</span> - Columns: <span class="math inline">\(c - 1\)</span> - Treatments: <span class="math inline">\(v - 1\)</span> - Error: <span class="math inline">\(bc - b - c - v + 2\)</span></p>
<p><strong>Hypothesis Testing:</strong> - <strong>Null Hypothesis (<span class="math inline">\(H_0\)</span>):</strong> All treatment means are equal. - <strong>Alternative Hypothesis (<span class="math inline">\(H_A\)</span>):</strong> At least one treatment mean differs.</p>
<p><strong>Decision Rule:</strong> Reject <span class="math inline">\(H_0\)</span> if the F-ratio for treatments exceeds the critical value from the F-distribution with degrees of freedom <span class="math inline">\((v - 1, bc - b - c - v + 2)\)</span> at the chosen significance level (<span class="math inline">\(\alpha\)</span>).</p>
<p><strong>Reference:</strong> Christensen, R. (2018). <em>Analysis of Variance, Design, and Regression</em>. Chapman and Hall/CRC.</p>
</section>
</section>
</section>
<section id="analysis-of-variance-for-rowcolumn-designs" class="level1">
<h1>Analysis of Variance for Row–Column Designs</h1>
<section id="model" class="level2">
<h2 class="anchored" data-anchor-id="model">Model</h2>
<p>For a Row–Column Design with <span class="math inline">\(b\)</span> rows, <span class="math inline">\(c\)</span> columns, and <span class="math inline">\(v\)</span> treatments, the ANOVA model is defined as:</p>
<p><span class="math display">\[
Y_{hqi} = \mu + \theta_h + \phi_q + \tau_i + \epsilon_{hqi},
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(Y_{hqi}\)</span>: Response for treatment <span class="math inline">\(i\)</span> in row <span class="math inline">\(h\)</span> and column <span class="math inline">\(q\)</span>.</li>
<li><span class="math inline">\(\mu\)</span>: Overall mean.</li>
<li><span class="math inline">\(\theta_h\)</span>: Effect of row <span class="math inline">\(h\)</span>.</li>
<li><span class="math inline">\(\phi_q\)</span>: Effect of column <span class="math inline">\(q\)</span>.</li>
<li><span class="math inline">\(\tau_i\)</span>: Effect of treatment <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\epsilon_{hqi} \sim N(0, \sigma^2)\)</span>: Random error term.</li>
</ul>
<section id="key-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="key-assumptions">Key Assumptions</h3>
<ol type="1">
<li><strong>Normality:</strong> The residuals (<span class="math inline">\(\epsilon_{hqi}\)</span>) are normally distributed.</li>
<li><strong>Homogeneity of Variance (Homoscedasticity):</strong> The variance of residuals is constant across all treatments, rows, and columns.</li>
<li><strong>Independence:</strong> Observations are independent of each other.</li>
<li><strong>No Interaction:</strong> There is no interaction between rows and treatments or columns and treatments, i.e., the effects of treatments are consistent across rows and columns.</li>
</ol>
</section>
<section id="anova-table" class="level3">
<h3 class="anchored" data-anchor-id="anova-table">ANOVA Table</h3>
<table class="table">
<colgroup>
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 35%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th>Source of Variation</th>
<th>Degrees of Freedom (DF)</th>
<th>Sum of Squares (SS)</th>
<th>Mean Square (MS)</th>
<th>F-ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Rows</td>
<td><span class="math inline">\(b - 1\)</span></td>
<td><span class="math inline">\(SS_{\text{Rows}}\)</span></td>
<td><span class="math inline">\(MS_{\text{Rows}} = \frac{SS_{\text{Rows}}}{b - 1}\)</span></td>
<td><span class="math inline">\(F = \frac{MS_{\text{Rows}}}{MS_{\text{Error}}}\)</span></td>
</tr>
<tr class="even">
<td>Columns</td>
<td><span class="math inline">\(c - 1\)</span></td>
<td><span class="math inline">\(SS_{\text{Columns}}\)</span></td>
<td><span class="math inline">\(MS_{\text{Columns}} = \frac{SS_{\text{Columns}}}{c - 1}\)</span></td>
<td><span class="math inline">\(F = \frac{MS_{\text{Columns}}}{MS_{\text{Error}}}\)</span></td>
</tr>
<tr class="odd">
<td>Treatments</td>
<td><span class="math inline">\(v - 1\)</span></td>
<td><span class="math inline">\(SS_{\text{Treatments}}\)</span></td>
<td><span class="math inline">\(MS_{\text{Treatments}} = \frac{SS_{\text{Treatments}}}{v - 1}\)</span></td>
<td><span class="math inline">\(F = \frac{MS_{\text{Treatments}}}{MS_{\text{Error}}}\)</span></td>
</tr>
<tr class="even">
<td>Error</td>
<td><span class="math inline">\(bc - b - c - v + 2\)</span></td>
<td><span class="math inline">\(SS_{\text{Error}}\)</span></td>
<td><span class="math inline">\(MS_{\text{Error}} = \frac{SS_{\text{Error}}}{bc - b - c - v + 2}\)</span></td>
<td>-</td>
</tr>
<tr class="odd">
<td><strong>Total</strong></td>
<td><span class="math inline">\(b c v - 1\)</span></td>
<td><span class="math inline">\(SS_{\text{Total}}\)</span></td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
</section>
<section id="hypothesis-testing" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-testing">Hypothesis Testing</h3>
<ul>
<li><strong>Null Hypothesis (<span class="math inline">\(H_0\)</span>):</strong> All treatment means are equal (<span class="math inline">\(\tau_i = 0\)</span> for all <span class="math inline">\(i\)</span>).</li>
<li><strong>Alternative Hypothesis (<span class="math inline">\(H_A\)</span>):</strong> At least one treatment mean differs.</li>
</ul>
<p><strong>Decision Rule:</strong> Reject <span class="math inline">\(H_0\)</span> if the F-ratio for treatments exceeds the critical value from the F-distribution with degrees of freedom <span class="math inline">\((v - 1, bc - b - c - v + 2)\)</span> at the chosen significance level (<span class="math inline">\(\alpha\)</span>).</p>
</section>
<section id="example-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="example-interpretation">Example Interpretation</h3>
<ul>
<li><strong>Rows and Columns:</strong> Assess the significance of row and column effects. Significant row or column effects indicate that these blocking factors explain a substantial portion of the variability in the response.</li>
<li><strong>Treatments:</strong> Determine if treatments have a significant impact on the response variable after accounting for row and column effects.</li>
<li><strong>Error:</strong> Represents unexplained variability, serving as the denominator for F-ratios.</li>
</ul>
<p><strong>Reference:</strong> Scheffé, H. (1959). <em>The Analysis of Variance</em>. Wiley.</p>
</section>
</section>
</section>
<section id="practical-extensions" class="level1">
<h1>Practical Extensions</h1>
<section id="factorial-experiments-in-rowcolumn-designs" class="level2">
<h2 class="anchored" data-anchor-id="factorial-experiments-in-rowcolumn-designs">Factorial Experiments in Row–Column Designs</h2>
<p>When treatments involve multiple factors (e.g., factorial combinations), Row–Column Designs can be extended to accommodate these complexities. This allows for the examination of interactions between factors within the blocking structure.</p>
<section id="model-with-interaction-terms" class="level3">
<h3 class="anchored" data-anchor-id="model-with-interaction-terms">Model with Interaction Terms</h3>
<p><span class="math display">\[
Y_{hqijk} = \mu + \theta_h + \phi_q + \alpha_i + \beta_j + (\alpha\beta)^*_{ij} + \epsilon^*_{hqijk},
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\alpha_i\)</span>, <span class="math inline">\(\beta_j\)</span>: Main effects of factors A and B.</li>
<li><span class="math inline">\((\alpha\beta)_{ij}\)</span>: Interaction effect between factors A and B.</li>
</ul>
</section>
<section id="r-example-two-way-factorial-in-rowcolumn-design" class="level3">
<h3 class="anchored" data-anchor-id="r-example-two-way-factorial-in-rowcolumn-design">R Example: Two-Way Factorial in Row–Column Design</h3>
<div class="cell" data-tbl-cap="Two-Way Factorial in Row–Column Design Example 1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-Way Factorial in Row–Column Design</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Factors and Blocks</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">row =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each =</span> <span class="dv">6</span>)),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">column =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">each =</span> <span class="dv">3</span>), <span class="dv">3</span>)),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">factorA =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"High"</span>), <span class="at">each =</span> <span class="dv">9</span>)),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">factorB =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Treatment"</span>), <span class="at">times =</span> <span class="dv">9</span>)),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">response =</span> <span class="fu">c</span>(</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">3</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">2</span>),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">3</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">3</span>, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">2</span>),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">3</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">2</span>),</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">3</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>),</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">3</span>, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># View the Data</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   row column factorA   factorB  response
1    1      1     Low   Control  2.312957
2    1      1     Low Treatment  6.243551
3    1      1     Low   Control  6.601749
4    1      2     Low Treatment  7.222215
5    1      2     Low   Control  8.571286
6    1      2     Low Treatment  9.351878
7    2      1     Low   Control 16.381286
8    2      1     Low Treatment 15.501096
9    2      1     Low   Control 17.014705
10   2      2    High Treatment  6.146469
11   2      2    High   Control  3.168379
12   2      2    High Treatment  7.622195
13   3      1    High   Control 11.977453
14   3      1    High Treatment 13.307857
15   3      1    High   Control  7.118390
16   3      2    High Treatment 18.894713
17   3      2    High   Control 18.473872
18   3      2    High Treatment 15.774967</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANOVA Model with Interaction</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(response <span class="sc">~</span> row <span class="sc">+</span> column <span class="sc">+</span> factorA <span class="sc">*</span> factorB, <span class="at">data =</span> data)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false"> <div class="table-caption"><p>ANOVA for Two-Way Factorial in Row–Column Design Example 1</p></div>
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["Sum Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Mean Sq"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"171.52210398","3":"85.76105199","4":"19.25581060","5":"2.551352e-04","_rn_":"row"},{"1":"1","2":"0.08446996","3":"0.08446996","4":"0.01896592","5":"8.929528e-01","_rn_":"column"},{"1":"1","2":"248.83516725","3":"248.83516725","4":"55.87061656","5":"1.238509e-05","_rn_":"factorA"},{"1":"1","2":"4.90167129","3":"4.90167129","4":"1.10056549","5":"3.166450e-01","_rn_":"factorB"},{"1":"1","2":"7.79877606","3":"7.79877606","4":"1.75104842","5":"2.125907e-01","_rn_":"factorA:factorB"},{"1":"11","2":"48.99152736","3":"4.45377521","4":"NA","5":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li><strong>Main Effects:</strong> Assess the individual impact of factors A and B.</li>
<li><strong>Interaction Effect:</strong> Determine if the effect of one factor depends on the level of the other factor.</li>
<li><strong>Blocking Factors:</strong> Control for row and column variability, ensuring that treatment comparisons are not confounded by these dimensions.</li>
</ul>
<p><strong>Reference:</strong> Dean, A., Voss, D., &amp; Draguljić, D. (2017). <em>Design and Analysis of Experiments</em>. Springer.</p>
</section>
</section>
</section>
<section id="practical-applications" class="level1">
<h1>Practical Applications</h1>
<section id="example-resting-metabolic-rate" class="level2">
<h2 class="anchored" data-anchor-id="example-resting-metabolic-rate">Example: Resting Metabolic Rate</h2>
<section id="scenario" class="level3">
<h3 class="anchored" data-anchor-id="scenario">Scenario</h3>
<p>A study aims to compare three different exercise protocols (Treatments A, B, C) on subjects’ resting metabolic rates. To control for age-related variability, subjects are grouped into four blocks based on age groups.</p>
</section>
<section id="step-by-step-r-code" class="level3">
<h3 class="anchored" data-anchor-id="step-by-step-r-code">Step-by-Step R Code</h3>
<section id="load-and-prepare-data" class="level4">
<h4 class="anchored" data-anchor-id="load-and-prepare-data">1. Load and Prepare Data</h4>
<div class="cell" data-tbl-cap="Data Simulation for Resting Metabolic Rate Example 2">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set Seed for Reproducibility</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Blocks and Treatments</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>blocks <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">each =</span> <span class="dv">3</span>))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>treatments <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">times =</span> <span class="dv">4</span>))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate Response Variable (resting Metabolic Rate in kcal/day)</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnorm</span>(<span class="dv">3</span>, <span class="at">mean =</span> <span class="dv">1500</span>, <span class="at">sd =</span> <span class="dv">50</span>), <span class="co"># Block 1</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnorm</span>(<span class="dv">3</span>, <span class="at">mean =</span> <span class="dv">1550</span>, <span class="at">sd =</span> <span class="dv">50</span>), <span class="co"># Block 2</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnorm</span>(<span class="dv">3</span>, <span class="at">mean =</span> <span class="dv">1480</span>, <span class="at">sd =</span> <span class="dv">50</span>), <span class="co"># Block 3</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnorm</span>(<span class="dv">3</span>, <span class="at">mean =</span> <span class="dv">1520</span>, <span class="at">sd =</span> <span class="dv">50</span>) <span class="co"># Block 4</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Data Frame</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(blocks, treatments, response)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co"># View the Data</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   blocks treatments response
1       1          A 1526.205
2       1          B 1386.962
3       1          C 1499.016
4       2          A 1559.157
5       2          B 1531.932
6       2          C 1525.776
7       3          A 1446.684
8       3          B 1471.277
9       3          C 1429.452
10      4          A 1556.985
11      4          B 1499.885
12      4          C 1469.861</code></pre>
</div>
</div>
<p><strong>Output Interpretation:</strong> The dataset comprises four blocks, each containing three treatments. The response variable represents the resting metabolic rate, simulated with slight block-specific means to reflect age-related variability.</p>
</section>
<section id="fit-the-rcbd-model" class="level4">
<h4 class="anchored" data-anchor-id="fit-the-rcbd-model">2. Fit the RCBD Model</h4>
<div class="cell" data-tbl-cap="ANOVA for Resting Metabolic Rate Example 2">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the RCBD Model Using ANOVA</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">aov</span>(response <span class="sc">~</span> blocks <span class="sc">+</span> treatments, <span class="at">data =</span> data)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the Model</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
blocks       3  14341    4780   2.690  0.140
treatments   2   5663    2831   1.593  0.279
Residuals    6  10664    1777               </code></pre>
</div>
</div>
<p><strong>Interpretation:</strong> - <strong>Blocks:</strong> Capture the variability due to different age groups. - <strong>Treatments:</strong> Assess the effect of exercise protocols after accounting for age-related variability. - <strong>Error:</strong> Represents unexplained variability in resting metabolic rates.</p>
</section>
<section id="diagnostic-plots" class="level4">
<h4 class="anchored" data-anchor-id="diagnostic-plots">3. Diagnostic Plots</h4>
<div class="cell" data-tbl-cap="Diagnostic Plots for Resting Metabolic Rate Example 2">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostic Plots for the ANOVA Model</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="week-11_row-column_files/figure-html/tab-rcbd-diagnostic-plots-example2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="week-11_row-column_files/figure-html/tab-rcbd-diagnostic-plots-example2-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> Examine residual plots to ensure that assumptions of normality, homoscedasticity, and independence are met. Look for random scatter in Residuals vs Fitted and Q-Q plots to assess normality.</p>
</section>
<section id="post-hoc-analysis-multiple-comparisons" class="level4">
<h4 class="anchored" data-anchor-id="post-hoc-analysis-multiple-comparisons">4. Post-Hoc Analysis (Multiple Comparisons)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Emmeans Package for Estimated Marginal means</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated Marginal means for Treatments</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span>treatments)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Pairwise Comparisons</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>pairwise_comparisons <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm, <span class="at">method =</span> <span class="st">"pairwise"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pairwise_comparisons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false"> <div class="table-caption"><p>Pairwise Comparisons for Resting Metabolic Rate Example 2</p></div>
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"A - B","2":"49.743808","3":"29.81103","4":"6","5":"1.6686379","6":"0.2909461","_rn_":"1"},{"1":"A - C","2":"41.231543","3":"29.81103","4":"6","5":"1.3830971","6":"0.4062672","_rn_":"2"},{"1":"B - C","2":"-8.512266","3":"29.81103","4":"6","5":"-0.2855408","6":"0.9563720","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> Identify which exercise protocols significantly differ in their effect on resting metabolic rates after adjusting for age-related variability.</p>
</section>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p><strong>Row–Column Designs</strong>, including <strong>Latin Square Designs</strong> and <strong>Youden Designs</strong>, are powerful tools in experimental research for controlling multiple sources of variability. By structuring experiments to account for both row and column effects, these designs enhance the precision and reliability of treatment comparisons. The integration of ANOVA facilitates robust analysis, allowing researchers to discern meaningful differences among treatments while mitigating confounding factors.</p>
<p><strong>Key Takeaways:</strong></p>
<ul>
<li><strong>Row–Column Structure:</strong> Efficiently controls for two independent sources of variability, improving the precision of treatment effect estimates.</li>
<li><strong>Latin Square Designs:</strong> Ensure each treatment appears once per row and column, providing a balanced design ideal for experiments with three blocking factors.</li>
<li><strong>Youden Designs:</strong> Extend the flexibility of Latin Square Designs by allowing for multiple treatments per row or column, accommodating more complex experimental scenarios.</li>
<li><strong>ANOVA in Row–Column Designs:</strong> Decomposes variability into row, column, treatment, and error components, facilitating comprehensive hypothesis testing.</li>
<li><strong>Factorial Extensions:</strong> Enable the examination of interactions between multiple factors within the blocking structure, offering deeper insights into treatment effects.</li>
<li><strong>Practical Implementation in R:</strong> R provides robust tools for designing, analyzing, and interpreting Row–Column Designs, empowering researchers with advanced statistical capabilities.</li>
<li><strong>Advanced Topics:</strong> Understanding interactions and sample size considerations enhances the applicability and rigor of Row–Column Designs in diverse research contexts.</li>
</ul>
<p>Mastery of Row–Column Designs equips graduate students with the methodological rigor necessary for conducting sophisticated experiments, ensuring that findings are both accurate and generalizable.</p>
<p><strong>Future Directions:</strong> Further exploration into advanced experimental designs, mixed-effects models, and nonparametric Row–Column Designs will provide a deeper understanding of complex data structures and enhance analytical capabilities.</p>
</section>
<section id="appendix-advanced-mathematical-derivations" class="level1">
<h1>Appendix: Advanced Mathematical Derivations</h1>
<section id="variance-calculations-for-latin-square-designs" class="level2">
<h2 class="anchored" data-anchor-id="variance-calculations-for-latin-square-designs">Variance Calculations for Latin Square Designs</h2>
<p>In a <strong>Latin Square Design</strong> with <span class="math inline">\(v\)</span> treatments, the variance of the estimated treatment effects is influenced by the design’s structure.</p>
<section id="formula" class="level3">
<h3 class="anchored" data-anchor-id="formula">Formula</h3>
<p>For a Latin Square with <span class="math inline">\(v\)</span> treatments:</p>
<p><span class="math display">\[
Var(\tau_i) = \frac{\sigma^2}{v}
\]</span></p>
</section>
<section id="derivation" class="level3">
<h3 class="anchored" data-anchor-id="derivation">Derivation</h3>
<ol type="1">
<li><p><strong>Model Setup:</strong></p>
<p>The ANOVA model for a Latin Square is:</p></li>
</ol>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \tau_k + \epsilon_{ijk},
\]</span></p>
<p>where <span class="math inline">\(\epsilon_{ijk} \sim N(0, \sigma^2)\)</span>.</p>
<ol type="1">
<li><p><strong>Estimator for Treatment Effect (<span class="math inline">\(\tau_k\)</span>):</strong></p>
<p>The treatment effects are estimated as:</p></li>
</ol>
<p><span class="math display">\[
\hat{\tau}^*k = \bar{Y}^*{\cdot \cdot k} - \bar{Y}_{\cdot \cdot \cdot},
\]</span></p>
<p>where <span class="math inline">\(\bar{Y}^*{\cdot \cdot k}\)</span> is the mean response for treatment <span class="math inline">\(k\)</span> and <span class="math inline">\(\bar{Y}^*{\cdot \cdot \cdot}\)</span> is the grand mean.</p>
<ol type="1">
<li><p><strong>Variance of <span class="math inline">\(\hat{\tau}_k\)</span>:</strong></p>
<p>Since each treatment is replicated <span class="math inline">\(v\)</span> times (once per row and column):</p></li>
</ol>
<p><span class="math display">\[
Var(\hat{\tau}_k) = \frac{\sigma^2}{v}
\]</span></p>
<p><strong>Conclusion:</strong> The variance of the treatment effect estimates decreases with increasing number of treatments in the Latin Square, enhancing the precision of the estimates.</p>
<p><strong>Reference:</strong> Montgomery, D. C., &amp; Runger, G. C. (2020). <em>Applied Statistics and Probability for Engineers</em>. Wiley.</p>
</section>
</section>
<section id="degrees-of-freedom-in-youden-designs" class="level2">
<h2 class="anchored" data-anchor-id="degrees-of-freedom-in-youden-designs">Degrees of Freedom in Youden Designs</h2>
<p>For a <strong>Youden Design</strong> with parameters <span class="math inline">\(v = 4\)</span> treatments, <span class="math inline">\(b = 4\)</span> blocks (rows), and <span class="math inline">\(c = 3\)</span> columns, the degrees of freedom for the error term are calculated as follows:</p>
<section id="formula-1" class="level3">
<h3 class="anchored" data-anchor-id="formula-1">Formula</h3>
<p><span class="math display">\[
df_{\text{Error}} = bc - b - c - v + 2
\]</span></p>
</section>
<section id="calculation" class="level3">
<h3 class="anchored" data-anchor-id="calculation">Calculation</h3>
<p>Given:</p>
<ul>
<li><span class="math inline">\(v = 4\)</span></li>
<li><span class="math inline">\(b = 4\)</span></li>
<li><span class="math inline">\(c = 3\)</span></li>
</ul>
<p>Plugging into the formula:</p>
<p><span class="math display">\[
df_{\text{Error}} = (4 \times 3) - 4 - 3 - 4 + 2 = 12 - 4 - 3 - 4 + 2 = 3
\]</span></p>
<p><strong>Interpretation:</strong> The error degrees of freedom indicate the number of independent pieces of information available to estimate the error variance. In this case, with 3 error degrees of freedom, the design is sufficiently constrained to estimate treatment effects after accounting for row and column effects.</p>
<p><strong>Reference:</strong> Dean, Voss &amp; Draguljić (2017). <em>Design and Analysis of Experiments</em>. Springer.</p>
</section>
</section>
<section id="proof-of-interaction-contrasts" class="level2">
<h2 class="anchored" data-anchor-id="proof-of-interaction-contrasts">Proof of Interaction Contrasts</h2>
<section id="interaction-contrasts-measure-deviations-from-additivity" class="level3">
<h3 class="anchored" data-anchor-id="interaction-contrasts-measure-deviations-from-additivity">Interaction Contrasts Measure Deviations from Additivity</h3>
<p><strong>Definition:</strong> In a three-factor design, interaction contrasts quantify how the combined effect of three factors deviates from the additive effects of each factor individually and their two-way interactions.</p>
</section>
<section id="proof-steps" class="level3">
<h3 class="anchored" data-anchor-id="proof-steps">Proof Steps</h3>
<ol type="1">
<li><strong>Define the Three-Factor Model:</strong></li>
</ol>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_k + (\alpha\beta)^*_{ij} + (\alpha\gamma)^*_{ik} + (\beta\gamma)^*_{jk} + (\alpha\beta\gamma)^*_{ijk} + \epsilon_{ijk}
\]</span></p>
<p>where <span class="math inline">\(\sum \alpha_i = \sum \beta_j = \sum \gamma_k = 0\)</span>.</p>
<ol type="1">
<li><p><strong>Construct Interaction Contrasts:</strong></p>
<ul>
<li><strong>Two-Way Interactions:</strong>
<ul>
<li><span class="math inline">\((\alpha\beta)_{ij}\)</span> measures the interaction between Factors A and B.</li>
<li>Similarly for <span class="math inline">\((\alpha\gamma)^*_{ik}\)</span> and <span class="math inline">\((\beta\gamma)^*_{jk}\)</span>.</li>
</ul></li>
<li><strong>Three-Way Interaction:</strong>
<ul>
<li><span class="math inline">\((\alpha\beta\gamma)_{ijk}\)</span> measures the deviation from additivity among all three factors.</li>
</ul></li>
</ul></li>
<li><p><strong>Prove Deviations from Additivity:</strong></p>
<ul>
<li><strong>Additive Model:</strong> If all interaction terms are zero (<span class="math inline">\((\alpha\beta)^*_{ij} = (\alpha\gamma)^*_{ik} = (\beta\gamma)^*_{jk} = (\alpha\beta\gamma)^*_{ijk} = 0\)</span>), the model simplifies to:</li>
</ul></li>
</ol>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_k + \epsilon_{ijk}
\]</span></p>
<pre><code> This represents a purely additive model where the combined effect of factors is the sum of their individual effects.</code></pre>
<ul>
<li><strong>Non-Additive Model:</strong> If any of the interaction terms are non-zero, the model deviates from additivity, indicating that the effect of one factor depends on the levels of other factors.</li>
</ul>
<ol type="1">
<li><p><strong>Conclusion:</strong></p>
<p>Interaction contrasts (<span class="math inline">\((\alpha\beta)^*_{ij}\)</span>, <span class="math inline">\((\alpha\gamma)^*_{ik}\)</span>, <span class="math inline">\((\beta\gamma)^*_{jk}\)</span>, and <span class="math inline">\((\alpha\beta\gamma)^*_{ijk}\)</span>) measure the extent to which the observed responses deviate from an additive model. Non-zero contrasts signify the presence of interactions, emphasizing the importance of considering these higher-order effects in experimental analysis.</p></li>
</ol>
<p><strong>Reference:</strong> Dean, Voss &amp; Draguljić (2017). <em>Design and Analysis of Experiments</em>. Springer.</p>
</section>
</section>
</section>
<section id="exercises" class="level1">
<h1>Exercises</h1>
<section id="medium-difficulty" class="level2">
<h2 class="anchored" data-anchor-id="medium-difficulty">Medium Difficulty</h2>
<section id="two-way-ancova-with-interaction" class="level3">
<h3 class="anchored" data-anchor-id="two-way-ancova-with-interaction">1. Two-Way ANCOVA with Interaction</h3>
<p><strong>Dataset:</strong> Simulate a dataset with three treatments and one covariate.</p>
<p><strong>Tasks:</strong></p>
<ul>
<li>Generate data for treatments A, B, C with a covariate <span class="math inline">\(X\)</span>.</li>
<li>Fit an ANCOVA model adjusting for <span class="math inline">\(X\)</span>.</li>
<li>Test the significance of treatment effects and the covariate.</li>
<li>Generate diagnostic plots and interpret them.</li>
</ul>
<p><strong>R Code Example:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Factors and Covariate</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>Treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">each=</span><span class="dv">30</span>))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">90</span>, <span class="at">mean=</span><span class="dv">50</span>, <span class="at">sd=</span><span class="dv">10</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate Responses with Treatment Effects and Covariate Effect</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">ifelse</span>(Treatment <span class="sc">==</span> <span class="st">"A"</span>, <span class="dv">0</span>, <span class="fu">ifelse</span>(Treatment <span class="sc">==</span> <span class="st">"B"</span>, <span class="dv">2</span>, <span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0.5</span> <span class="sc">*</span> (X <span class="sc">-</span> <span class="fu">mean</span>(X)) <span class="sc">+</span> </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rnorm</span>(<span class="dv">90</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">3</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>data_sim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Treatment, X, Y)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANCOVA Model</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>model_sim <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> Treatment <span class="sc">+</span> X, <span class="at">data =</span> data_sim)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Y ~ Treatment + X, data = data_sim)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.6486 -1.8937 -0.3341  1.7617  9.2902 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -20.73160    1.87693 -11.045  &lt; 2e-16 ***
TreatmentB    1.72225    0.78691   2.189   0.0313 *  
TreatmentC    4.74007    0.78309   6.053 3.61e-08 ***
X             0.50385    0.03621  13.914  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.031 on 86 degrees of freedom
Multiple R-squared:  0.7332,    Adjusted R-squared:  0.7238 
F-statistic: 78.76 on 3 and 86 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostic Plots</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="week-11_row-column_files/figure-html/unnamed-chunk-7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="week-11_row-column_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated Marginal means</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>emm_sim <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_sim, <span class="sc">~</span> Treatment)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>pairwise_sim <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm_sim, <span class="at">method =</span> <span class="st">"pairwise"</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pairwise_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"A - B","2":"-1.722254","3":"0.7869124","4":"86","5":"-2.188622","6":"7.885527e-02","_rn_":"1"},{"1":"A - C","2":"-4.740066","3":"0.7830950","4":"86","5":"-6.052989","6":"1.081426e-07","_rn_":"2"},{"1":"B - C","2":"-3.017812","3":"0.7846485","4":"86","5":"-3.846068","6":"6.666253e-04","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><strong>Questions:</strong></p>
<ol type="1">
<li><strong>Main Effects:</strong>
<ul>
<li><strong>Treatment:</strong> What are the estimated effects of treatments A, B, and C?</li>
<li><strong>Covariate <span class="math inline">\(X\)</span>:</strong> How does <span class="math inline">\(X\)</span> influence the response variable <span class="math inline">\(Y\)</span>?</li>
</ul></li>
<li><strong>Significance Testing:</strong>
<ul>
<li>Are the treatment effects statistically significant after adjusting for <span class="math inline">\(X\)</span>?</li>
<li>Is the covariate <span class="math inline">\(X\)</span> a significant predictor of <span class="math inline">\(Y\)</span>?</li>
</ul></li>
<li><strong>Diagnostic Plots:</strong>
<ul>
<li>Do the residual plots indicate any violations of ANCOVA assumptions such as non-linearity, heteroscedasticity, or non-normality?</li>
<li>Are there any influential observations that may affect the model’s validity?</li>
</ul></li>
<li><strong>Interpretation of Pairwise Comparisons:</strong>
<ul>
<li>Which treatments significantly differ from each other after adjusting for <span class="math inline">\(X\)</span>?</li>
<li>How do the adjusted means compare across treatments?</li>
</ul></li>
</ol>
<p><strong>Expected Answers:</strong></p>
<ol type="1">
<li><strong>Main Effects:</strong>
<ul>
<li>Treatments B and C have positive effects relative to Treatment A.</li>
<li>Covariate <span class="math inline">\(X\)</span> has a positive influence on <span class="math inline">\(Y\)</span>, indicating that as <span class="math inline">\(X\)</span> increases, <span class="math inline">\(Y\)</span> tends to increase.</li>
</ul></li>
<li><strong>Significance Testing:</strong>
<ul>
<li>If the p-values for Treatment are below the significance level (e.g., 0.05), treatments have significant effects.</li>
<li>If the p-value for <span class="math inline">\(X\)</span> is below the significance level, <span class="math inline">\(X\)</span> is a significant predictor.</li>
</ul></li>
<li><strong>Diagnostic Plots:</strong>
<ul>
<li>Random scatter in Residuals vs Fitted suggests homoscedasticity and linearity.</li>
<li>Q-Q plot close to the diagonal indicates normality of residuals.</li>
<li>No points with high leverage or large residuals indicate no influential observations.</li>
</ul></li>
<li><strong>Interpretation of Pairwise Comparisons:</strong>
<ul>
<li>Significant pairwise differences indicate which specific treatments differ after adjusting for <span class="math inline">\(X\)</span>.</li>
<li>Adjusted means provide a clearer comparison by accounting for the covariate’s effect.</li>
</ul></li>
</ol>
</section>
<section id="balloon-data-analysis" class="level3">
<h3 class="anchored" data-anchor-id="balloon-data-analysis">2. Balloon Data Analysis</h3>
<p><strong>Scenario:</strong> Reanalyze the balloon data, testing for equality of slopes.</p>
<p><strong>Tasks:</strong></p>
<ul>
<li>Fit an ANCOVA model.</li>
<li>Test the homogeneity of regression slopes.</li>
<li>Interpret the adjusted treatment means.</li>
</ul>
<p><strong>R Code Example:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load and Prepare Data</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming 'balloon.txt' Has Columns: Color, RunOrder, Time</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>balloon.data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"dean2017"</span>, <span class="st">"balloon.txt"</span>), <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>balloon.data <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Order"],"name":[1],"type":["int"],"align":["right"]},{"label":["Color"],"name":[2],"type":["int"],"align":["right"]},{"label":["Time"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"1","3":"22.0","_rn_":"1"},{"1":"2","2":"3","3":"24.6","_rn_":"2"},{"1":"3","2":"1","3":"20.3","_rn_":"3"},{"1":"4","2":"4","3":"19.8","_rn_":"4"},{"1":"5","2":"3","3":"24.3","_rn_":"5"},{"1":"6","2":"2","3":"22.2","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>balloon.data <span class="ot">&lt;-</span> balloon.data <span class="sc">|&gt;</span> <span class="fu">transform</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> Order <span class="sc">-</span> <span class="fu">mean</span>(Order),</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">fColor =</span> <span class="fu">factor</span>(Color)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANCOVA Model</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Time <span class="sc">~</span> fColor <span class="sc">+</span> x, <span class="at">data =</span> balloon.data)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Time ~ fColor + x, data = balloon.data)

Residuals:
   Min     1Q Median     3Q    Max 
-3.985 -1.736 -0.211  1.493  5.249 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 18.28474    0.91736  19.932  &lt; 2e-16 ***
fColor2      4.10560    1.29760   3.164 0.003829 ** 
fColor3      3.80129    1.29872   2.927 0.006867 ** 
fColor4     -0.07086    1.29736  -0.055 0.956843    
x           -0.21103    0.04981  -4.237 0.000236 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.594 on 27 degrees of freedom
Multiple R-squared:  0.5776,    Adjusted R-squared:  0.515 
F-statistic: 9.229 on 4 and 27 DF,  p-value: 7.797e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Homogeneity of Slopes</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>model_interaction <span class="ot">&lt;-</span> <span class="fu">lm</span>(Time <span class="sc">~</span> fColor <span class="sc">*</span> x, <span class="at">data =</span> balloon.data)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model, model_interaction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"27","2":"181.7422","3":"NA","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"24","2":"157.0320","3":"3","4":"24.71016","5":"1.258859","6":"0.3107502","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated Marginal means</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>emm_balloon <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span>fColor)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>pairwise_balloon <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm_balloon, <span class="at">method =</span> <span class="st">"pairwise"</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pairwise_balloon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"fColor1 - fColor2","2":"-4.10560387","3":"1.297600","4":"27","5":"-3.16399688","6":"0.01886063","_rn_":"1"},{"1":"fColor1 - fColor3","2":"-3.80129227","3":"1.298720","4":"27","5":"-2.92695236","6":"0.03270334","_rn_":"2"},{"1":"fColor1 - fColor4","2":"0.07086232","3":"1.297361","4":"27","5":"0.05462034","6":"0.99993994","_rn_":"3"},{"1":"fColor2 - fColor3","2":"0.30431160","3":"1.300584","4":"27","5":"0.23398067","6":"0.99537890","_rn_":"4"},{"1":"fColor2 - fColor4","2":"4.17646618","3":"1.298183","4":"27","5":"3.21716321","6":"0.01662144","_rn_":"5"},{"1":"fColor3 - fColor4","2":"3.87215459","3":"1.297959","4":"27","5":"2.98326439","6":"0.02875414","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><strong>Questions:</strong></p>
<ol type="1">
<li><strong>Interaction Term:</strong>
<ul>
<li>What does the interaction term between <code>fColor</code> and <code>x</code> indicate?</li>
<li>Is the interaction term statistically significant?</li>
</ul></li>
<li><strong>Model Interpretation:</strong>
<ul>
<li>If the interaction is not significant, what does this imply about the slopes?</li>
<li>How do the adjusted treatment means differ from the raw means?</li>
</ul></li>
<li><strong>Pairwise Comparisons:</strong>
<ul>
<li>Which balloon colors have significantly different inflation times after adjusting for run order?</li>
<li>How can these differences inform practical decisions in balloon manufacturing?</li>
</ul></li>
<li><strong>Assumption Testing:</strong>
<ul>
<li>Do the diagnostic plots suggest any violations of ANCOVA assumptions?</li>
<li>Should any transformations or alternative models be considered based on these diagnostics?</li>
</ul></li>
</ol>
<p><strong>Expected Answers:</strong></p>
<ol type="1">
<li><strong>Interaction Term:</strong>
<ul>
<li>The interaction term assesses whether the relationship between <code>x</code> (RunOrder) and <code>Time</code> differs across <code>fColor</code> (Color).</li>
<li>A non-significant interaction suggests that slopes are homogeneous across treatments.</li>
</ul></li>
<li><strong>Model Interpretation:</strong>
<ul>
<li>Homogeneous slopes imply that the covariate affects all treatments equally.</li>
<li>Adjusted treatment means account for differences in <code>x</code>, providing a fair comparison of treatment effects.</li>
</ul></li>
<li><strong>Pairwise Comparisons:</strong>
<ul>
<li>Significant differences indicate specific color treatments that lead to different inflation times.</li>
<li>Manufacturers can focus on optimizing colors that perform better in terms of inflation speed.</li>
</ul></li>
<li><strong>Assumption Testing:</strong>
<ul>
<li>Random scatter in Residuals vs Fitted and Q-Q plots close to the diagonal indicate that assumptions are met.</li>
<li>If violations are present, consider data transformations or robust statistical methods.</li>
</ul></li>
</ol>
</section>
</section>
</section>
<section id="advanced-topics" class="level1">
<h1>Advanced Topics</h1>
<section id="general-complete-block-designs" class="level2">
<h2 class="anchored" data-anchor-id="general-complete-block-designs">General Complete Block Designs</h2>
<section id="model-1" class="level3">
<h3 class="anchored" data-anchor-id="model-1">Model</h3>
<p>In <strong>General Complete Block Designs</strong>, treatments may be replicated within blocks, allowing for the detection of interactions between treatments and blocking factors.</p>
<p><span class="math display">\[
Y_{hit} = \mu + \theta_h + \tau_i + (\theta \tau)^*_{hi} + \epsilon^*_{hit},
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(Y_{hit}\)</span>: Response for treatment <span class="math inline">\(i\)</span> in block <span class="math inline">\(h\)</span>, replicate <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(\theta_h\)</span>: Effect of block <span class="math inline">\(h\)</span>.</li>
<li><span class="math inline">\(\tau_i\)</span>: Effect of treatment <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\((\theta \tau)_{hi}\)</span>: Interaction effect between block <span class="math inline">\(h\)</span> and treatment <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\epsilon_{hit}\)</span>: Random error term.</li>
</ul>
</section>
<section id="sample-size-calculations" class="level3">
<h3 class="anchored" data-anchor-id="sample-size-calculations">Sample Size Calculations</h3>
<p>Determining the appropriate sample size ensures adequate power to detect treatment effects.</p>
<p><span class="math display">\[
n \geq \frac{2 v \sigma^2 \phi^2}{b \Delta^2}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(n\)</span>: Number of replicates per treatment.</li>
<li><span class="math inline">\(v\)</span>: Number of treatments.</li>
<li><span class="math inline">\(b\)</span>: Number of blocks.</li>
<li><span class="math inline">\(\sigma^2\)</span>: Estimated variance.</li>
<li><span class="math inline">\(\phi\)</span>: Desired power (e.g., 0.80).</li>
<li><span class="math inline">\(\Delta\)</span>: Minimum detectable effect size.</li>
</ul>
<p><strong>Example Calculation in R:</strong></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="dv">4</span>          <span class="co"># Number of treatments</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">5</span>          <span class="co"># Number of blocks</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">20</span>    <span class="co"># Variance estimate</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fl">0.84</span>     <span class="co"># Desired power (approx 0.80)</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>Delta <span class="ot">&lt;-</span> <span class="dv">5</span>      <span class="co"># Minimum detectable effect size</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Sample Size</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>((<span class="dv">2</span> <span class="sc">*</span> v <span class="sc">*</span> sigma2 <span class="sc">*</span> phi<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (b <span class="sc">*</span> Delta<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Interpretation:</strong> The <code>ceiling</code> function ensures that the sample size is rounded up to the next integer, guaranteeing that the desired power is achieved.</p>
<p><strong>Reference:</strong> Montgomery, D. C., &amp; Runger, G. C. (2020). <em>Applied Statistics and Probability for Engineers</em>. Wiley.</p>
</section>
</section>
<section id="handling-block-treatment-interactions" class="level2">
<h2 class="anchored" data-anchor-id="handling-block-treatment-interactions">Handling Block-Treatment Interactions</h2>
<section id="importance-of-interaction-terms" class="level3">
<h3 class="anchored" data-anchor-id="importance-of-interaction-terms">Importance of Interaction Terms</h3>
<p>Including interaction terms in the ANOVA model allows for the detection of how treatment effects may vary across different blocks.</p>
</section>
<section id="model-with-interaction" class="level3">
<h3 class="anchored" data-anchor-id="model-with-interaction">Model with Interaction</h3>
<p><span class="math display">\[
Y_{hit} = \mu + \theta_h + \tau_i + (\theta \tau)^*_{hi} + \epsilon^*_{hit},
\]</span></p>
<p><strong>Implications:</strong></p>
<ul>
<li><p><strong>Significant Interaction:</strong> Indicates that the effect of treatments differs across blocks. In such cases, it may be necessary to analyze treatment effects within each block separately or use more complex modeling techniques.</p></li>
<li><p><strong>Non-Significant Interaction:</strong> Supports the additive model, validating the use of standard Row–Column ANOVA without interaction terms.</p></li>
</ul>
</section>
<section id="r-example-testing-for-block-treatment-interaction" class="level3">
<h3 class="anchored" data-anchor-id="r-example-testing-for-block-treatment-interaction">R Example: Testing for Block-Treatment Interaction</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated Data with Interaction</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Factors and Blocks</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">row =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each =</span> <span class="dv">6</span>)),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">column =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">each =</span> <span class="dv">3</span>), <span class="dv">3</span>)),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">factorA =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"High"</span>), <span class="at">each =</span> <span class="dv">9</span>)),</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">factorB =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Treatment"</span>), <span class="at">times =</span> <span class="dv">9</span>)),</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">response =</span> <span class="fu">c</span>(</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">2</span>),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>),</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Introduce Interaction Effect</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>response <span class="ot">&lt;-</span> data<span class="sc">$</span>response <span class="sc">+</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>factorA <span class="sc">==</span> <span class="st">"High"</span> <span class="sc">&amp;</span> data<span class="sc">$</span>factorB <span class="sc">==</span> <span class="st">"Treatment"</span>, <span class="dv">2</span>, <span class="dv">0</span>)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANOVA Model with Interaction</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>fit_interaction <span class="ot">&lt;-</span> <span class="fu">lm</span>(response <span class="sc">~</span> row <span class="sc">+</span> column <span class="sc">+</span> factorA <span class="sc">*</span> factorB, <span class="at">data =</span> data)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_interaction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["Sum Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Mean Sq"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"401.98518797","3":"200.99259398","4":"72.34375476","5":"4.680196e-07","_rn_":"row"},{"1":"1","2":"3.66159779","3":"3.66159779","4":"1.31792783","5":"2.753182e-01","_rn_":"column"},{"1":"1","2":"3.36095642","3":"3.36095642","4":"1.20971724","5":"2.948760e-01","_rn_":"factorA"},{"1":"1","2":"0.05257385","3":"0.05257385","4":"0.01892304","5":"8.930730e-01","_rn_":"factorB"},{"1":"1","2":"2.78125290","3":"2.78125290","4":"1.00106314","5":"3.385548e-01","_rn_":"factorA:factorB"},{"1":"11","2":"30.56129090","3":"2.77829917","4":"NA","5":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> - <strong>Interaction Term:</strong> A significant interaction term suggests that the effect of <code>factorA</code> on the response depends on the level of <code>factorB</code>.</p>
<ul>
<li><strong>Main Effects:</strong> Assess the individual impact of each factor, controlling for others.</li>
</ul>
<p><strong>Reference:</strong> Kempthorne, O. (1977). <em>Design and Analysis of Experiments</em>. Robert E. Krieger Publishing Company.</p>
</section>
</section>
</section>
<section id="exercises-1" class="level1">
<h1>Exercises</h1>
<section id="medium-difficulty-1" class="level2">
<h2 class="anchored" data-anchor-id="medium-difficulty-1">Medium Difficulty</h2>
<section id="two-way-ancova-with-interaction-1" class="level3">
<h3 class="anchored" data-anchor-id="two-way-ancova-with-interaction-1">1. Two-Way ANCOVA with Interaction</h3>
<p><strong>Dataset:</strong> Simulate a dataset with three treatments and one covariate.</p>
<p><strong>Tasks:</strong></p>
<ul>
<li>Generate data for treatments A, B, C with a covariate <span class="math inline">\(X\)</span>.</li>
<li>Fit an ANCOVA model adjusting for <span class="math inline">\(X\)</span>.</li>
<li>Test the significance of treatment effects and the covariate.</li>
<li>Generate diagnostic plots and interpret them.</li>
</ul>
<p><strong>R Code Example:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Factors and Covariate</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>Treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">each=</span><span class="dv">30</span>))</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">90</span>, <span class="at">mean=</span><span class="dv">50</span>, <span class="at">sd=</span><span class="dv">10</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate Responses with Treatment Effects and Covariate Effect</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">ifelse</span>(Treatment <span class="sc">==</span> <span class="st">"A"</span>, <span class="dv">0</span>, <span class="fu">ifelse</span>(Treatment <span class="sc">==</span> <span class="st">"B"</span>, <span class="dv">2</span>, <span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0.5</span> <span class="sc">*</span> (X <span class="sc">-</span> <span class="fu">mean</span>(X)) <span class="sc">+</span> </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rnorm</span>(<span class="dv">90</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">3</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>data_sim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Treatment, X, Y)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANCOVA Model</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>model_sim <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> Treatment <span class="sc">+</span> X, <span class="at">data =</span> data_sim)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Y ~ Treatment + X, data = data_sim)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.6486 -1.8937 -0.3341  1.7617  9.2902 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -20.73160    1.87693 -11.045  &lt; 2e-16 ***
TreatmentB    1.72225    0.78691   2.189   0.0313 *  
TreatmentC    4.74007    0.78309   6.053 3.61e-08 ***
X             0.50385    0.03621  13.914  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.031 on 86 degrees of freedom
Multiple R-squared:  0.7332,    Adjusted R-squared:  0.7238 
F-statistic: 78.76 on 3 and 86 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostic Plots</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="week-11_row-column_files/figure-html/unnamed-chunk-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="week-11_row-column_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated Marginal means</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>emm_sim <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_sim, <span class="sc">~</span> Treatment)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>pairwise_sim <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm_sim, <span class="at">method =</span> <span class="st">"pairwise"</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pairwise_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"A - B","2":"-1.722254","3":"0.7869124","4":"86","5":"-2.188622","6":"7.885527e-02","_rn_":"1"},{"1":"A - C","2":"-4.740066","3":"0.7830950","4":"86","5":"-6.052989","6":"1.081426e-07","_rn_":"2"},{"1":"B - C","2":"-3.017812","3":"0.7846485","4":"86","5":"-3.846068","6":"6.666253e-04","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><strong>Questions:</strong></p>
<ol type="1">
<li><strong>Main Effects:</strong>
<ul>
<li><strong>Treatment:</strong> What are the estimated effects of treatments A, B, and C?</li>
<li><strong>Covariate <span class="math inline">\(X\)</span>:</strong> How does <span class="math inline">\(X\)</span> influence the response variable <span class="math inline">\(Y\)</span>?</li>
</ul></li>
<li><strong>Significance Testing:</strong>
<ul>
<li>Are the treatment effects statistically significant after adjusting for <span class="math inline">\(X\)</span>?</li>
<li>Is the covariate <span class="math inline">\(X\)</span> a significant predictor of <span class="math inline">\(Y\)</span>?</li>
</ul></li>
<li><strong>Diagnostic Plots:</strong>
<ul>
<li>Do the residual plots indicate any violations of ANCOVA assumptions such as non-linearity, heteroscedasticity, or non-normality?</li>
<li>Are there any influential observations that may affect the model’s validity?</li>
</ul></li>
<li><strong>Interpretation of Pairwise Comparisons:</strong>
<ul>
<li>Which treatments significantly differ from each other after adjusting for <span class="math inline">\(X\)</span>?</li>
<li>How do the adjusted means compare across treatments?</li>
</ul></li>
</ol>
<p><strong>Expected Answers:</strong></p>
<ol type="1">
<li><strong>Main Effects:</strong>
<ul>
<li>Treatments B and C have positive effects relative to Treatment A.</li>
<li>Covariate <span class="math inline">\(X\)</span> has a positive influence on <span class="math inline">\(Y\)</span>, indicating that as <span class="math inline">\(X\)</span> increases, <span class="math inline">\(Y\)</span> tends to increase.</li>
</ul></li>
<li><strong>Significance Testing:</strong>
<ul>
<li>If the p-values for Treatment are below the significance level (e.g., 0.05), treatments have significant effects.</li>
<li>If the p-value for <span class="math inline">\(X\)</span> is below the significance level, <span class="math inline">\(X\)</span> is a significant predictor.</li>
</ul></li>
<li><strong>Diagnostic Plots:</strong>
<ul>
<li>Random scatter in Residuals vs Fitted suggests homoscedasticity and linearity.</li>
<li>Q-Q plot close to the diagonal indicates normality of residuals.</li>
<li>No points with high leverage or large residuals indicate no influential observations.</li>
</ul></li>
<li><strong>Interpretation of Pairwise Comparisons:</strong>
<ul>
<li>Significant pairwise differences indicate which specific treatments differ after adjusting for <span class="math inline">\(X\)</span>.</li>
<li>Adjusted means provide a clearer comparison by accounting for the covariate’s effect.</li>
</ul></li>
</ol>
</section>
<section id="balloon-data-analysis-1" class="level3">
<h3 class="anchored" data-anchor-id="balloon-data-analysis-1">2. Balloon Data Analysis</h3>
<p><strong>Scenario:</strong> Reanalyze the balloon data, testing for equality of slopes.</p>
<p><strong>Tasks:</strong></p>
<ul>
<li>Fit an ANCOVA model.</li>
<li>Test the homogeneity of regression slopes.</li>
<li>Interpret the adjusted treatment means.</li>
</ul>
<p><strong>R Code Example:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANCOVA Model</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Time <span class="sc">~</span> fColor <span class="sc">+</span> x, <span class="at">data =</span> balloon.data)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Time ~ fColor + x, data = balloon.data)

Residuals:
   Min     1Q Median     3Q    Max 
-3.985 -1.736 -0.211  1.493  5.249 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 18.28474    0.91736  19.932  &lt; 2e-16 ***
fColor2      4.10560    1.29760   3.164 0.003829 ** 
fColor3      3.80129    1.29872   2.927 0.006867 ** 
fColor4     -0.07086    1.29736  -0.055 0.956843    
x           -0.21103    0.04981  -4.237 0.000236 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.594 on 27 degrees of freedom
Multiple R-squared:  0.5776,    Adjusted R-squared:  0.515 
F-statistic: 9.229 on 4 and 27 DF,  p-value: 7.797e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Homogeneity of Slopes</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>model_interaction <span class="ot">&lt;-</span> <span class="fu">lm</span>(Time <span class="sc">~</span> fColor <span class="sc">*</span> x, <span class="at">data =</span> balloon.data)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model, model_interaction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"27","2":"181.7422","3":"NA","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"24","2":"157.0320","3":"3","4":"24.71016","5":"1.258859","6":"0.3107502","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated Marginal means</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>emm_balloon <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span> fColor)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>pairwise_balloon <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm_balloon, <span class="at">method =</span> <span class="st">"pairwise"</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pairwise_balloon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"fColor1 - fColor2","2":"-4.10560387","3":"1.297600","4":"27","5":"-3.16399688","6":"0.01886063","_rn_":"1"},{"1":"fColor1 - fColor3","2":"-3.80129227","3":"1.298720","4":"27","5":"-2.92695236","6":"0.03270334","_rn_":"2"},{"1":"fColor1 - fColor4","2":"0.07086232","3":"1.297361","4":"27","5":"0.05462034","6":"0.99993994","_rn_":"3"},{"1":"fColor2 - fColor3","2":"0.30431160","3":"1.300584","4":"27","5":"0.23398067","6":"0.99537890","_rn_":"4"},{"1":"fColor2 - fColor4","2":"4.17646618","3":"1.298183","4":"27","5":"3.21716321","6":"0.01662144","_rn_":"5"},{"1":"fColor3 - fColor4","2":"3.87215459","3":"1.297959","4":"27","5":"2.98326439","6":"0.02875414","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><strong>Questions:</strong></p>
<ol type="1">
<li><strong>Interaction Term:</strong>
<ul>
<li>What does the interaction term between <code>fColor</code> and <code>x</code> indicate?</li>
<li>Is the interaction term statistically significant?</li>
</ul></li>
<li><strong>Model Interpretation:</strong>
<ul>
<li>If the interaction is not significant, what does this imply about the slopes?</li>
<li>How do the adjusted treatment means differ from the raw means?</li>
</ul></li>
<li><strong>Pairwise Comparisons:</strong>
<ul>
<li>Which balloon colors have significantly different inflation times after adjusting for run order?</li>
<li>How can these differences inform practical decisions in balloon manufacturing?</li>
</ul></li>
<li><strong>Assumption Testing:</strong>
<ul>
<li>Do the diagnostic plots suggest any violations of ANCOVA assumptions?</li>
<li>Should any transformations or alternative models be considered based on these diagnostics?</li>
</ul></li>
</ol>
<p><strong>Expected Answers:</strong></p>
<ol type="1">
<li><strong>Interaction Term:</strong>
<ul>
<li>The interaction term assesses whether the relationship between <code>x</code> (RunOrder) and <code>Time</code> differs across <code>fColor</code> (Color).</li>
<li>A non-significant interaction suggests that slopes are homogeneous across treatments.</li>
</ul></li>
<li><strong>Model Interpretation:</strong>
<ul>
<li>Homogeneous slopes imply that the covariate affects all treatments equally.</li>
<li>Adjusted treatment means account for differences in <code>x</code>, providing a fair comparison of treatment effects.</li>
</ul></li>
<li><strong>Pairwise Comparisons:</strong>
<ul>
<li>Significant differences indicate specific color treatments that lead to different inflation times.</li>
<li>Manufacturers can focus on optimizing colors that perform better in terms of inflation speed.</li>
</ul></li>
<li><strong>Assumption Testing:</strong>
<ul>
<li>Random scatter in Residuals vs Fitted and Q-Q plots close to the diagonal indicate that assumptions are met.</li>
<li>If violations are present, consider data transformations or robust statistical methods.</li>
</ul></li>
</ol>
</section>
</section>
<section id="challenging-problems" class="level2">
<h2 class="anchored" data-anchor-id="challenging-problems">Challenging Problems</h2>
<section id="unbalanced-two-factor-ancova-analysis" class="level3">
<h3 class="anchored" data-anchor-id="unbalanced-two-factor-ancova-analysis">1. Unbalanced Two-Factor ANCOVA Analysis</h3>
<p><strong>Dataset:</strong> Utilize a dataset with unequal numbers of replicates across treatment combinations.</p>
<p><strong>Tasks:</strong></p>
<ul>
<li>Simulate an unbalanced dataset with two factors and one covariate.</li>
<li>Fit an ANCOVA model using both Type II and Type III sums of squares.</li>
<li>Compare the results and discuss how imbalance affects the interpretation of main and interaction effects.</li>
</ul>
<p><strong>R Code Example:</strong></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate Unbalanced Data</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>FactorA <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"A3"</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">5</span>)))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>FactorB <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"B1"</span>, <span class="st">"B2"</span>), <span class="at">each =</span> <span class="dv">7</span>, <span class="at">times =</span> <span class="dv">2</span>))</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate Responses with Treatment and Covariate Effects</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fu">ifelse</span>(FactorA <span class="sc">==</span> <span class="st">"A1"</span>, <span class="dv">0</span>, <span class="fu">ifelse</span>(FactorA <span class="sc">==</span> <span class="st">"A2"</span>, <span class="dv">2</span>, <span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">ifelse</span>(FactorB <span class="sc">==</span> <span class="st">"B1"</span>, <span class="dv">0</span>, <span class="dv">3</span>) <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> (X <span class="sc">-</span> <span class="fu">mean</span>(X)) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">3</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>data_unbalanced <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(FactorA, FactorB, X, Y)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANCOVA Model</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>fit_unbalanced <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> FactorA <span class="sc">*</span> FactorB <span class="sc">+</span> X, <span class="at">data =</span> data_unbalanced)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Type II Sum of Squares</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>typeII <span class="ot">&lt;-</span> <span class="fu">Anova</span>(fit_unbalanced, <span class="at">type =</span> <span class="st">"II"</span>)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(typeII)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Type III Sum of Squares</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>typeIII <span class="ot">&lt;-</span> <span class="fu">Anova</span>(fit_unbalanced, <span class="at">type =</span> <span class="st">"III"</span>)</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(typeIII)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Discussion Points:</strong></p>
<ol type="1">
<li><strong>Type II vs.&nbsp;Type III SS:</strong>
<ul>
<li><strong>Type II:</strong> Tests main effects after accounting for other main effects but ignores interactions.</li>
<li><strong>Type III:</strong> Tests main effects after accounting for all other factors, including interactions.</li>
</ul></li>
<li><strong>Impact of Imbalance:</strong>
<ul>
<li>Imbalanced designs can lead to different interpretations under Type II and Type III SS.</li>
<li>Type I SS is not appropriate here as it is sequential and depends on the order of factors.</li>
</ul></li>
<li><strong>Significance of Effects:</strong>
<ul>
<li>Identify which factors and interactions are significant under each type.</li>
<li>Discuss how imbalance might inflate or deflate the significance levels of certain effects.</li>
</ul></li>
<li><strong>Implications for Experimental Conclusions:</strong>
<ul>
<li>Choosing the appropriate type of sums of squares is crucial for accurate inference.</li>
<li>Misinterpretation can lead to incorrect conclusions about factor effects and interactions.</li>
</ul></li>
</ol>
<p><strong>Expected Insights:</strong></p>
<ul>
<li><strong>Type II SS:</strong> Often preferred when interactions are not of primary interest. It provides unbiased estimates of main effects under the assumption of no interaction.</li>
<li><strong>Type III SS:</strong> Necessary when interactions are present or when the design is unbalanced. It accounts for all factors simultaneously, providing conditional main effects.</li>
<li><strong>Imbalance Effects:</strong> Can distort the Type I SS results, leading to misleading conclusions. Type II and III SS offer more robust alternatives in unbalanced settings.</li>
</ul>
<p><strong>Reference:</strong> Christensen, R. (2018). <em>Analysis of Variance, Design, and Regression</em>. Chapman and Hall/CRC.</p>
</section>
<section id="three-factor-interaction-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="three-factor-interaction-interpretation">2. Three-Factor Interaction Interpretation</h3>
<p><strong>Dataset:</strong> Use a simulated dataset with three factors exhibiting a significant three-way interaction.</p>
<p><strong>Tasks:</strong></p>
<ul>
<li>Simulate data with three factors and one covariate.</li>
<li>Fit a three-way ANCOVA model.</li>
<li>Visualize the three-way interaction.</li>
<li>Use <code>emmeans</code> to estimate marginal means and perform pairwise comparisons.</li>
<li>Explain how the three-way interaction affects the interpretation of main and two-way interactions.</li>
</ul>
<p><strong>R Code Example:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate Data</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>FactorA <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"A3"</span>), <span class="at">each =</span> <span class="dv">24</span>))</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>FactorB <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"B1"</span>, <span class="st">"B2"</span>), <span class="at">each =</span> <span class="dv">12</span>, <span class="at">times =</span> <span class="dv">3</span>))</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>FactorC <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"C1"</span>, <span class="st">"C2"</span>, <span class="st">"C3"</span>), <span class="at">times =</span> <span class="dv">8</span>))</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">72</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate Responses with Three-way Interaction</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(FactorA <span class="sc">==</span> <span class="st">"A1"</span>, <span class="dv">0</span>, <span class="fu">ifelse</span>(FactorA <span class="sc">==</span> <span class="st">"A2"</span>, <span class="dv">2</span>, <span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(FactorB <span class="sc">==</span> <span class="st">"B1"</span>, <span class="dv">0</span>, <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(FactorC <span class="sc">==</span> <span class="st">"C1"</span>, <span class="dv">0</span>, <span class="fu">ifelse</span>(FactorC <span class="sc">==</span> <span class="st">"C2"</span>, <span class="fl">1.5</span>, <span class="dv">3</span>)) <span class="sc">+</span> </span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5</span> <span class="sc">*</span> (X <span class="sc">-</span> <span class="fu">mean</span>(X)) <span class="sc">+</span> </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(FactorA <span class="sc">==</span> <span class="st">"A1"</span> <span class="sc">&amp;</span> FactorB <span class="sc">==</span> <span class="st">"B1"</span>, <span class="dv">0</span>, </span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ifelse</span>(FactorA <span class="sc">==</span> <span class="st">"A2"</span> <span class="sc">&amp;</span> FactorB <span class="sc">==</span> <span class="st">"B2"</span>, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">72</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">3</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>data_three <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(FactorA, FactorB, FactorC, X, Y)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Three-way ANCOVA Model</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>fit_three <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> FactorA <span class="sc">*</span> FactorB <span class="sc">*</span> FactorC <span class="sc">+</span> X, <span class="at">data =</span> data_three)</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_three)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Y ~ FactorA * FactorB * FactorC + X, data = data_three)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.1220 -1.5619  0.1516  1.6510  6.8368 

Coefficients:
                              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                   -14.8115     2.7834  -5.321 2.12e-06 ***
FactorAA2                       4.4442     2.1281   2.088   0.0416 *  
FactorAA3                       4.8113     2.1420   2.246   0.0289 *  
FactorBB2                       0.9491     2.1154   0.449   0.6555    
FactorCC2                      -1.5970     2.1606  -0.739   0.4631    
FactorCC3                       2.4882     2.1459   1.160   0.2514    
X                               0.4291     0.0452   9.493 5.02e-13 ***
FactorAA2:FactorBB2            -2.3872     3.0185  -0.791   0.4326    
FactorAA3:FactorBB2            -1.9274     3.0425  -0.633   0.5292    
FactorAA2:FactorCC2             0.7170     3.0209   0.237   0.8133    
FactorAA3:FactorCC2             2.6386     3.1886   0.828   0.4117    
FactorAA2:FactorCC3            -2.1941     3.0202  -0.726   0.4707    
FactorAA3:FactorCC3             1.6601     3.1140   0.533   0.5962    
FactorBB2:FactorCC2             3.2077     3.0003   1.069   0.2899    
FactorBB2:FactorCC3             4.4736     3.0125   1.485   0.1435    
FactorAA2:FactorBB2:FactorCC2  -1.2045     4.2875  -0.281   0.7799    
FactorAA3:FactorBB2:FactorCC2   3.0157     4.3435   0.694   0.4905    
FactorAA2:FactorBB2:FactorCC3   2.3360     4.2358   0.551   0.5836    
FactorAA3:FactorBB2:FactorCC3  -1.9520     4.3817  -0.445   0.6578    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.989 on 53 degrees of freedom
Multiple R-squared:  0.8424,    Adjusted R-squared:  0.7889 
F-statistic: 15.74 on 18 and 53 DF,  p-value: 3.021e-15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Three-way Interaction</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_three, <span class="fu">aes</span>(<span class="at">x=</span>FactorA, <span class="at">y=</span>Y, <span class="at">color=</span>FactorB, <span class="at">group=</span>FactorB)) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> FactorC) <span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Three-Way Interaction Plot"</span>, <span class="at">x=</span><span class="st">"Factor A"</span>, <span class="at">y=</span><span class="st">"Response"</span>) <span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="week-11_row-column_files/figure-html/unnamed-chunk-12-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="week-11_row-column_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated Marginal means</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>emm_three <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(fit_three, <span class="sc">~</span> FactorA <span class="sc">*</span> FactorB <span class="sc">*</span> FactorC)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>contrast_results <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm_three, <span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"none"</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(contrast_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"A1 B1 C1 - A2 B1 C1","2":"-4.44419672","3":"2.128143","4":"53","5":"-2.08829805","6":"4.159137e-02","_rn_":"1"},{"1":"A1 B1 C1 - A3 B1 C1","2":"-4.81127782","3":"2.142007","4":"53","5":"-2.24615421","6":"2.888592e-02","_rn_":"2"},{"1":"A1 B1 C1 - A1 B2 C1","2":"-0.94913169","3":"2.115444","4":"53","5":"-0.44866786","6":"6.555004e-01","_rn_":"3"},{"1":"A1 B1 C1 - A2 B2 C1","2":"-3.00618266","3":"2.114731","4":"53","5":"-1.42154353","6":"1.610167e-01","_rn_":"4"},{"1":"A1 B1 C1 - A3 B2 C1","2":"-3.83305037","3":"2.117047","4":"53","5":"-1.81056455","6":"7.587832e-02","_rn_":"5"},{"1":"A1 B1 C1 - A1 B1 C2","2":"1.59703736","3":"2.160630","4":"53","5":"0.73915361","6":"4.630749e-01","_rn_":"6"},{"1":"A1 B1 C1 - A2 B1 C2","2":"-3.56416952","3":"2.129338","4":"53","5":"-1.67383907","6":"1.000548e-01","_rn_":"7"},{"1":"A1 B1 C1 - A3 B1 C2","2":"-5.85286378","3":"2.136245","4":"53","5":"-2.73978989","6":"8.358096e-03","_rn_":"8"},{"1":"A1 B1 C1 - A1 B2 C2","2":"-2.55974292","3":"2.131825","4":"53","5":"-1.20072871","6":"2.351955e-01","_rn_":"9"},{"1":"A1 B1 C1 - A2 B2 C2","2":"-4.12930490","3":"2.148648","4":"53","5":"-1.92181508","6":"6.001269e-02","_rn_":"10"},{"1":"A1 B1 C1 - A3 B2 C2","2":"-11.09796145","3":"2.113927","4":"53","5":"-5.24992633","6":"2.738314e-06","_rn_":"11"},{"1":"A1 B1 C1 - A1 B1 C3","2":"-2.48823085","3":"2.145934","4":"53","5":"-1.15950958","6":"2.514457e-01","_rn_":"12"},{"1":"A1 B1 C1 - A2 B1 C3","2":"-4.73832827","3":"2.121670","4":"53","5":"-2.23330102","6":"2.977409e-02","_rn_":"13"},{"1":"A1 B1 C1 - A3 B1 C3","2":"-8.95959400","3":"2.118797","4":"53","5":"-4.22862328","6":"9.334777e-05","_rn_":"14"},{"1":"A1 B1 C1 - A1 B2 C3","2":"-7.91097423","3":"2.115217","4":"53","5":"-3.74002912","6":"4.531205e-04","_rn_":"15"},{"1":"A1 B1 C1 - A2 B2 C3","2":"-10.10988528","3":"2.126811","4":"53","5":"-4.75354273","6":"1.570835e-05","_rn_":"16"},{"1":"A1 B1 C1 - A3 B2 C3","2":"-10.50301563","3":"2.118633","4":"53","5":"-4.95744938","6":"7.712392e-06","_rn_":"17"},{"1":"A2 B1 C1 - A3 B1 C1","2":"-0.36708109","3":"2.115614","4":"53","5":"-0.17351043","6":"8.629112e-01","_rn_":"18"},{"1":"A2 B1 C1 - A1 B2 C1","2":"3.49506503","3":"2.119055","4":"53","5":"1.64935094","6":"1.049912e-01","_rn_":"19"},{"1":"A2 B1 C1 - A2 B2 C1","2":"1.43801406","3":"2.138649","4":"53","5":"0.67239355","6":"5.042542e-01","_rn_":"20"},{"1":"A2 B1 C1 - A3 B2 C1","2":"0.61114636","3":"2.146584","4":"53","5":"0.28470647","6":"7.769786e-01","_rn_":"21"},{"1":"A2 B1 C1 - A1 B1 C2","2":"6.04123408","3":"2.122653","4":"53","5":"2.84607691","6":"6.281015e-03","_rn_":"22"},{"1":"A2 B1 C1 - A2 B1 C2","2":"0.88002720","3":"2.113337","4":"53","5":"0.41641593","6":"6.787873e-01","_rn_":"23"},{"1":"A2 B1 C1 - A3 B1 C2","2":"-1.40866706","3":"2.187013","4":"53","5":"-0.64410560","6":"5.222848e-01","_rn_":"24"},{"1":"A2 B1 C1 - A1 B2 C2","2":"1.88445381","3":"2.113520","4":"53","5":"0.89161867","6":"3.766275e-01","_rn_":"25"},{"1":"A2 B1 C1 - A2 B2 C2","2":"0.31489182","3":"2.117767","4":"53","5":"0.14869048","6":"8.823622e-01","_rn_":"26"},{"1":"A2 B1 C1 - A3 B2 C2","2":"-6.65376473","3":"2.134743","4":"53","5":"-3.11689216","6":"2.950541e-03","_rn_":"27"},{"1":"A2 B1 C1 - A1 B1 C3","2":"1.95596587","3":"2.116829","4":"53","5":"0.92400741","6":"3.596703e-01","_rn_":"28"},{"1":"A2 B1 C1 - A2 B1 C3","2":"-0.29413155","3":"2.114243","4":"53","5":"-0.13911910","6":"8.898833e-01","_rn_":"29"},{"1":"A2 B1 C1 - A3 B1 C3","2":"-4.51539728","3":"2.151420","4":"53","5":"-2.09879857","6":"4.061544e-02","_rn_":"30"},{"1":"A2 B1 C1 - A1 B2 C3","2":"-3.46677750","3":"2.119443","4":"53","5":"-1.63570205","6":"1.078278e-01","_rn_":"31"},{"1":"A2 B1 C1 - A2 B2 C3","2":"-5.66568855","3":"2.169381","4":"53","5":"-2.61166113","6":"1.169451e-02","_rn_":"32"},{"1":"A2 B1 C1 - A3 B2 C3","2":"-6.05881890","3":"2.115714","4":"53","5":"-2.86372282","6":"5.986420e-03","_rn_":"33"},{"1":"A3 B1 C1 - A1 B2 C1","2":"3.86214613","3":"2.128584","4":"53","5":"1.81442004","6":"7.527466e-02","_rn_":"34"},{"1":"A3 B1 C1 - A2 B2 C1","2":"1.80509515","3":"2.155991","4":"53","5":"0.83724632","6":"4.062137e-01","_rn_":"35"},{"1":"A3 B1 C1 - A3 B2 C1","2":"0.97822745","3":"2.166060","4":"53","5":"0.45161609","6":"6.533883e-01","_rn_":"36"},{"1":"A3 B1 C1 - A1 B1 C2","2":"6.40831517","3":"2.115691","4":"53","5":"3.02894667","6":"3.786965e-03","_rn_":"37"},{"1":"A3 B1 C1 - A2 B1 C2","2":"1.24710830","3":"2.115174","4":"53","5":"0.58960093","6":"5.579634e-01","_rn_":"38"},{"1":"A3 B1 C1 - A3 B1 C2","2":"-1.04158597","3":"2.214454","4":"53","5":"-0.47035796","6":"6.400292e-01","_rn_":"39"},{"1":"A3 B1 C1 - A1 B2 C2","2":"2.25153490","3":"2.114443","4":"53","5":"1.06483589","6":"2.917775e-01","_rn_":"40"},{"1":"A3 B1 C1 - A2 B2 C2","2":"0.68197292","3":"2.113667","4":"53","5":"0.32264921","6":"7.482303e-01","_rn_":"41"},{"1":"A3 B1 C1 - A3 B2 C2","2":"-6.28668363","3":"2.150901","4":"53","5":"-2.92281377","6":"5.090595e-03","_rn_":"42"},{"1":"A3 B1 C1 - A1 B1 C3","2":"2.32304697","3":"2.113442","4":"53","5":"1.09917694","6":"2.766589e-01","_rn_":"43"},{"1":"A3 B1 C1 - A2 B1 C3","2":"0.07294954","3":"2.119461","4":"53","5":"0.03441892","6":"9.726724e-01","_rn_":"44"},{"1":"A3 B1 C1 - A3 B1 C3","2":"-4.14831618","3":"2.172063","4":"53","5":"-1.90985036","6":"6.157091e-02","_rn_":"45"},{"1":"A3 B1 C1 - A1 B2 C3","2":"-3.09969641","3":"2.129212","4":"53","5":"-1.45579542","6":"1.513475e-01","_rn_":"46"},{"1":"A3 B1 C1 - A2 B2 C3","2":"-5.29860746","3":"2.193765","4":"53","5":"-2.41530264","6":"1.920345e-02","_rn_":"47"},{"1":"A3 B1 C1 - A3 B2 C3","2":"-5.69173781","3":"2.122699","4":"53","5":"-2.68136845","6":"9.752806e-03","_rn_":"48"},{"1":"A1 B2 C1 - A2 B2 C1","2":"-2.05705097","3":"2.120329","4":"53","5":"-0.97015659","6":"3.363752e-01","_rn_":"49"},{"1":"A1 B2 C1 - A3 B2 C1","2":"-2.88391867","3":"2.124795","4":"53","5":"-1.35726923","6":"1.804476e-01","_rn_":"50"},{"1":"A1 B2 C1 - A1 B1 C2","2":"2.54616905","3":"2.142887","4":"53","5":"1.18819559","6":"2.400536e-01","_rn_":"51"},{"1":"A1 B2 C1 - A2 B1 C2","2":"-2.61503783","3":"2.119810","4":"53","5":"-1.23361906","6":"2.227878e-01","_rn_":"52"},{"1":"A1 B2 C1 - A3 B1 C2","2":"-4.90373209","3":"2.152164","4":"53","5":"-2.27851180","6":"2.675304e-02","_rn_":"53"},{"1":"A1 B2 C1 - A1 B2 C2","2":"-1.61061122","3":"2.121431","4":"53","5":"-0.75920965","6":"4.510907e-01","_rn_":"54"},{"1":"A1 B2 C1 - A2 B2 C2","2":"-3.18017321","3":"2.133549","4":"53","5":"-1.49055524","6":"1.420062e-01","_rn_":"55"},{"1":"A1 B2 C1 - A3 B2 C2","2":"-10.14882976","3":"2.118340","4":"53","5":"-4.79093584","6":"1.379705e-05","_rn_":"56"},{"1":"A1 B2 C1 - A1 B1 C3","2":"-1.53909916","3":"2.131498","4":"53","5":"-0.72207393","6":"4.734230e-01","_rn_":"57"},{"1":"A1 B2 C1 - A2 B1 C3","2":"-3.78919658","3":"2.115368","4":"53","5":"-1.79127053","6":"7.896055e-02","_rn_":"58"},{"1":"A1 B2 C1 - A3 B1 C3","2":"-8.01046231","3":"2.127728","4":"53","5":"-3.76479624","6":"4.191428e-04","_rn_":"59"},{"1":"A1 B2 C1 - A1 B2 C3","2":"-6.96184254","3":"2.113320","4":"53","5":"-3.29426807","6":"1.762722e-03","_rn_":"60"},{"1":"A1 B2 C1 - A2 B2 C3","2":"-9.16075358","3":"2.139566","4":"53","5":"-4.28159380","6":"7.826694e-05","_rn_":"61"},{"1":"A1 B2 C1 - A3 B2 C3","2":"-9.55388393","3":"2.114032","4":"53","5":"-4.51927034","6":"3.512963e-05","_rn_":"62"},{"1":"A2 B2 C1 - A3 B2 C1","2":"-0.82686770","3":"2.113864","4":"53","5":"-0.39116403","6":"6.972441e-01","_rn_":"63"},{"1":"A2 B2 C1 - A1 B1 C2","2":"4.60322002","3":"2.178061","4":"53","5":"2.11344870","6":"3.928722e-02","_rn_":"64"},{"1":"A2 B2 C1 - A2 B1 C2","2":"-0.55798685","3":"2.140199","4":"53","5":"-0.26071731","6":"7.953209e-01","_rn_":"65"},{"1":"A2 B2 C1 - A3 B1 C2","2":"-2.84668112","3":"2.126312","4":"53","5":"-1.33878835","6":"1.863539e-01","_rn_":"66"},{"1":"A2 B2 C1 - A1 B2 C2","2":"0.44643975","3":"2.143380","4":"53","5":"0.20828774","6":"8.358027e-01","_rn_":"67"},{"1":"A2 B2 C1 - A2 B2 C2","2":"-1.12312223","3":"2.163972","4":"53","5":"-0.51900960","6":"6.059146e-01","_rn_":"68"},{"1":"A2 B2 C1 - A3 B2 C2","2":"-8.09177878","3":"2.113480","4":"53","5":"-3.82865221","6":"3.424520e-04","_rn_":"69"},{"1":"A2 B2 C1 - A1 B1 C3","2":"0.51795181","3":"2.160728","4":"53","5":"0.23971175","6":"8.114784e-01","_rn_":"70"},{"1":"A2 B2 C1 - A2 B1 C3","2":"-1.73214561","3":"2.129932","4":"53","5":"-0.81323999","6":"4.197189e-01","_rn_":"71"},{"1":"A2 B2 C1 - A3 B1 C3","2":"-5.95341133","3":"2.114641","4":"53","5":"-2.81532968","6":"6.826598e-03","_rn_":"72"},{"1":"A2 B2 C1 - A1 B2 C3","2":"-4.90479156","3":"2.119913","4":"53","5":"-2.31367582","6":"2.459482e-02","_rn_":"73"},{"1":"A2 B2 C1 - A2 B2 C3","2":"-7.10370261","3":"2.119499","4":"53","5":"-3.35159568","6":"1.487547e-03","_rn_":"74"},{"1":"A2 B2 C1 - A3 B2 C3","2":"-7.49683296","3":"2.125519","4":"53","5":"-3.52705934","6":"8.765696e-04","_rn_":"75"},{"1":"A3 B2 C1 - A1 B1 C2","2":"5.43008772","3":"2.190239","4":"53","5":"2.47922193","6":"1.638212e-02","_rn_":"76"},{"1":"A3 B2 C1 - A2 B1 C2","2":"0.26888085","3":"2.148351","4":"53","5":"0.12515685","6":"9.008729e-01","_rn_":"77"},{"1":"A3 B2 C1 - A3 B1 C2","2":"-2.01981342","3":"2.121527","4":"53","5":"-0.95205658","6":"3.453901e-01","_rn_":"78"},{"1":"A3 B2 C1 - A1 B2 C2","2":"1.27330745","3":"2.151959","4":"53","5":"0.59169683","6":"5.565692e-01","_rn_":"79"},{"1":"A3 B2 C1 - A2 B2 C2","2":"-0.29625453","3":"2.174862","4":"53","5":"-0.13621764","6":"8.921653e-01","_rn_":"80"},{"1":"A3 B2 C1 - A3 B2 C2","2":"-7.26491108","3":"2.114635","4":"53","5":"-3.43553881","6":"1.157018e-03","_rn_":"81"},{"1":"A3 B2 C1 - A1 B1 C3","2":"1.34481951","3":"2.171293","4":"53","5":"0.61936339","6":"5.383305e-01","_rn_":"82"},{"1":"A3 B2 C1 - A2 B1 C3","2":"-0.90527791","3":"2.136484","4":"53","5":"-0.42372329","6":"6.734824e-01","_rn_":"83"},{"1":"A3 B2 C1 - A3 B1 C3","2":"-5.12654363","3":"2.113482","4":"53","5":"-2.42563892","6":"1.871946e-02","_rn_":"84"},{"1":"A3 B2 C1 - A1 B2 C3","2":"-4.07792386","3":"2.124262","4":"53","5":"-1.91968968","6":"6.028701e-02","_rn_":"85"},{"1":"A3 B2 C1 - A2 B2 C3","2":"-6.27683491","3":"2.116362","4":"53","5":"-2.96586058","6":"4.518256e-03","_rn_":"86"},{"1":"A3 B2 C1 - A3 B2 C3","2":"-6.66996526","3":"2.131223","4":"53","5":"-3.12964226","6":"2.844760e-03","_rn_":"87"},{"1":"A1 B1 C2 - A2 B1 C2","2":"-5.16120688","3":"2.121744","4":"53","5":"-2.43253039","6":"1.840291e-02","_rn_":"88"},{"1":"A1 B1 C2 - A3 B1 C2","2":"-7.44990114","3":"2.246450","4":"53","5":"-3.31630018","6":"1.651711e-03","_rn_":"89"},{"1":"A1 B1 C2 - A1 B2 C2","2":"-4.15678027","3":"2.120090","4":"53","5":"-1.96066220","6":"5.518335e-02","_rn_":"90"},{"1":"A1 B1 C2 - A2 B2 C2","2":"-5.72634225","3":"2.114212","4":"53","5":"-2.70849947","6":"9.080496e-03","_rn_":"91"},{"1":"A1 B1 C2 - A3 B2 C2","2":"-12.69499881","3":"2.171800","4":"53","5":"-5.84538057","6":"3.187089e-07","_rn_":"92"},{"1":"A1 B1 C2 - A1 B1 C3","2":"-4.08526821","3":"2.114714","4":"53","5":"-1.93182994","6":"5.873440e-02","_rn_":"93"},{"1":"A1 B1 C2 - A2 B1 C3","2":"-6.33536563","3":"2.129440","4":"53","5":"-2.97513209","6":"4.403100e-03","_rn_":"94"},{"1":"A1 B1 C2 - A3 B1 C3","2":"-10.55663136","3":"2.197393","4":"53","5":"-4.80416140","6":"1.317721e-05","_rn_":"95"},{"1":"A1 B1 C2 - A1 B2 C3","2":"-9.50801158","3":"2.143753","4":"53","5":"-4.43521778","6":"4.672247e-05","_rn_":"96"},{"1":"A1 B1 C2 - A2 B2 C3","2":"-11.70692263","3":"2.222771","4":"53","5":"-5.26681566","6":"2.578126e-06","_rn_":"97"},{"1":"A1 B1 C2 - A3 B2 C3","2":"-12.10005298","3":"2.134453","4":"53","5":"-5.66892433","6":"6.058018e-07","_rn_":"98"},{"1":"A2 B1 C2 - A3 B1 C2","2":"-2.28869427","3":"2.189595","4":"53","5":"-1.04525940","6":"3.006471e-01","_rn_":"99"},{"1":"A2 B1 C2 - A1 B2 C2","2":"1.00442660","3":"2.113404","4":"53","5":"0.47526477","6":"6.365512e-01","_rn_":"100"},{"1":"A2 B1 C2 - A2 B2 C2","2":"-0.56513538","3":"2.117146","4":"53","5":"-0.26693269","6":"7.905569e-01","_rn_":"101"},{"1":"A2 B1 C2 - A3 B2 C2","2":"-7.53379193","3":"2.136172","4":"53","5":"-3.52677199","6":"8.773389e-04","_rn_":"102"},{"1":"A2 B1 C2 - A1 B1 C3","2":"1.07593867","3":"2.116279","4":"53","5":"0.50841050","6":"6.132753e-01","_rn_":"103"},{"1":"A2 B1 C2 - A2 B1 C3","2":"-1.17415875","3":"2.114561","4":"53","5":"-0.55527307","6":"5.810441e-01","_rn_":"104"},{"1":"A2 B1 C2 - A3 B1 C3","2":"-5.39542448","3":"2.153306","4":"53","5":"-2.50564654","6":"1.532944e-02","_rn_":"105"},{"1":"A2 B1 C2 - A1 B2 C3","2":"-4.34680471","3":"2.120222","4":"53","5":"-2.05016450","6":"4.530923e-02","_rn_":"106"},{"1":"A2 B1 C2 - A2 B2 C3","2":"-6.54571576","3":"2.171650","4":"53","5":"-3.01416707","6":"3.947633e-03","_rn_":"107"},{"1":"A2 B1 C2 - A3 B2 C3","2":"-6.93884611","3":"2.116211","4":"53","5":"-3.27890048","6":"1.844290e-03","_rn_":"108"},{"1":"A3 B1 C2 - A1 B2 C2","2":"3.29312087","3":"2.194799","4":"53","5":"1.50042006","6":"1.394397e-01","_rn_":"109"},{"1":"A3 B1 C2 - A2 B2 C2","2":"1.72355889","3":"2.226303","4":"53","5":"0.77417975","6":"4.422644e-01","_rn_":"110"},{"1":"A3 B1 C2 - A3 B2 C2","2":"-5.24509766","3":"2.129400","4":"53","5":"-2.46318122","6":"1.705257e-02","_rn_":"111"},{"1":"A3 B1 C2 - A1 B1 C3","2":"3.36463293","3":"2.221531","4":"53","5":"1.51455568","6":"1.358264e-01","_rn_":"112"},{"1":"A3 B1 C2 - A2 B1 C3","2":"1.11453551","3":"2.171725","4":"53","5":"0.51320297","6":"6.099421e-01","_rn_":"113"},{"1":"A3 B1 C2 - A3 B1 C3","2":"-3.10673022","3":"2.119349","4":"53","5":"-1.46588868","6":"1.485867e-01","_rn_":"114"},{"1":"A3 B1 C2 - A1 B2 C3","2":"-2.05811044","3":"2.151188","4":"53","5":"-0.95673192","6":"3.430465e-01","_rn_":"115"},{"1":"A3 B1 C2 - A2 B2 C3","2":"-4.25702149","3":"2.114572","4":"53","5":"-2.01318340","6":"4.918653e-02","_rn_":"116"},{"1":"A3 B1 C2 - A3 B2 C3","2":"-4.65015184","3":"2.163268","4":"53","5":"-2.14959534","6":"3.617114e-02","_rn_":"117"},{"1":"A1 B2 C2 - A2 B2 C2","2":"-1.56956198","3":"2.116058","4":"53","5":"-0.74173852","6":"4.615201e-01","_rn_":"118"},{"1":"A1 B2 C2 - A3 B2 C2","2":"-8.53821853","3":"2.139117","4":"53","5":"-3.99146932","6":"2.031339e-04","_rn_":"119"},{"1":"A1 B2 C2 - A1 B1 C3","2":"0.07151206","3":"2.115333","4":"53","5":"0.03380652","6":"9.731584e-01","_rn_":"120"},{"1":"A1 B2 C2 - A2 B1 C3","2":"-2.17858536","3":"2.115324","4":"53","5":"-1.02990625","6":"3.077313e-01","_rn_":"121"},{"1":"A1 B2 C2 - A3 B1 C3","2":"-6.39985108","3":"2.157148","4":"53","5":"-2.96681106","6":"4.506323e-03","_rn_":"122"},{"1":"A1 B2 C2 - A1 B2 C3","2":"-5.35123131","3":"2.121892","4":"53","5":"-2.52191549","6":"1.471218e-02","_rn_":"123"},{"1":"A1 B2 C2 - A2 B2 C3","2":"-7.55014236","3":"2.176241","4":"53","5":"-3.46934969","6":"1.044700e-03","_rn_":"124"},{"1":"A1 B2 C2 - A3 B2 C3","2":"-7.94327271","3":"2.117326","4":"53","5":"-3.75155887","6":"4.369865e-04","_rn_":"125"},{"1":"A2 B2 C2 - A3 B2 C2","2":"-6.96865655","3":"2.158427","4":"53","5":"-3.22858084","6":"2.137034e-03","_rn_":"126"},{"1":"A2 B2 C2 - A1 B1 C3","2":"1.64107405","3":"2.113369","4":"53","5":"0.77652030","6":"4.408937e-01","_rn_":"127"},{"1":"A2 B2 C2 - A2 B1 C3","2":"-0.60902338","3":"2.122751","4":"53","5":"-0.28690288","6":"7.753054e-01","_rn_":"128"},{"1":"A2 B2 C2 - A3 B1 C3","2":"-4.83028910","3":"2.181313","4":"53","5":"-2.21439477","6":"3.112441e-02","_rn_":"129"},{"1":"A2 B2 C2 - A1 B2 C3","2":"-3.78166933","3":"2.134269","4":"53","5":"-1.77188027","6":"8.216299e-02","_rn_":"130"},{"1":"A2 B2 C2 - A2 B2 C3","2":"-5.98058038","3":"2.204448","4":"53","5":"-2.71296069","6":"8.974110e-03","_rn_":"131"},{"1":"A2 B2 C2 - A3 B2 C3","2":"-6.37371073","3":"2.126676","4":"53","5":"-2.99702906","6":"4.141901e-03","_rn_":"132"},{"1":"A3 B2 C2 - A1 B1 C3","2":"8.60973060","3":"2.155363","4":"53","5":"3.99456191","6":"2.011098e-04","_rn_":"133"},{"1":"A3 B2 C2 - A2 B1 C3","2":"6.35963318","3":"2.126791","4":"53","5":"2.99024890","6":"4.221191e-03","_rn_":"134"},{"1":"A3 B2 C2 - A3 B1 C3","2":"2.13836745","3":"2.115745","4":"53","5":"1.01069225","6":"3.167558e-01","_rn_":"135"},{"1":"A3 B2 C2 - A1 B2 C3","2":"3.18698722","3":"2.117989","4":"53","5":"1.50472353","6":"1.383317e-01","_rn_":"136"},{"1":"A3 B2 C2 - A2 B2 C3","2":"0.98807617","3":"2.121686","4":"53","5":"0.46570329","6":"6.433361e-01","_rn_":"137"},{"1":"A3 B2 C2 - A3 B2 C3","2":"0.59494582","3":"2.122847","4":"53","5":"0.28025843","6":"7.803703e-01","_rn_":"138"},{"1":"A1 B1 C3 - A2 B1 C3","2":"-2.25009742","3":"2.121363","4":"53","5":"-1.06068498","6":"2.936429e-01","_rn_":"139"},{"1":"A1 B1 C3 - A3 B1 C3","2":"-6.47136315","3":"2.177568","4":"53","5":"-2.97183066","6":"4.443788e-03","_rn_":"140"},{"1":"A1 B1 C3 - A1 B2 C3","2":"-5.42274338","3":"2.132181","4":"53","5":"-2.54328457","6":"1.393566e-02","_rn_":"141"},{"1":"A1 B1 C3 - A2 B2 C3","2":"-7.62165442","3":"2.200137","4":"53","5":"-3.46417322","6":"1.061197e-03","_rn_":"142"},{"1":"A1 B1 C3 - A3 B2 C3","2":"-8.01478477","3":"2.125016","4":"53","5":"-3.77163529","6":"4.102001e-04","_rn_":"143"},{"1":"A2 B1 C3 - A3 B1 C3","2":"-4.22126573","3":"2.140562","4":"53","5":"-1.97203611","6":"5.383400e-02","_rn_":"144"},{"1":"A2 B1 C3 - A1 B2 C3","2":"-3.17264595","3":"2.115603","4":"53","5":"-1.49964123","6":"1.396410e-01","_rn_":"145"},{"1":"A2 B1 C3 - A2 B2 C3","2":"-5.37155700","3":"2.156089","4":"53","5":"-2.49134245","6":"1.589142e-02","_rn_":"146"},{"1":"A2 B1 C3 - A3 B2 C3","2":"-5.76468735","3":"2.113657","4":"53","5":"-2.72735266","6":"8.638660e-03","_rn_":"147"},{"1":"A3 B1 C3 - A1 B2 C3","2":"1.04861977","3":"2.127131","4":"53","5":"0.49297381","6":"6.240675e-01","_rn_":"148"},{"1":"A3 B1 C3 - A2 B2 C3","2":"-1.15029128","3":"2.115099","4":"53","5":"-0.54384745","6":"5.888270e-01","_rn_":"149"},{"1":"A3 B1 C3 - A3 B2 C3","2":"-1.54342163","3":"2.134836","4":"53","5":"-0.72296973","6":"4.728770e-01","_rn_":"150"},{"1":"A1 B2 C3 - A2 B2 C3","2":"-2.19891105","3":"2.138761","4":"53","5":"-1.02812359","6":"3.085611e-01","_rn_":"151"},{"1":"A1 B2 C3 - A3 B2 C3","2":"-2.59204140","3":"2.114174","4":"53","5":"-1.22603020","6":"2.256070e-01","_rn_":"152"},{"1":"A2 B2 C3 - A3 B2 C3","2":"-0.39313035","3":"2.148865","4":"53","5":"-0.18294791","6":"8.555369e-01","_rn_":"153"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ol type="1">
<li><strong>Three-Way Interaction:</strong>
<ul>
<li>The interaction plot demonstrates how the interaction between Factor A and Factor B varies across different levels of Factor C.</li>
<li>Non-parallel lines across facets indicate a significant three-way interaction.</li>
</ul></li>
<li><strong>Impact on Main and Two-Way Interactions:</strong>
<ul>
<li>Significant higher-order interactions imply that main effects and two-way interactions cannot be interpreted in isolation.</li>
<li>The effect of one factor depends on the combination of other factors, necessitating a comprehensive analysis.</li>
</ul></li>
<li><strong>Practical Implications:</strong>
<ul>
<li>Understanding three-way interactions provides nuanced insights into how multiple factors jointly influence the response variable.</li>
<li>This can inform more sophisticated decision-making and strategy development in experimental settings.</li>
</ul></li>
</ol>
<p><strong>Reference:</strong> Dean, Voss &amp; Draguljić (2017). <em>Design and Analysis of Experiments</em>. Springer.</p>
</section>
<section id="mathematical-proof-of-interaction-contrasts" class="level3">
<h3 class="anchored" data-anchor-id="mathematical-proof-of-interaction-contrasts">3. Mathematical Proof of Interaction Contrasts</h3>
<p><strong>Task:</strong> Derive formulas for interaction contrasts in a three-factor design and prove that they measure deviations from additivity.</p>
<p><strong>Requirements:</strong></p>
<ul>
<li>Show how to construct interaction contrasts.</li>
<li>Prove that if all interaction contrasts are zero, the model is additive.</li>
</ul>
<p><strong>Hints:</strong></p>
<ul>
<li>Utilize the definitions of main effects and interaction terms.</li>
<li>Employ properties of linear algebra to demonstrate the relationship between interaction contrasts and additivity.</li>
<li>Reference Dean et al.&nbsp;(2017) and Christensen (2018) for theoretical foundations.</li>
</ul>
<p><strong>Proof Outline:</strong></p>
<ol type="1">
<li><strong>Define the Three-Factor Model:</strong></li>
</ol>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_k + (\alpha\beta)^*_{ij}+ (\alpha\gamma)^*_{ik}+ (\beta\gamma)^*_{jk}+ (\alpha\beta\gamma)^*_{ijk}+ \epsilon_{ijk}
\]</span></p>
<p>where <span class="math inline">\(\sum \alpha_i = \sum \beta_j = \sum \gamma_k = 0\)</span>.</p>
<ol type="1">
<li><p><strong>Construct Interaction Contrasts:</strong></p>
<ul>
<li><strong>Two-Way Interactions:</strong>
<ul>
<li><span class="math inline">\((\alpha\beta)_{ij}\)</span>: Measures the interaction between Factors A and B.</li>
<li>Similarly for <span class="math inline">\((\alpha\gamma)^*{ik}\)</span> and <span class="math inline">\((\beta\gamma)^*{jk}\)</span>.</li>
</ul></li>
<li><strong>Three-Way Interaction:</strong>
<ul>
<li><span class="math inline">\((\alpha\beta\gamma)_{ijk}\)</span>: Measures the deviation from additivity among all three factors.</li>
</ul></li>
</ul></li>
<li><p><strong>Proof of Additivity:</strong></p>
<ul>
<li><strong>Additive Model:</strong> If all interaction terms are zero (<span class="math inline">\((\alpha\beta)^*_{ij}= (\alpha\gamma)^*_{ik}= (\beta\gamma)^*_{jk}= (\alpha\beta\gamma)^*_{ijk}= 0\)</span>), the model simplifies to:</li>
</ul></li>
</ol>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_k + \epsilon_{ijk}
\]</span></p>
<pre><code> This indicates that the response is purely additive with respect to the main effects.</code></pre>
<ul>
<li><strong>Zero Interaction Contrasts:</strong> If all interaction contrasts are zero, the model exhibits additivity. Thus, interaction contrasts quantify how much the actual model deviates from an additive one.</li>
</ul>
<ol type="1">
<li><p><strong>Conclusion:</strong></p>
<p>Interaction contrasts provide a mathematical measure of the presence and magnitude of interactions. Non-zero contrasts indicate that the combined effect of factors is not merely the sum of their individual effects, highlighting the importance of considering interactions in experimental analysis.</p></li>
</ol>
<p><strong>Reference:</strong> Dean, Voss &amp; Draguljić (2017). <em>Design and Analysis of Experiments</em>. Springer.</p>
</section>
</section>
</section>
<section id="appendix-advanced-mathematical-derivations-1" class="level1">
<h1>Appendix: Advanced Mathematical Derivations</h1>
<section id="variance-calculations-for-latin-square-designs-1" class="level2">
<h2 class="anchored" data-anchor-id="variance-calculations-for-latin-square-designs-1">Variance Calculations for Latin Square Designs</h2>
<p>In a <strong>Latin Square Design</strong> with <span class="math inline">\(v\)</span> treatments, the variance of the estimated treatment effects is influenced by the design’s structure.</p>
<section id="formula-2" class="level3">
<h3 class="anchored" data-anchor-id="formula-2">Formula</h3>
<p>For a Latin Square with <span class="math inline">\(v\)</span> treatments:</p>
<p><span class="math display">\[
Var(\tau_i) = \frac{\sigma^2}{v}
\]</span></p>
</section>
<section id="derivation-1" class="level3">
<h3 class="anchored" data-anchor-id="derivation-1">Derivation</h3>
<ol type="1">
<li><p><strong>Model Setup:</strong></p>
<p>The ANOVA model for a Latin Square is:</p></li>
</ol>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \tau_k + \epsilon_{ijk},
\]</span></p>
<p>where <span class="math inline">\(\epsilon_{ijk} \sim N(0, \sigma^2)\)</span>.</p>
<ol type="1">
<li><p><strong>Estimator for Treatment Effect (<span class="math inline">\(\tau_k\)</span>):</strong></p>
<p>The treatment effects are estimated as:</p></li>
</ol>
<p><span class="math display">\[
\hat{\tau}*k = \bar{Y}*{\cdot \cdot k} - \bar{Y}_{\cdot \cdot \cdot},
\]</span></p>
<p>where <span class="math inline">\(\bar{Y}*{\cdot \cdot k}\)</span> is the mean response for treatment <span class="math inline">\(k\)</span> and <span class="math inline">\(\bar{Y}^*{\cdot \cdot \cdot}\)</span> is the grand mean.</p>
<ol type="1">
<li><p><strong>Variance of <span class="math inline">\(\hat{\tau}_k\)</span>:</strong></p>
<p>Since each treatment is replicated <span class="math inline">\(v\)</span> times (once per row and column):</p></li>
</ol>
<p><span class="math display">\[
Var(\hat{\tau}_k) = \frac{\sigma^2}{v}
\]</span></p>
<p><strong>Conclusion:</strong> The variance of the treatment effect estimates decreases with increasing number of treatments in the Latin Square, enhancing the precision of the estimates.</p>
<p><strong>Reference:</strong> Montgomery, D. C., &amp; Runger, G. C. (2020). <em>Applied Statistics and Probability for Engineers</em>. Wiley.</p>
</section>
</section>
<section id="degrees-of-freedom-in-youden-designs-1" class="level2">
<h2 class="anchored" data-anchor-id="degrees-of-freedom-in-youden-designs-1">Degrees of Freedom in Youden Designs</h2>
<p>For a <strong>Youden Design</strong> with parameters <span class="math inline">\(v = 4\)</span> treatments, <span class="math inline">\(b = 4\)</span> blocks (rows), and <span class="math inline">\(c = 3\)</span> columns, the degrees of freedom for the error term are calculated as follows:</p>
<section id="formula-3" class="level3">
<h3 class="anchored" data-anchor-id="formula-3">Formula</h3>
<p><span class="math display">\[
df_{\text{Error}} = bc - b - c - v + 2
\]</span></p>
</section>
<section id="calculation-1" class="level3">
<h3 class="anchored" data-anchor-id="calculation-1">Calculation</h3>
<p>Given:</p>
<ul>
<li><span class="math inline">\(v = 4\)</span></li>
<li><span class="math inline">\(b = 4\)</span></li>
<li><span class="math inline">\(c = 3\)</span></li>
</ul>
<p>Plugging into the formula:</p>
<p><span class="math display">\[
df_{\text{Error}} = (4 \times 3) - 4 - 3 - 4 + 2 = 12 - 4 - 3 - 4 + 2 = 3
\]</span></p>
<p><strong>Interpretation:</strong> The error degrees of freedom indicate the number of independent pieces of information available to estimate the error variance. In this case, with 3 error degrees of freedom, the design is sufficiently constrained to estimate treatment effects after accounting for row and column effects.</p>
<p><strong>Reference:</strong> Dean, Voss &amp; Draguljić (2017). <em>Design and Analysis of Experiments</em>. Springer.</p>
</section>
</section>
<section id="proof-of-interaction-contrasts-1" class="level2">
<h2 class="anchored" data-anchor-id="proof-of-interaction-contrasts-1">Proof of Interaction Contrasts</h2>
<section id="interaction-contrasts-measure-deviations-from-additivity-1" class="level3">
<h3 class="anchored" data-anchor-id="interaction-contrasts-measure-deviations-from-additivity-1">Interaction Contrasts Measure Deviations from Additivity</h3>
<p><strong>Definition:</strong> In a three-factor design, interaction contrasts quantify how the combined effect of three factors deviates from the additive effects of each factor individually and their two-way interactions.</p>
</section>
<section id="proof-steps-1" class="level3">
<h3 class="anchored" data-anchor-id="proof-steps-1">Proof Steps</h3>
<ol type="1">
<li><strong>Define the Three-Factor Model:</strong></li>
</ol>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_k + (\alpha\beta)^*_{ij}+ (\alpha\gamma)^*_{ik}+ (\beta\gamma)^*_{jk}+ (\alpha\beta\gamma)^*_{ijk}+ \epsilon_{ijk}
\]</span></p>
<p>where <span class="math inline">\(\sum \alpha_i = \sum \beta_j = \sum \gamma_k = 0\)</span>.</p>
<ol type="1">
<li><p><strong>Construct Interaction Contrasts:</strong></p>
<ul>
<li><strong>Two-Way Interactions:</strong>
<ul>
<li><span class="math inline">\((\alpha\beta)_{ij}\)</span> measures the interaction between Factors A and B.</li>
<li>Similarly for <span class="math inline">\((\alpha\gamma)*{ik}\)</span> and <span class="math inline">\((\beta\gamma)*{jk}\)</span>.</li>
</ul></li>
<li><strong>Three-Way Interaction:</strong>
<ul>
<li><span class="math inline">\((\alpha\beta\gamma)_{ijk}\)</span> measures the deviation from additivity among all three factors.</li>
</ul></li>
</ul></li>
<li><p><strong>Prove Deviations from Additivity:</strong></p>
<ul>
<li><strong>Additive Model:</strong> If all interaction terms are zero (<span class="math inline">\((\alpha\beta)^*_{ij}= (\alpha\gamma)^*_{ik}= (\beta\gamma)^*_{jk}= (\alpha\beta\gamma)^*_{ijk}= 0\)</span>), the model simplifies to:</li>
</ul></li>
</ol>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_k + \epsilon_{ijk}
\]</span></p>
<pre><code> This represents a purely additive model where the combined effect of factors is the sum of their individual effects.</code></pre>
<ul>
<li><strong>Non-Additive Model:</strong> If any of the interaction terms are non-zero, the model deviates from additivity, indicating that the effect of one factor depends on the levels of other factors.</li>
</ul>
<ol type="1">
<li><p><strong>Conclusion:</strong></p>
<p>Interaction contrasts (<span class="math inline">\((\alpha\beta)^*{ij}\)</span>, <span class="math inline">\((\alpha\gamma)^*{ik}\)</span>, <span class="math inline">\((\beta\gamma)^*{jk}\)</span>, and <span class="math inline">\((\alpha\beta\gamma)^*{ijk}\)</span>) measure the extent to which the observed responses deviate from an additive model. Non-zero contrasts signify the presence of interactions, emphasizing the importance of considering these higher-order effects in experimental analysis.</p></li>
</ol>
<p><strong>Reference:</strong> Dean, Voss &amp; Draguljić (2017). <em>Design and Analysis of Experiments</em>. Springer.</p>
</section>
</section>
</section>
<section id="appendix-advanced-mathematical-derivations-2" class="level1">
<h1>Appendix: Advanced Mathematical Derivations</h1>
<section id="variance-calculations-for-latin-square-designs-2" class="level2">
<h2 class="anchored" data-anchor-id="variance-calculations-for-latin-square-designs-2">Variance Calculations for Latin Square Designs</h2>
<p>In a <strong>Latin Square Design</strong> with <span class="math inline">\(v\)</span> treatments, the variance of the estimated treatment effects is influenced by the design’s structure.</p>
<section id="formula-4" class="level3">
<h3 class="anchored" data-anchor-id="formula-4">Formula</h3>
<p>For a Latin Square with <span class="math inline">\(v\)</span> treatments:</p>
<p><span class="math display">\[
Var(\tau_i) = \frac{\sigma^2}{v}
\]</span></p>
</section>
<section id="derivation-2" class="level3">
<h3 class="anchored" data-anchor-id="derivation-2">Derivation</h3>
<ol type="1">
<li><p><strong>Model Setup:</strong></p>
<p>The ANOVA model for a Latin Square is:</p></li>
</ol>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \tau_k + \epsilon_{ijk},
\]</span></p>
<p>where <span class="math inline">\(\epsilon_{ijk} \sim N(0, \sigma^2)\)</span>.</p>
<ol type="1">
<li><p><strong>Estimator for Treatment Effect (<span class="math inline">\(\tau_k\)</span>):</strong></p>
<p>The treatment effects are estimated as:</p></li>
</ol>
<p><span class="math display">\[
\hat{\tau}*k = \bar{Y}*{\cdot \cdot k} - \bar{Y}_{\cdot \cdot \cdot},
\]</span></p>
<p>where <span class="math inline">\(\bar{Y}*{\cdot \cdot k}\)</span> is the mean response for treatment <span class="math inline">\(k\)</span> and <span class="math inline">\(\bar{Y}*{\cdot \cdot \cdot}\)</span> is the grand mean.</p>
<ol type="1">
<li><strong>Variance of <span class="math inline">\(\hat{\tau}_k\)</span>:</strong></li>
</ol>
<p>Since each treatment is replicated <span class="math inline">\(v\)</span> times (once per row and column):</p>
<p><span class="math display">\[
Var(\hat{\tau}_k) = \frac{\sigma^2}{v}
\]</span></p>
<p><strong>Conclusion:</strong> The variance of the treatment effect estimates decreases with increasing number of treatments in the Latin Square, enhancing the precision of the estimates.</p>
<p><strong>Reference:</strong> Montgomery, D. C., &amp; Runger, G. C. (2020). <em>Applied Statistics and Probability for Engineers</em>. Wiley.</p>
</section>
</section>
<section id="degrees-of-freedom-in-youden-designs-2" class="level2">
<h2 class="anchored" data-anchor-id="degrees-of-freedom-in-youden-designs-2">Degrees of Freedom in Youden Designs</h2>
<p>For a <strong>Youden Design</strong> with parameters <span class="math inline">\(v = 4\)</span> treatments, <span class="math inline">\(b = 4\)</span> blocks (rows), and <span class="math inline">\(c = 3\)</span> columns, the degrees of freedom for the error term are calculated as follows:</p>
<section id="formula-5" class="level3">
<h3 class="anchored" data-anchor-id="formula-5">Formula</h3>
<p><span class="math display">\[
df_{\text{Error}} = bc - b - c - v + 2
\]</span></p>
</section>
<section id="calculation-2" class="level3">
<h3 class="anchored" data-anchor-id="calculation-2">Calculation</h3>
<p>Given:</p>
<ul>
<li><span class="math inline">\(v = 4\)</span></li>
<li><span class="math inline">\(b = 4\)</span></li>
<li><span class="math inline">\(c = 3\)</span></li>
</ul>
<p>Plugging into the formula:</p>
<p><span class="math display">\[
df_{\text{Error}} = (4 \times 3) - 4 - 3 - 4 + 2 = 12 - 4 - 3 - 4 + 2 = 3
\]</span></p>
<p><strong>Interpretation:</strong> The error degrees of freedom indicate the number of independent pieces of information available to estimate the error variance. In this case, with 3 error degrees of freedom, the design is sufficiently constrained to estimate treatment effects after accounting for row and column effects.</p>
<p><strong>Reference:</strong> Dean, Voss &amp; Draguljić (2017). <em>Design and Analysis of Experiments</em>. Springer.</p>
</section>
</section>
<section id="proof-of-interaction-contrasts-2" class="level2">
<h2 class="anchored" data-anchor-id="proof-of-interaction-contrasts-2">Proof of Interaction Contrasts</h2>
<section id="interaction-contrasts-measure-deviations-from-additivity-2" class="level3">
<h3 class="anchored" data-anchor-id="interaction-contrasts-measure-deviations-from-additivity-2">Interaction Contrasts Measure Deviations from Additivity</h3>
<p><strong>Definition:</strong> In a three-factor design, interaction contrasts quantify how the combined effect of three factors deviates from the additive effects of each factor individually and their two-way interactions.</p>
</section>
<section id="proof-steps-2" class="level3">
<h3 class="anchored" data-anchor-id="proof-steps-2">Proof Steps</h3>
<ol type="1">
<li><strong>Define the Three-Factor Model:</strong></li>
</ol>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_k + (\alpha\beta)^*_{ij}+ (\alpha\gamma)^*_{ik}+ (\beta\gamma)^*_{jk}+ (\alpha\beta\gamma)^*_{ijk}+ \epsilon_{ijk}
\]</span></p>
<p>where <span class="math inline">\(\sum \alpha_i = \sum \beta_j = \sum \gamma_k = 0\)</span>.</p>
<ol type="1">
<li><p><strong>Construct Interaction Contrasts:</strong></p>
<ul>
<li><strong>Two-Way Interactions:</strong>
<ul>
<li><span class="math inline">\((\alpha\beta)_{ij}\)</span> measures the interaction between Factors A and B.</li>
<li>Similarly for <span class="math inline">\((\alpha\gamma)*{ik}\)</span> and <span class="math inline">\((\beta\gamma)*{jk}\)</span>.</li>
</ul></li>
<li><strong>Three-Way Interaction:</strong>
<ul>
<li><span class="math inline">\((\alpha\beta\gamma)_{ijk}\)</span> measures the deviation from additivity among all three factors.</li>
</ul></li>
</ul></li>
<li><p><strong>Prove Deviations from Additivity:</strong></p>
<ul>
<li><strong>Additive Model:</strong> If all interaction terms are zero (<span class="math inline">\((\alpha\beta)*_{ij}= (\alpha\gamma)^*_{ik}= (\beta\gamma)^*_{jk}= (\alpha\beta\gamma)^*_{ijk}= 0\)</span>), the model simplifies to:</li>
</ul></li>
</ol>
<p><span class="math display">\[
Y_{ijk} = \mu + \alpha_i + \beta_j + \gamma_k + \epsilon_{ijk}
\]</span></p>
<pre><code> This represents a purely additive model where the combined effect of factors is the sum of their individual effects.</code></pre>
<ul>
<li><strong>Non-Additive Model:</strong> If any of the interaction terms are non-zero, the model deviates from additivity, indicating that the effect of one factor depends on the levels of other factors.</li>
</ul>
<ol type="1">
<li><p><strong>Conclusion:</strong></p>
<p>Interaction contrasts (<span class="math inline">\((\alpha\beta)^*{ij}\)</span>, <span class="math inline">\((\alpha\gamma)^*{ik}\)</span>, <span class="math inline">\((\beta\gamma)^*{jk}\)</span>, and <span class="math inline">\((\alpha\beta\gamma)^*{ijk}\)</span>) measure the extent to which the observed responses deviate from an additive model. Non-zero contrasts signify the presence of interactions, emphasizing the importance of considering these higher-order effects in experimental analysis.</p></li>
</ol>
<p><strong>Reference:</strong> Dean, Voss &amp; Draguljić (2017). <em>Design and Analysis of Experiments</em>. Springer.</p>
</section>
</section>
</section>
<section id="appendix-advanced-mathematical-derivations-3" class="level1">
<h1>Appendix: Advanced Mathematical Derivations</h1>
<section id="adjusted-treatment-means" class="level2">
<h2 class="anchored" data-anchor-id="adjusted-treatment-means">Adjusted Treatment Means</h2>
<p>The <strong>adjusted mean</strong> for treatment <span class="math inline">\(i\)</span> accounts for the influence of blocking factors, providing a more accurate estimate of the treatment effect.</p>
<p><span class="math display">\[
\mu + \tau_i = \bar{Y}_i - \beta (\bar{X}_i - \bar{X})
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\mu\)</span>: Overall mean.</li>
<li><span class="math inline">\(\tau_i\)</span>: Treatment effect for treatment <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\bar{Y}_i\)</span>: Mean response for treatment <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\beta\)</span>: Regression coefficient for the covariate.</li>
<li><span class="math inline">\(\bar{X}_i\)</span>: Mean covariate value for treatment <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\bar{X}\)</span>: Overall mean of the covariate.</li>
</ul>
<section id="derivation-3" class="level3">
<h3 class="anchored" data-anchor-id="derivation-3">Derivation</h3>
<ol type="1">
<li><strong>Model Equation:</strong></li>
</ol>
<p><span class="math display">\[
Y_{ij} = \mu + \tau_i + \beta (X_{ij} - \bar{X}) + \epsilon_{ij}
\]</span></p>
<ol type="1">
<li><strong>Taking the Mean for Treatment <span class="math inline">\(i\)</span>:</strong></li>
</ol>
<p><span class="math display">\[
\bar{Y}_i = \mu + \tau_i + \beta (\bar{X}_i - \bar{X}) + \bar{\epsilon}_i
\]</span></p>
<p>Since <span class="math inline">\(\bar{\epsilon}_i = 0\)</span> (assuming errors have mean zero),</p>
<p><span class="math display">\[
\bar{Y}_i = \mu + \tau_i + \beta (\bar{X}_i - \bar{X})
\]</span></p>
<ol type="1">
<li><strong>Solving for Adjusted Mean:</strong></li>
</ol>
<p><span class="math display">\[
\mu + \tau_i = \bar{Y}_i - \beta (\bar{X}_i - \bar{X})
\]</span></p>
<p>This equation represents the adjusted treatment mean, accounting for differences in the covariate.</p>
<p><strong>Reference:</strong> Montgomery, D. C., &amp; Runger, G. C. (2020). <em>Applied Statistics and Probability for Engineers</em>. Wiley.</p>
</section>
</section>
<section id="f-test-for-homogeneity-of-slopes" class="level2">
<h2 class="anchored" data-anchor-id="f-test-for-homogeneity-of-slopes">F-Test for Homogeneity of Slopes</h2>
<p>Testing the assumption of <strong>homogeneity of regression slopes</strong> ensures that the relationship between the covariate and the response is consistent across all treatment groups.</p>
<section id="model-comparison" class="level3">
<h3 class="anchored" data-anchor-id="model-comparison">Model Comparison</h3>
<ol type="1">
<li><strong>Model Without Interaction (Assuming Homogeneous Slopes):</strong></li>
</ol>
<p><span class="math display">\[
Y_{hi} = \mu + \theta_h + \tau_i + \beta X_{hi} + \epsilon_{hi}
\]</span></p>
<ol type="1">
<li><strong>Model With Interaction (Allowing Slopes to Vary):</strong></li>
</ol>
<p><span class="math display">\[
Y_{hi} = \mu + \theta_h + \tau_i + \beta X_{hi} + (\theta \tau)^*_{hi} + \epsilon^*_{hi}
\]</span></p>
<p>Where <span class="math inline">\((\theta \tau)_{hi}\)</span> allows the slope of the covariate to vary with treatments.</p>
</section>
<section id="hypothesis-testing-1" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-testing-1">Hypothesis Testing</h3>
<ul>
<li><strong>Null Hypothesis (<span class="math inline">\(H_0\)</span>):</strong> Homogeneity of slopes (<span class="math inline">\(\beta\)</span> is the same across treatments).</li>
<li><strong>Alternative Hypothesis (<span class="math inline">\(H_A\)</span>):</strong> Slopes vary across treatments (<span class="math inline">\(\beta_i \neq \beta_j\)</span> for some <span class="math inline">\(i, j\)</span>).</li>
</ul>
</section>
<section id="test-procedure" class="level3">
<h3 class="anchored" data-anchor-id="test-procedure">Test Procedure</h3>
<ol type="1">
<li><strong>Fit Both Models:</strong>
<ul>
<li><strong>Reduced Model:</strong> Without interaction.</li>
<li><strong>Full Model:</strong> With interaction.</li>
</ul></li>
<li><strong>Compare Models Using ANOVA:</strong></li>
</ol>
<div class="sourceCode" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Reduced Model</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>model_reduced <span class="ot">&lt;-</span> <span class="fu">lm</span>(Time <span class="sc">~</span> fColor <span class="sc">+</span> x, <span class="at">data =</span> balloon.data)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Full Model with Interaction</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>model_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(Time <span class="sc">~</span> fColor <span class="sc">*</span> x, <span class="at">data =</span> balloon.data)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare Models</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_reduced, model_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="3" type="1">
<li><strong>Decision Rule:</strong>
<ul>
<li>If the interaction term is significant (<span class="math inline">\(p &lt; \alpha\)</span>), reject <span class="math inline">\(H_0\)</span> and conclude that slopes are not homogeneous.</li>
<li>If not significant, accept <span class="math inline">\(H_0\)</span> and proceed with the reduced model.</li>
</ul></li>
</ol>
<p><strong>Conclusion:</strong><br>
A significant interaction term indicates that the effect of the covariate varies across treatments, violating the homogeneity of slopes assumption and necessitating a more complex model.</p>
<p><strong>Reference:</strong><br>
Scheffé, H. (1959). <em>The Analysis of Variance</em>. Wiley.</p>
</section>
</section>
<section id="confidence-intervals-for-higher-order-contrasts" class="level2">
<h2 class="anchored" data-anchor-id="confidence-intervals-for-higher-order-contrasts">Confidence Intervals for Higher-Order Contrasts</h2>
<p>For higher-order interactions involving multiple factors, <strong>confidence intervals for contrasts</strong> provide insights into the magnitude and significance of these interactions.</p>
<section id="formula-6" class="level3">
<h3 class="anchored" data-anchor-id="formula-6">Formula</h3>
<p><span class="math display">\[\text{CI} = \hat{L} \pm t_{\alpha/2, df} \sqrt{\text{Var}(\hat{L})}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\hat{L}\)</span>: Estimated contrast.</li>
<li><span class="math inline">\(t_{\alpha/2, df}\)</span>: Critical value from the t-distribution.</li>
<li><span class="math inline">\(\text{Var}(\hat{L})\)</span>: Variance of the contrast estimate.</li>
</ul>
</section>
<section id="steps-in-r" class="level3">
<h3 class="anchored" data-anchor-id="steps-in-r">Steps in R</h3>
<ol type="1">
<li><p><strong>Estimate the Contrast:</strong></p>
<p>Using the <code>emmeans</code> package to define and estimate contrasts.</p></li>
<li><p><strong>Calculate the Confidence Interval:</strong></p>
<p>The <code>emmeans</code> package automatically provides confidence intervals when performing contrasts.</p></li>
</ol>
<p><strong>Example:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the ANCOVA Model</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> Treatment <span class="sc">+</span> X, <span class="at">data =</span> data_sim)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Estimated Marginal means</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span> Treatment)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a Contrast (e.g., Treatment B vs. Treatment A)</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>contrast_AB <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm, <span class="at">method =</span> <span class="st">"pairwise"</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(contrast_AB, <span class="at">infer =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["lower.CL"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["upper.CL"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"A - B","2":"-1.722254","3":"0.7869124","4":"86","5":"-3.599009","6":"0.1545011","7":"-2.188622","8":"7.885527e-02","_rn_":"1"},{"1":"A - C","2":"-4.740066","3":"0.7830950","4":"86","5":"-6.607716","6":"-2.8724149","7":"-6.052989","8":"1.081426e-07","_rn_":"2"},{"1":"B - C","2":"-3.017812","3":"0.7846485","4":"86","5":"-4.889167","6":"-1.1464556","7":"-3.846068","8":"6.666253e-04","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> The output provides the estimated difference, standard error, t-value, and confidence interval for the contrast. If the confidence interval does not include zero, the contrast is statistically significant.</p>
<p><strong>Reference:</strong> Christensen, R. (2018). <em>Analysis of Variance, Design, and Regression</em>. Chapman and Hall/CRC.</p>
</section>
</section>
</section>
<section id="exercises-2" class="level1">
<h1>Exercises</h1>
<section id="medium-difficulty-2" class="level2">
<h2 class="anchored" data-anchor-id="medium-difficulty-2">Medium Difficulty</h2>
<section id="two-way-ancova-with-interaction-2" class="level3">
<h3 class="anchored" data-anchor-id="two-way-ancova-with-interaction-2">1. Two-Way ANCOVA with Interaction</h3>
<p><strong>Dataset:</strong> Simulate a dataset with three treatments and one covariate.</p>
<p><strong>Tasks:</strong></p>
<ul>
<li>Generate data for treatments A, B, C with a covariate <span class="math inline">\(X\)</span>.</li>
<li>Fit an ANCOVA model adjusting for <span class="math inline">\(X\)</span>.</li>
<li>Test the significance of treatment effects and the covariate.</li>
<li>Generate diagnostic plots and interpret them.</li>
</ul>
<p><strong>R Code Example:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Factors and Covariate</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>Treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">each=</span><span class="dv">30</span>))</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">90</span>, <span class="at">mean=</span><span class="dv">50</span>, <span class="at">sd=</span><span class="dv">10</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate Responses with Treatment Effects and Covariate Effect</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fu">ifelse</span>(Treatment <span class="sc">==</span> <span class="st">"A"</span>, <span class="dv">0</span>, <span class="fu">ifelse</span>(Treatment <span class="sc">==</span> <span class="st">"B"</span>, <span class="dv">2</span>, <span class="dv">4</span>)) <span class="sc">+</span>  <span class="fl">0.5</span> <span class="sc">*</span> (X <span class="sc">-</span> <span class="fu">mean</span>(X)) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">90</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">3</span>)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>data_sim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Treatment, X, Y)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANCOVA Model</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>model_sim <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> Treatment <span class="sc">+</span> X, <span class="at">data =</span> data_sim)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Y ~ Treatment + X, data = data_sim)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.6486 -1.8937 -0.3341  1.7617  9.2902 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -20.73160    1.87693 -11.045  &lt; 2e-16 ***
TreatmentB    1.72225    0.78691   2.189   0.0313 *  
TreatmentC    4.74007    0.78309   6.053 3.61e-08 ***
X             0.50385    0.03621  13.914  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.031 on 86 degrees of freedom
Multiple R-squared:  0.7332,    Adjusted R-squared:  0.7238 
F-statistic: 78.76 on 3 and 86 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostic Plots</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="week-11_row-column_files/figure-html/unnamed-chunk-14-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="week-11_row-column_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated Marginal means</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>emm_sim <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_sim, <span class="sc">~</span> Treatment)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>pairwise_sim <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm_sim, <span class="at">method =</span> <span class="st">"pairwise"</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pairwise_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"A - B","2":"-1.722254","3":"0.7869124","4":"86","5":"-2.188622","6":"7.885527e-02","_rn_":"1"},{"1":"A - C","2":"-4.740066","3":"0.7830950","4":"86","5":"-6.052989","6":"1.081426e-07","_rn_":"2"},{"1":"B - C","2":"-3.017812","3":"0.7846485","4":"86","5":"-3.846068","6":"6.666253e-04","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><strong>Questions:</strong></p>
<ol type="1">
<li><strong>Main Effects:</strong>
<ul>
<li><strong>Treatment:</strong> What are the estimated effects of treatments A, B, and C?</li>
<li><strong>Covariate <span class="math inline">\(X\)</span>:</strong> How does <span class="math inline">\(X\)</span> influence the response variable <span class="math inline">\(Y\)</span>?</li>
</ul></li>
<li><strong>Significance Testing:</strong>
<ul>
<li>Are the treatment effects statistically significant after adjusting for <span class="math inline">\(X\)</span>?</li>
<li>Is the covariate <span class="math inline">\(X\)</span> a significant predictor of <span class="math inline">\(Y\)</span>?</li>
</ul></li>
<li><strong>Diagnostic Plots:</strong>
<ul>
<li>Do the residual plots indicate any violations of ANCOVA assumptions such as non-linearity, heteroscedasticity, or non-normality?</li>
<li>Are there any influential observations that may affect the model’s validity?</li>
</ul></li>
<li><strong>Interpretation of Pairwise Comparisons:</strong>
<ul>
<li>Which treatments significantly differ from each other after adjusting for <span class="math inline">\(X\)</span>?</li>
<li>How do the adjusted means compare across treatments?</li>
</ul></li>
</ol>
<p><strong>Expected Answers:</strong></p>
<ol type="1">
<li><strong>Main Effects:</strong>
<ul>
<li>Treatments B and C have positive effects relative to Treatment A.</li>
<li>Covariate <span class="math inline">\(X\)</span> has a positive influence on <span class="math inline">\(Y\)</span>, indicating that as <span class="math inline">\(X\)</span> increases, <span class="math inline">\(Y\)</span> tends to increase.</li>
</ul></li>
<li><strong>Significance Testing:</strong>
<ul>
<li>If the p-values for Treatment are below the significance level (e.g., 0.05), treatments have significant effects.</li>
<li>If the p-value for <span class="math inline">\(X\)</span> is below the significance level, <span class="math inline">\(X\)</span> is a significant predictor.</li>
</ul></li>
<li><strong>Diagnostic Plots:</strong>
<ul>
<li>Random scatter in Residuals vs Fitted suggests homoscedasticity and linearity.</li>
<li>Q-Q plot close to the diagonal indicates normality of residuals.</li>
<li>No points with high leverage or large residuals indicate no influential observations.</li>
</ul></li>
<li><strong>Interpretation of Pairwise Comparisons:</strong>
<ul>
<li>Significant pairwise differences indicate which specific treatments differ after adjusting for <span class="math inline">\(X\)</span>.</li>
<li>Adjusted means provide a clearer comparison by accounting for the covariate’s effect.</li>
</ul></li>
</ol>
</section>
<section id="balloon-data-analysis-2" class="level3">
<h3 class="anchored" data-anchor-id="balloon-data-analysis-2">2. Balloon Data Analysis</h3>
<p><strong>Scenario:</strong> Reanalyze the balloon data, testing for equality of slopes.</p>
<p><strong>Tasks:</strong></p>
<ul>
<li>Fit an ANCOVA model.</li>
<li>Test the homogeneity of regression slopes.</li>
<li>Interpret the adjusted treatment means.</li>
</ul>
<p><strong>R Code Example:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANCOVA Model</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Time <span class="sc">~</span> fColor <span class="sc">+</span> x, <span class="at">data =</span> balloon.data)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Time ~ fColor + x, data = balloon.data)

Residuals:
   Min     1Q Median     3Q    Max 
-3.985 -1.736 -0.211  1.493  5.249 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 18.28474    0.91736  19.932  &lt; 2e-16 ***
fColor2      4.10560    1.29760   3.164 0.003829 ** 
fColor3      3.80129    1.29872   2.927 0.006867 ** 
fColor4     -0.07086    1.29736  -0.055 0.956843    
x           -0.21103    0.04981  -4.237 0.000236 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.594 on 27 degrees of freedom
Multiple R-squared:  0.5776,    Adjusted R-squared:  0.515 
F-statistic: 9.229 on 4 and 27 DF,  p-value: 7.797e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Homogeneity of Slopes</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>model_interaction <span class="ot">&lt;-</span> <span class="fu">lm</span>(Time <span class="sc">~</span> fColor <span class="sc">*</span> x, <span class="at">data =</span> balloon.data)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model, model_interaction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"27","2":"181.7422","3":"NA","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"24","2":"157.0320","3":"3","4":"24.71016","5":"1.258859","6":"0.3107502","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated Marginal means</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>emm_balloon <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span> fColor)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>pairwise_balloon <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm_balloon, <span class="at">method =</span> <span class="st">"pairwise"</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pairwise_balloon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"fColor1 - fColor2","2":"-4.10560387","3":"1.297600","4":"27","5":"-3.16399688","6":"0.01886063","_rn_":"1"},{"1":"fColor1 - fColor3","2":"-3.80129227","3":"1.298720","4":"27","5":"-2.92695236","6":"0.03270334","_rn_":"2"},{"1":"fColor1 - fColor4","2":"0.07086232","3":"1.297361","4":"27","5":"0.05462034","6":"0.99993994","_rn_":"3"},{"1":"fColor2 - fColor3","2":"0.30431160","3":"1.300584","4":"27","5":"0.23398067","6":"0.99537890","_rn_":"4"},{"1":"fColor2 - fColor4","2":"4.17646618","3":"1.298183","4":"27","5":"3.21716321","6":"0.01662144","_rn_":"5"},{"1":"fColor3 - fColor4","2":"3.87215459","3":"1.297959","4":"27","5":"2.98326439","6":"0.02875414","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><strong>Questions:</strong></p>
<ol type="1">
<li><strong>Interaction Term:</strong>
<ul>
<li>What does the interaction term between <code>fColor</code> and <code>x</code> indicate?</li>
<li>Is the interaction term statistically significant?</li>
</ul></li>
<li><strong>Model Interpretation:</strong>
<ul>
<li>If the interaction is not significant, what does this imply about the slopes?</li>
<li>How do the adjusted treatment means differ from the raw means?</li>
</ul></li>
<li><strong>Pairwise Comparisons:</strong>
<ul>
<li>Which balloon colors have significantly different inflation times after adjusting for run order?</li>
<li>How can these differences inform practical decisions in balloon manufacturing?</li>
</ul></li>
<li><strong>Assumption Testing:</strong>
<ul>
<li>Do the diagnostic plots suggest any violations of ANCOVA assumptions?</li>
<li>Should any transformations or alternative models be considered based on these diagnostics?</li>
</ul></li>
</ol>
<p><strong>Expected Answers:</strong></p>
<ol type="1">
<li><strong>Interaction Term:</strong>
<ul>
<li>The interaction term assesses whether the relationship between <code>x</code> (RunOrder) and <code>Time</code> differs across <code>fColor</code> (Color).</li>
<li>A non-significant interaction suggests that slopes are homogeneous across treatments.</li>
</ul></li>
<li><strong>Model Interpretation:</strong>
<ul>
<li>Homogeneous slopes imply that the covariate affects all treatments equally.</li>
<li>Adjusted treatment means account for differences in <code>x</code>, providing a fair comparison of treatment effects.</li>
</ul></li>
<li><strong>Pairwise Comparisons:</strong>
<ul>
<li>Significant differences indicate specific color treatments that lead to different inflation times.</li>
<li>Manufacturers can focus on optimizing colors that perform better in terms of inflation speed.</li>
</ul></li>
<li><strong>Assumption Testing:</strong>
<ul>
<li>Random scatter in Residuals vs Fitted and Q-Q plots close to the diagonal indicate that assumptions are met.</li>
<li>If violations are present, consider data transformations or robust statistical methods.</li>
</ul></li>
</ol>


</section>
</section>
</section>

</main> <!-- /main -->
<!-- filepath: /Users/dt/Library/CloudStorage/Dropbox/Teaching/DOE/assets/includes/footer.html -->
<footer class="site-footer">
    <div class="container text-center">
        <hr> 
        © <span id="current-year"></span> Dr. Davood Tofighi |
        <a href="https://canvasinfo.unm.edu/">UNM Canvas</a> |
        <a href="https://data-wise.github.io/doe">Course GitHub Page</a> |
    </div>
    <script>
        document.getElementById("current-year").textContent = new Date().getFullYear();
    </script>
</footer>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/Data-Wise\.github\.io\/doe\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>