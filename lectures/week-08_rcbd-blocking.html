<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Davood Tofighi, Ph.D.">

<title>Randomized Complete Block Design (RCBD) with Blocking – STAT 454/545 - Analysis of Variance and Experimental Design</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../assets/images/favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-1092c56c6cadf2eb47b1bc8063ab382a.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-8ab0b559639a8ef97837eceaa424423f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&amp;family=Montserrat:wght@400;700&amp;family=Fira+Code:wght@400;700&amp;display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../assets/styles/css/home.css">
<meta property="og:title" content="Randomized Complete Block Design (RCBD) with Blocking – STAT 454/545 - Analysis of Variance and Experimental Design">
<meta property="og:description" content="Analysis of Variance and Experimental Design">
<meta property="og:image" content="https://Data-Wise.github.io/doe/lectures/week-08_rcbd-blocking_files/figure-html/fig-rcbd-diagnostic-plots-1.png">
<meta property="og:site_name" content="STAT 454/545 - Analysis of Variance and Experimental Design">
<meta property="og:image:height" content="960">
<meta property="og:image:width" content="1344">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">STAT 454/545 - Analysis of Variance and Experimental Design</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus/syllabus-final.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_lectures.html"> 
<span class="menu-text">Lecture Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus/schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_assignments.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../contents.html"> 
<span class="menu-text">Contents</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_appendix.html"> 
<span class="menu-text">Appendix</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Randomized Complete Block Design (RCBD) with Blocking</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Davood Tofighi, Ph.D. </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">30-Dec-2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="-1">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  </ul></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">Objectives</a></li>
  <li><a href="#r-packages" id="toc-r-packages" class="nav-link" data-scroll-target="#r-packages">R Packages</a></li>
  <li><a href="#complete-block-designs-theory-and-structure" id="toc-complete-block-designs-theory-and-structure" class="nav-link" data-scroll-target="#complete-block-designs-theory-and-structure">Complete Block Designs: Theory and Structure</a>
  <ul class="collapse">
  <li><a href="#what-are-complete-block-designs" id="toc-what-are-complete-block-designs" class="nav-link" data-scroll-target="#what-are-complete-block-designs">What Are Complete Block Designs?</a>
  <ul class="collapse">
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a></li>
  </ul></li>
  <li><a href="#randomized-complete-block-designs-rcbds" id="toc-randomized-complete-block-designs-rcbds" class="nav-link" data-scroll-target="#randomized-complete-block-designs-rcbds">Randomized Complete Block Designs (RCBDs)</a></li>
  <li><a href="#general-complete-block-designs" id="toc-general-complete-block-designs" class="nav-link" data-scroll-target="#general-complete-block-designs">General Complete Block Designs</a></li>
  </ul></li>
  <li><a href="#analysis-of-rcbds" id="toc-analysis-of-rcbds" class="nav-link" data-scroll-target="#analysis-of-rcbds">Analysis of RCBDs</a>
  <ul class="collapse">
  <li><a href="#model-and-assumptions" id="toc-model-and-assumptions" class="nav-link" data-scroll-target="#model-and-assumptions">Model and Assumptions</a></li>
  <li><a href="#key-assumptions" id="toc-key-assumptions" class="nav-link" data-scroll-target="#key-assumptions">Key Assumptions</a></li>
  <li><a href="#anova-for-rcbds" id="toc-anova-for-rcbds" class="nav-link" data-scroll-target="#anova-for-rcbds">ANOVA for RCBDs</a>
  <ul class="collapse">
  <li><a href="#variance-decomposition" id="toc-variance-decomposition" class="nav-link" data-scroll-target="#variance-decomposition">Variance Decomposition</a></li>
  <li><a href="#anova-table" id="toc-anova-table" class="nav-link" data-scroll-target="#anova-table">ANOVA Table</a></li>
  <li><a href="#f-ratio-and-hypothesis-testing" id="toc-f-ratio-and-hypothesis-testing" class="nav-link" data-scroll-target="#f-ratio-and-hypothesis-testing">F-Ratio and Hypothesis Testing</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#implementation-in-r" id="toc-implementation-in-r" class="nav-link" data-scroll-target="#implementation-in-r">Implementation in R</a>
  <ul class="collapse">
  <li><a href="#example-bread-baking-experiment" id="toc-example-bread-baking-experiment" class="nav-link" data-scroll-target="#example-bread-baking-experiment">Example: Bread-Baking Experiment</a>
  <ul class="collapse">
  <li><a href="#scenario" id="toc-scenario" class="nav-link" data-scroll-target="#scenario">Scenario</a></li>
  <li><a href="#step-by-step-r-code" id="toc-step-by-step-r-code" class="nav-link" data-scroll-target="#step-by-step-r-code">Step-by-Step R Code</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#enhanced-lecture-on-randomized-complete-block-design-rcbd" id="toc-enhanced-lecture-on-randomized-complete-block-design-rcbd" class="nav-link" data-scroll-target="#enhanced-lecture-on-randomized-complete-block-design-rcbd">Enhanced Lecture on Randomized Complete Block Design (RCBD)</a>
  <ul class="collapse">
  <li><a href="#model-for-rcbd" id="toc-model-for-rcbd" class="nav-link" data-scroll-target="#model-for-rcbd">Model for RCBD</a></li>
  <li><a href="#analysis-of-variance-anova" id="toc-analysis-of-variance-anova" class="nav-link" data-scroll-target="#analysis-of-variance-anova">Analysis of Variance (ANOVA)</a></li>
  <li><a href="#comprehension-questions" id="toc-comprehension-questions" class="nav-link" data-scroll-target="#comprehension-questions">Comprehension Questions</a>
  <ul class="collapse">
  <li><a href="#question-1-definitions-and-examples" id="toc-question-1-definitions-and-examples" class="nav-link" data-scroll-target="#question-1-definitions-and-examples">Question 1: Definitions and Examples</a></li>
  <li><a href="#question-2-rcbd-anova" id="toc-question-2-rcbd-anova" class="nav-link" data-scroll-target="#question-2-rcbd-anova">Question 2: RCBD ANOVA</a></li>
  <li><a href="#question-3-experimental-design" id="toc-question-3-experimental-design" class="nav-link" data-scroll-target="#question-3-experimental-design">Question 3: Experimental Design</a></li>
  <li><a href="#question-4-derivations" id="toc-question-4-derivations" class="nav-link" data-scroll-target="#question-4-derivations">Question 4: Derivations</a></li>
  </ul></li>
  <li><a href="#real-world-applications" id="toc-real-world-applications" class="nav-link" data-scroll-target="#real-world-applications">Real-World Applications</a></li>
  <li><a href="#numerical-example-1-testing-fertilizers" id="toc-numerical-example-1-testing-fertilizers" class="nav-link" data-scroll-target="#numerical-example-1-testing-fertilizers">Numerical Example 1: Testing Fertilizers</a>
  <ul class="collapse">
  <li><a href="#scenario-1" id="toc-scenario-1" class="nav-link" data-scroll-target="#scenario-1"><strong>Scenario</strong></a></li>
  <li><a href="#step-by-step-analysis" id="toc-step-by-step-analysis" class="nav-link" data-scroll-target="#step-by-step-analysis"><strong>Step-by-Step Analysis</strong></a></li>
  </ul></li>
  <li><a href="#real-world-example-2-testing-teaching-methods" id="toc-real-world-example-2-testing-teaching-methods" class="nav-link" data-scroll-target="#real-world-example-2-testing-teaching-methods">Real-World Example 2: Testing Teaching Methods</a>
  <ul class="collapse">
  <li><a href="#scenario-2" id="toc-scenario-2" class="nav-link" data-scroll-target="#scenario-2"><strong>Scenario</strong></a></li>
  <li><a href="#step-by-step-analysis-1" id="toc-step-by-step-analysis-1" class="nav-link" data-scroll-target="#step-by-step-analysis-1"><strong>Step-by-Step Analysis</strong></a></li>
  </ul></li>
  <li><a href="#key-insights" id="toc-key-insights" class="nav-link" data-scroll-target="#key-insights"><strong>6. Key Insights</strong></a></li>
  <li><a href="#contrasts-in-rcbd" id="toc-contrasts-in-rcbd" class="nav-link" data-scroll-target="#contrasts-in-rcbd"><strong>2. Contrasts in RCBD</strong></a>
  <ul class="collapse">
  <li><a href="#definition" id="toc-definition" class="nav-link" data-scroll-target="#definition"><strong>2.1 Definition</strong></a></li>
  <li><a href="#examples-of-contrasts" id="toc-examples-of-contrasts" class="nav-link" data-scroll-target="#examples-of-contrasts"><strong>2.2 Examples of Contrasts</strong></a></li>
  </ul></li>
  <li><a href="#numerical-example-with-contrasts" id="toc-numerical-example-with-contrasts" class="nav-link" data-scroll-target="#numerical-example-with-contrasts">Numerical Example with Contrasts</a>
  <ul class="collapse">
  <li><a href="#scenario-3" id="toc-scenario-3" class="nav-link" data-scroll-target="#scenario-3"><strong>3.1 Scenario</strong></a></li>
  <li><a href="#anova-analysis" id="toc-anova-analysis" class="nav-link" data-scroll-target="#anova-analysis">3.2 ANOVA Analysis</a></li>
  <li><a href="#step-by-step-contrast-computations" id="toc-step-by-step-contrast-computations" class="nav-link" data-scroll-target="#step-by-step-contrast-computations">3.3 Step-by-Step Contrast Computations</a></li>
  <li><a href="#r-code-to-analyze-contrasts" id="toc-r-code-to-analyze-contrasts" class="nav-link" data-scroll-target="#r-code-to-analyze-contrasts"><strong>3.4 R Code to Analyze Contrasts</strong></a></li>
  <li><a href="#explanation-of-r-output" id="toc-explanation-of-r-output" class="nav-link" data-scroll-target="#explanation-of-r-output"><strong>3.5 Explanation of R Output</strong></a></li>
  </ul></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">4. Interpretation</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">5. Summary</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In the realm of experimental design, <strong>Complete Block Designs (CBDs)</strong> play a pivotal role in controlling the effects of nuisance factors, thereby enhancing the precision of treatment comparisons. By organizing experimental units into blocks that share similar characteristics, CBDs effectively reduce variability stemming from these extraneous factors. This structured approach not only refines the efficiency of experiments but also ensures more accurate and reliable analyses.</p>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example">Example</h3>
<p>Imagine you are testing different fertilizers on crops spread across a large farm. The farm has sections with varying soil types, sunlight exposure, and moisture levels. Without controlling for these variations, it would be challenging to discern the true effect of each fertilizer. By grouping plots with similar soil types into blocks, you can more precisely compare the performance of fertilizers within each homogeneous group, minimizing the confounding influence of soil variability.</p>
<p>This lecture delves into the structure, applications, and analysis of Complete Block Designs, with a focus on <strong>Randomized Complete Block Designs (RCBDs)</strong> and their generalizations. We will explore theoretical underpinnings, practical implementations using R, and advanced topics to provide a comprehensive understanding tailored for graduate statistics students.</p>
</section>
</section>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives</h2>
<ol type="1">
<li><strong>Define and distinguish</strong> between complete and incomplete block designs.</li>
<li><strong>Explore</strong> the structure and application of Randomized Complete Block Designs (RCBDs).</li>
<li><strong>Perform</strong> Analysis of Variance (ANOVA) for RCBDs and assess the efficiency of blocking.</li>
<li><strong>Understand</strong> general complete block designs and their applications.</li>
<li><strong>Implement</strong> complete block designs in R and interpret the results.</li>
<li><strong>Reinforce</strong> concepts with exercises covering numerical examples, conceptual understanding, and mathematical proofs.</li>
<li><strong>Explore</strong> advanced mathematical derivations and proofs in the Appendix.</li>
</ol>
</section>
<section id="r-packages" class="level2">
<h2 class="anchored" data-anchor-id="r-packages">R Packages</h2>
<p>To facilitate the analysis of Randomized Complete Block Designs (RCBDs) and contrasts, we will utilize the following R packages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Required R Packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr, ggplot2, emmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><strong><code>emmeans</code></strong>: For estimating marginal means and conducting pairwise comparisons.</li>
<li><strong><code>ggplot2</code></strong>: For creating visualizations and diagnostic plots.</li>
<li><strong><code>dplyr</code></strong>: For data manipulation and summarization.</li>
</ul>
<p>Ensure that these packages are installed in your R environment to follow along with the examples and exercises.</p>
</section>
<section id="complete-block-designs-theory-and-structure" class="level1">
<h1>Complete Block Designs: Theory and Structure</h1>
<section id="what-are-complete-block-designs" class="level2">
<h2 class="anchored" data-anchor-id="what-are-complete-block-designs">What Are Complete Block Designs?</h2>
<p><strong>Complete Block Designs (CBDs)</strong> are experimental designs where each block contains all the treatments being tested. This ensures that every treatment is applied in each block, allowing for direct comparisons under similar conditions.</p>
<ul>
<li><strong>Block:</strong> A group of experimental units that are similar in some aspect and expected to yield comparable responses.</li>
<li><strong>Complete Block:</strong> Each block includes every treatment exactly once.</li>
</ul>
<section id="example-1" class="level3">
<h3 class="anchored" data-anchor-id="example-1">Example</h3>
<p>In a clinical trial comparing drug treatments across different hospitals, each hospital represents a block. By administering all treatments in each hospital, you account for hospital-specific factors, such as patient demographics and care protocols, ensuring that treatment effects are evaluated consistently.</p>
</section>
</section>
<section id="randomized-complete-block-designs-rcbds" class="level2">
<h2 class="anchored" data-anchor-id="randomized-complete-block-designs-rcbds">Randomized Complete Block Designs (RCBDs)</h2>
<p><strong>RCBDs</strong> are a specific type of CBD where treatments are randomly assigned within each block. This randomness ensures that the assignment of treatments is free from bias and that any differences observed are attributable to the treatments rather than systematic variations.</p>
<p><strong>Characteristics of RCBDs:</strong></p>
<ul>
<li>The number of experimental units in each block equals the number of treatments.</li>
<li>Each treatment appears exactly once per block.</li>
<li>Treatments are assigned randomly within each block.</li>
</ul>
<p><strong>Analogy:</strong> Think of RCBDs as seating arrangements in a classroom where each row (block) must contain one student from each house (treatments). By randomly assigning students to seats within rows, you ensure that no particular house has an advantage in any row.</p>
</section>
<section id="general-complete-block-designs" class="level2">
<h2 class="anchored" data-anchor-id="general-complete-block-designs">General Complete Block Designs</h2>
<p>Beyond RCBDs, <strong>General Complete Block Designs</strong> allow for multiple observations or replicates of treatments within each block. This is particularly useful when interaction effects between treatments and blocks are anticipated.</p>
<p><strong>Features:</strong></p>
<ul>
<li>A treatment is replicated <span class="math inline">\(s &gt; 1\)</span> times within a block.</li>
<li>Facilitates the detection of interactions between treatments and blocking factors.</li>
</ul>
<p><strong>Example:</strong> In a clinical trial, if a treatment needs to be administered multiple times within each hospital ward (block) to account for ward-specific factors, a general complete block design would be appropriate.</p>
</section>
</section>
<section id="analysis-of-rcbds" class="level1 page-columns page-full">
<h1>Analysis of RCBDs</h1>
<section id="model-and-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="model-and-assumptions">Model and Assumptions</h2>
<p>The statistical model for an RCBD can be expressed as:</p>
<p><span class="math display">\[
Y_{hi} = \mu + \theta_h + \tau_i + \epsilon_{hi}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{hi}\)</span>: Response variable for treatment <span class="math inline">\(i\)</span> in block <span class="math inline">\(h\)</span>.</li>
<li><span class="math inline">\(\mu\)</span>: Overall mean.</li>
<li><span class="math inline">\(\theta_h\)</span>: Effect of block <span class="math inline">\(h\)</span>.</li>
<li><span class="math inline">\(\tau_i\)</span>: Effect of treatment <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\epsilon_{hi} \sim N(0, \sigma^2)\)</span>: Random error term.</li>
</ul>
</section>
<section id="key-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="key-assumptions">Key Assumptions</h2>
<ol type="1">
<li><strong>Normality:</strong> The residuals (<span class="math inline">\(\epsilon_{hi}\)</span>) are normally distributed.</li>
<li><strong>Homogeneity of Variance (Homoscedasticity):</strong> The variance of residuals is constant across all treatments and blocks.</li>
<li><strong>Independence:</strong> Observations are independent of each other.</li>
<li><strong>No Interaction:</strong> There is no interaction between blocks and treatments, i.e., the effect of a treatment is consistent across all blocks.</li>
</ol>
<p><strong>Deeper Insight:</strong> Assumption of no interaction is critical. If this assumption is violated, the RCBD model may not adequately capture the variability, leading to biased estimates of treatment effects. In such cases, more complex designs that account for interactions, like general complete block designs, are necessary.</p>
</section>
<section id="anova-for-rcbds" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="anova-for-rcbds">ANOVA for RCBDs</h2>
<p>To analyze RCBDs, we employ <strong>Analysis of Variance (ANOVA)</strong>, which decomposes the total variability in the data into components attributable to blocks, treatments, and random error.</p>
<section id="variance-decomposition" class="level3">
<h3 class="anchored" data-anchor-id="variance-decomposition">Variance Decomposition</h3>
<p><span class="math display">\[
\text{Total SS} = \text{Block SS} + \text{Treatment SS} + \text{Error SS}
\]</span></p>
</section>
<section id="anova-table" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="anova-table">ANOVA Table</h3>
<div id="tbl-anova-table-rcbd" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-anova-table-rcbd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 11%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 32%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th>Source of Variation</th>
<th>Degrees of Freedom (DF)</th>
<th>Sum of Squares (SS)</th>
<th>Mean Square (MS)</th>
<th>F-ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Blocks</td>
<td><span class="math inline">\(b - 1\)</span></td>
<td><span class="math inline">\(SS_\text{Block}\)</span></td>
<td><span class="math inline">\(MS_\text{Block} = SS_\text{Block} / (b-1)\)</span></td>
<td></td>
</tr>
<tr class="even">
<td>Treatments</td>
<td><span class="math inline">\(t - 1\)</span></td>
<td><span class="math inline">\(SS_\text{Treatment}\)</span></td>
<td><span class="math inline">\(MS_\text{Treatment} = SS_\text{Treatment} / (t-1)\)</span></td>
<td><span class="math inline">\(\frac{MS_\text{Treatment}}{MS_\text{Error}}\)</span></td>
</tr>
<tr class="odd">
<td>Error</td>
<td><span class="math inline">\((b-1)(t-1)\)</span></td>
<td><span class="math inline">\(SS_\text{Error}\)</span></td>
<td><span class="math inline">\(MS_\text{Error} = SS_\text{Error} / ((b-1)(t-1))\)</span></td>
<td></td>
</tr>
<tr class="even">
<td><strong>Total</strong></td>
<td><span class="math inline">\(bt - 1\)</span></td>
<td><span class="math inline">\(SS_\text{Total}\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-anova-table-rcbd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: ANOVA Table for Randomized Complete Block Designs
</figcaption>
</figure>
</div>
</section>
<section id="f-ratio-and-hypothesis-testing" class="level3">
<h3 class="anchored" data-anchor-id="f-ratio-and-hypothesis-testing">F-Ratio and Hypothesis Testing</h3>
<ul>
<li><strong>Hypothesis Testing:</strong>
<ul>
<li><strong>Null Hypothesis (<span class="math inline">\(H_0\)</span>):</strong> All treatment means are equal (<span class="math inline">\(\tau_i = 0\)</span> for all <span class="math inline">\(i\)</span>).</li>
<li><strong>Alternative Hypothesis (<span class="math inline">\(H_A\)</span>):</strong> At least one treatment mean is different.</li>
</ul></li>
<li><strong>Decision Rule:</strong> Reject <span class="math inline">\(H_0\)</span> if the F-ratio exceeds the critical value from the F-distribution with degrees of freedom <span class="math inline">\((t-1, (b-1)(t-1))\)</span> at the chosen significance level (<span class="math inline">\(\alpha\)</span>).</li>
</ul>
<p><strong>Intuitive Explanation:</strong> The F-ratio compares the variability due to treatments to the variability due to random error. A higher F-ratio indicates that treatments explain a significant portion of the variability in responses, suggesting that treatment effects are meaningful.</p>
</section>
</section>
</section>
<section id="implementation-in-r" class="level1 page-columns page-full">
<h1>Implementation in R</h1>
<section id="example-bread-baking-experiment" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="example-bread-baking-experiment">Example: Bread-Baking Experiment</h2>
<section id="scenario" class="level3">
<h3 class="anchored" data-anchor-id="scenario">Scenario</h3>
<p>An experimenter aims to compare four bread recipes (treatments) across three oven shelves (blocks). Each shelf is expected to have similar conditions, making it an ideal blocking factor.</p>
</section>
<section id="step-by-step-r-code" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="step-by-step-r-code">Step-by-Step R Code</h3>
<section id="load-data-and-prepare-factors" class="level4">
<h4 class="anchored" data-anchor-id="load-data-and-prepare-factors">1. Load Data and Prepare Factors</h4>
<div class="cell" data-tbl-cap="Simulated Data for RCBD">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define blocks and treatments</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>blocks <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each =</span> <span class="dv">4</span>))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>treatments <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">times =</span> <span class="dv">3</span>))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate response variable (e.g., loaf weight in grams)</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="at">mean =</span> <span class="dv">500</span>, <span class="at">sd =</span> <span class="dv">10</span>), <span class="co"># Block 1</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="at">mean =</span> <span class="dv">505</span>, <span class="at">sd =</span> <span class="dv">10</span>), <span class="co"># Block 2</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="at">mean =</span> <span class="dv">498</span>, <span class="at">sd =</span> <span class="dv">10</span>) <span class="co"># Block 3</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(blocks, treatments, response)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># View the data</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   blocks treatments response
1       1          1 513.7096
2       1          2 494.3530
3       1          3 503.6313
4       1          4 506.3286
5       2          1 509.0427
6       2          2 503.9388
7       2          3 520.1152
8       2          4 504.0534
9       3          1 518.1842
10      3          2 497.3729
11      3          3 511.0487
12      3          4 520.8665</code></pre>
</div>
</div>
<p><strong>Output Interpretation:</strong> The dataset comprises three blocks, each containing all four treatments. The response variable represents the loaf weight, simulated with slight block-specific means to reflect potential block effects.</p>
</section>
<section id="fit-the-rcbd-model" class="level4">
<h4 class="anchored" data-anchor-id="fit-the-rcbd-model">2. Fit the RCBD Model</h4>
<div class="cell" data-tbl-cap="ANOVA Model for RCBD">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the RCBD model using ANOVA</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">aov</span>(response <span class="sc">~</span> blocks <span class="sc">+</span> treatments, <span class="at">data =</span> data)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the model</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
blocks       2  111.6   55.82   1.192  0.366
treatments   3  415.9  138.64   2.961  0.120
Residuals    6  280.9   46.82               </code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li><strong>Blocks:</strong> Capture the variability due to different oven shelves.</li>
<li><strong>Treatments:</strong> Assess the effect of different bread recipes after accounting for block effects.</li>
<li><strong>Error:</strong> Represents unexplained variability.</li>
</ul>
</section>
<section id="assess-blocking-efficiency" class="level4">
<h4 class="anchored" data-anchor-id="assess-blocking-efficiency">3. Assess Blocking Efficiency</h4>
<p>Compare the Mean Square for Blocks (<span class="math inline">\(MS_\text{Block}\)</span>) with Mean Square for Error (<span class="math inline">\(MS_\text{Error}\)</span>). A higher <span class="math inline">\(MS_\text{Block}\)</span> indicates substantial block effects, enhancing the precision of treatment comparisons.</p>
</section>
<section id="diagnostic-plots" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="diagnostic-plots">4. Diagnostic Plots</h4>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostic plots for the ANOVA model</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-rcbd-diagnostic-plots" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-rcbd-diagnostic-plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="week-08_rcbd-blocking_files/figure-html/fig-rcbd-diagnostic-plots-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Diagnostic Plots for RCBD"><img src="week-08_rcbd-blocking_files/figure-html/fig-rcbd-diagnostic-plots-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-rcbd-diagnostic-plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Diagnostic Plots for RCBD
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li><strong>Residuals vs Fitted:</strong> Check for homoscedasticity and non-linearity.</li>
<li><strong>Normal Q-Q:</strong> Assess normality of residuals.</li>
<li><strong>Scale-Location:</strong> Evaluate homogeneity of variance.</li>
<li><strong>Residuals vs Leverage:</strong> Identify influential observations.</li>
</ul>
</section>
<section id="multiple-comparisons-post-hoc-analysis" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="multiple-comparisons-post-hoc-analysis">5. Multiple Comparisons (Post-Hoc Analysis)</h4>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load emmeans package for estimated marginal means</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated marginal means for treatments</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span>treatments)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Pairwise comparisons</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>pairwise_comparisons <span class="ot">&lt;-</span> <span class="fu">contrast</span>(emm, <span class="at">method =</span> <span class="st">"pairwise"</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pairwise_comparisons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-rcbd-posthoc-comparisons" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-rcbd-posthoc-comparisons-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"treatments1 - treatments2","2":"15.090624","3":"5.586712","4":"6","5":"2.7011640","6":"0.1232253","_rn_":"1"},{"1":"treatments1 - treatments3","2":"2.047101","3":"5.586712","4":"6","5":"0.3664233","6":"0.9816357","_rn_":"2"},{"1":"treatments1 - treatments4","2":"3.229338","3":"5.586712","4":"6","5":"0.5780392","6":"0.9351362","_rn_":"3"},{"1":"treatments2 - treatments3","2":"-13.043523","3":"5.586712","4":"6","5":"-2.3347406","6":"0.1917580","_rn_":"4"},{"1":"treatments2 - treatments4","2":"-11.861286","3":"5.586712","4":"6","5":"-2.1231247","6":"0.2467385","_rn_":"5"},{"1":"treatments3 - treatments4","2":"1.182237","3":"5.586712","4":"6","5":"0.2116159","6":"0.9962846","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-rcbd-posthoc-comparisons-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Pairwise Comparisons for Treatments
</figcaption>
</figure>
</div>
</div>
<p><strong>Interpretation:</strong> Identify which bread recipes significantly differ in loaf weight after adjusting for oven shelf effects.</p>
</section>
</section>
</section>
</section>
<section id="enhanced-lecture-on-randomized-complete-block-design-rcbd" class="level1 page-columns page-full">
<h1>Enhanced Lecture on Randomized Complete Block Design (RCBD)</h1>
<section id="model-for-rcbd" class="level2">
<h2 class="anchored" data-anchor-id="model-for-rcbd">Model for RCBD</h2>
<p>The model for an RCBD is:</p>
<p><span class="math display">\[
Y_{ij} = \mu + \tau_i + \beta_j + \epsilon_{ij},
\]</span></p>
<p>where: - <span class="math inline">\(Y_{ij}\)</span>: Response for the <span class="math inline">\(i\)</span>-th treatment in the <span class="math inline">\(j\)</span>-th block. - <span class="math inline">\(\mu\)</span>: Overall mean. - <span class="math inline">\(\tau_i\)</span>: Effect of the <span class="math inline">\(i\)</span>-th treatment. - <span class="math inline">\(\beta_j\)</span>: Effect of the <span class="math inline">\(j\)</span>-th block. - <span class="math inline">\(\epsilon_{ij}\)</span>: Random error component, <span class="math inline">\(\epsilon_{ij} \sim N(0, \sigma^2)\)</span>.</p>
</section>
<section id="analysis-of-variance-anova" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-variance-anova">Analysis of Variance (ANOVA)</h2>
<p>For RCBD: 1. Total Sum of Squares (SS): <span class="math display">\[
SS_{\text{Total}} = \sum_{i,j} (Y_{ij} - \bar{Y})^2
\]</span> 2. Treatment Sum of Squares (SS): <span class="math display">\[
SS_{\text{Treatment}} = \sum_{i} b(\bar{Y}_{i.} - \bar{Y})^2
\]</span> 3. Block Sum of Squares (SS): <span class="math display">\[
SS_{\text{Block}} = \sum_{j} t(\bar{Y}_{.j} - \bar{Y})^2
\]</span> 4. Error Sum of Squares (SS): <span class="math display">\[
SS_{\text{Error}} = SS_{\text{Total}} - SS_{\text{Treatment}} - SS_{\text{Block}}
\]</span></p>
<p>The F-statistic for treatments: <span class="math display">\[
F = \frac{\text{MS}_{\text{Treatment}}}{\text{MS}_{\text{Error}}}
\]</span></p>
</section>
<section id="comprehension-questions" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="comprehension-questions">Comprehension Questions</h2>
<ol type="1">
<li>Conceptual: Define blocking factors, noise factors, and covariates. Provide examples for each.</li>
<li>Computational: For a dataset, perform an RCBD ANOVA and interpret the results.</li>
<li>Application-based: Design an experiment involving RCBD for a real-world problem.</li>
<li>Theoretical: Derive the formulas for <span class="math inline">\(SS_{\text{Treatment}}, SS_{\text{Block}},\)</span> and <span class="math inline">\(SS_{\text{Error}}\)</span> from the RCBD model.</li>
</ol>
<section id="question-1-definitions-and-examples" class="level3">
<h3 class="anchored" data-anchor-id="question-1-definitions-and-examples">Question 1: Definitions and Examples</h3>
<ul>
<li><strong>Blocking Factors</strong>: Variables controlled by grouping (e.g., fields in agricultural studies).</li>
<li><strong>Noise Factors</strong>: External, uncontrollable variables (e.g., humidity).</li>
<li><strong>Covariates</strong>: Variables measured and included in the model (e.g., weight in a diet study).</li>
</ul>
</section>
<section id="question-2-rcbd-anova" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="question-2-rcbd-anova">Question 2: RCBD ANOVA</h3>
<p>Use the model to compute <span class="math inline">\(SS_{\text{Treatment}}\)</span>, <span class="math inline">\(SS_{\text{Block}}\)</span>, <span class="math inline">\(SS_{\text{Error}}\)</span>, and <span class="math inline">\(F\)</span>-ratios in R:</p>
<div id="tbl-rcbd-anova" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-rcbd-anova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example R Code</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Block =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">each =</span> <span class="dv">3</span>)),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Treatment =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">times =</span> <span class="dv">4</span>)),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Response =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">22</span>, <span class="dv">24</span>, <span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">22</span>, <span class="dv">24</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">23</span>, <span class="dv">22</span>, <span class="dv">21</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">aov</span>(Response <span class="sc">~</span> Treatment <span class="sc">+</span> Block, <span class="at">data =</span> data)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)  
Treatment    2   3.50    1.75   1.000  0.422  
Block        3  20.25    6.75   3.857  0.075 .
Residuals    6  10.50    1.75                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-rcbd-anova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: ANOVA Table for RCBD
</figcaption>
</figure>
</div>
</section>
<section id="question-3-experimental-design" class="level3">
<h3 class="anchored" data-anchor-id="question-3-experimental-design">Question 3: Experimental Design</h3>
<ul>
<li>Experiment: Determine optimal fertilizer for crop yield.</li>
<li>Blocks: Different fields.</li>
<li>Treatments: Types of fertilizers.</li>
<li>Response: Crop yield per plot.</li>
</ul>
</section>
<section id="question-4-derivations" class="level3">
<h3 class="anchored" data-anchor-id="question-4-derivations">Question 4: Derivations</h3>
<p>From the model: - Use deviations to compute sums of squares. - Ensure orthogonality between treatment and block effects in derivations.</p>
</section>
</section>
<section id="real-world-applications" class="level2">
<h2 class="anchored" data-anchor-id="real-world-applications">Real-World Applications</h2>
<ol type="1">
<li><strong>Agriculture</strong>:
<ul>
<li>Testing fertilizers, pesticides, or irrigation methods across fields with varying soil quality.</li>
<li>Example: Comparing four irrigation methods across farms with different rainfall patterns.</li>
</ul></li>
<li><strong>Pharmaceuticals</strong>:
<ul>
<li>Evaluating the effectiveness of drugs across different hospitals or demographic groups (age, gender).</li>
</ul></li>
<li><strong>Manufacturing</strong>:
<ul>
<li>Comparing machine settings across different operators or shifts to control for operator variability.</li>
</ul></li>
<li><strong>Education</strong>:
<ul>
<li>Assessing teaching methods across classrooms with varying student skill levels.</li>
</ul></li>
</ol>
</section>
<section id="numerical-example-1-testing-fertilizers" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="numerical-example-1-testing-fertilizers">Numerical Example 1: Testing Fertilizers</h2>
<section id="scenario-1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="scenario-1"><strong>Scenario</strong></h3>
<p>A researcher compares three fertilizers (<span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span>) on plant growth across four fields (blocks). Each field receives all three fertilizers, randomized within the block.</p>
<p><strong>Data:</strong></p>
<div id="tbl-fertilizer-data" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-fertilizer-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th>Block (Field)</th>
<th>Fertilizer A</th>
<th>Fertilizer B</th>
<th>Fertilizer C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>20</td>
<td>25</td>
<td>22</td>
</tr>
<tr class="even">
<td>2</td>
<td>18</td>
<td>21</td>
<td>19</td>
</tr>
<tr class="odd">
<td>3</td>
<td>22</td>
<td>24</td>
<td>23</td>
</tr>
<tr class="even">
<td>4</td>
<td>19</td>
<td>20</td>
<td>21</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-fertilizer-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Plant Growth Data for Fertilizer Experiment
</figcaption>
</figure>
</div>
</section>
<section id="step-by-step-analysis" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="step-by-step-analysis"><strong>Step-by-Step Analysis</strong></h3>
<section id="step-1-compute-means" class="level4">
<h4 class="anchored" data-anchor-id="step-1-compute-means"><strong>Step 1: Compute Means</strong></h4>
<ol type="1">
<li><strong>Overall Mean (<span class="math inline">\(\bar{Y}\)</span>):</strong></li>
</ol>
<p><span class="math display">\[
\bar{Y} = \frac{\text{Sum of all observations}}{\text{Total number of observations}} = \frac{20 + 25 + \dots + 21}{12} = 21.33
\]</span></p>
<ol type="1">
<li><strong>Treatment Means (<span class="math inline">\(\bar{Y}_{i\cdot}\)</span>):</strong>
<ul>
<li>Fertilizer <span class="math inline">\(A\)</span>: <span class="math inline">\(\bar{Y}_A = \frac{20 + 18 + 22 + 19}{4} = 19.75\)</span></li>
<li>Fertilizer <span class="math inline">\(B\)</span>: <span class="math inline">\(\bar{Y}_B = \frac{25 + 21 + 24 + 20}{4} = 22.50\)</span></li>
<li>Fertilizer <span class="math inline">\(C\)</span>: <span class="math inline">\(\bar{Y}_C = \frac{22 + 19 + 23 + 21}{4} = 21.25\)</span></li>
</ul></li>
<li><strong>Block Means (<span class="math inline">\(\bar{Y}_{\cdot j}\)</span>):</strong>
<ul>
<li>Block 1: <span class="math inline">\(\bar{Y}_{\cdot 1} = \frac{20 + 25 + 22}{3} = 22.33\)</span></li>
<li>Block 2: <span class="math inline">\(\bar{Y}_{\cdot 2} = \frac{18 + 21 + 19}{3} = 19.33\)</span></li>
<li>Block 3: <span class="math inline">\(\bar{Y}_{\cdot 3} = \frac{22 + 24 + 23}{3} = 23.00\)</span></li>
<li>Block 4: <span class="math inline">\(\bar{Y}_{\cdot 4} = \frac{19 + 20 + 21}{3} = 20.00\)</span></li>
</ul></li>
</ol>
</section>
<section id="step-2-calculate-sums-of-squares" class="level4">
<h4 class="anchored" data-anchor-id="step-2-calculate-sums-of-squares"><strong>Step 2: Calculate Sums of Squares</strong></h4>
<ol type="1">
<li><strong>Total Sum of Squares (<span class="math inline">\(SS_{\text{Total}}\)</span>):</strong></li>
</ol>
<p><span class="math display">\[
SS_{\text{Total}} = \sum_{i,j} (Y_{ij} - \bar{Y})^2 = 35.33
\]</span></p>
<ol type="1">
<li><strong>Treatment Sum of Squares (<span class="math inline">\(SS_{\text{Treatment}}\)</span>):</strong></li>
</ol>
<p><span class="math display">\[
SS_{\text{Treatment}} = b \sum_i (\bar{Y}_{i\cdot} - \bar{Y})^2 = 4[(19.75 - 21.33)^2 + (22.50 - 21.33)^2 + (21.25 - 21.33)^2] = 12.67
\]</span></p>
<ol type="1">
<li><strong>Block Sum of Squares (<span class="math inline">\(SS_{\text{Block}}\)</span>):</strong></li>
</ol>
<p><span class="math display">\[
SS_{\text{Block}} = t \sum_j (\bar{Y}_{\cdot j} - \bar{Y})^2 = 3[(22.33 - 21.33)^2 + \dots + (20.00 - 21.33)^2] = 21.33
\]</span></p>
<ol type="1">
<li><strong>Error Sum of Squares (<span class="math inline">\(SS_{\text{Error}}\)</span>):</strong></li>
</ol>
<p><span class="math display">\[
SS_{\text{Error}} = SS_{\text{Total}} - SS_{\text{Treatment}} - SS_{\text{Block}} = 35.33 - 12.67 - 21.33 = 1.33
\]</span></p>
</section>
<section id="step-3-construct-anova-table" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="step-3-construct-anova-table"><strong>Step 3: Construct ANOVA Table</strong></h4>
<div id="tbl-anova-table-fertilizer" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-anova-table-fertilizer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th>Source</th>
<th>DF</th>
<th>SS</th>
<th>MS</th>
<th>F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Treatment</td>
<td>2</td>
<td>12.67</td>
<td>6.33</td>
<td>19.02</td>
</tr>
<tr class="even">
<td>Block</td>
<td>3</td>
<td>21.33</td>
<td>7.11</td>
<td></td>
</tr>
<tr class="odd">
<td>Error</td>
<td>6</td>
<td>1.33</td>
<td>0.22</td>
<td></td>
</tr>
<tr class="even">
<td><strong>Total</strong></td>
<td>11</td>
<td>35.33</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-anova-table-fertilizer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: ANOVA Table for Fertilizer Experiment
</figcaption>
</figure>
</div>
</section>
<section id="step-4-interpret-results" class="level4">
<h4 class="anchored" data-anchor-id="step-4-interpret-results"><strong>Step 4: Interpret Results</strong></h4>
<ol type="1">
<li><strong>Treatment Effect</strong>:
<ul>
<li>The <span class="math inline">\(F\)</span>-statistic for treatments is <span class="math inline">\(19.02\)</span>, with a p-value <span class="math inline">\(&lt; 0.01\)</span>. This indicates a significant difference in plant growth between fertilizers.</li>
<li>Fertilizer <span class="math inline">\(B\)</span> (<span class="math inline">\(\bar{Y}_B = 22.50\)</span>) performed the best on average.</li>
</ul></li>
<li><strong>Block Effect</strong>:
<ul>
<li><span class="math inline">\(SS_{\text{Block}} = 21.33\)</span> indicates considerable variability between fields, confirming that blocking was necessary to control this variability.</li>
</ul></li>
</ol>
</section>
</section>
</section>
<section id="real-world-example-2-testing-teaching-methods" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="real-world-example-2-testing-teaching-methods">Real-World Example 2: Testing Teaching Methods</h2>
<section id="scenario-2" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="scenario-2"><strong>Scenario</strong></h3>
<p>A school tests three teaching methods (<span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span>) on student performance across four classes (blocks). Each class is taught using all three methods, randomly assigned.</p>
<p><strong>Data:</strong></p>
<div id="tbl-teaching-data" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-teaching-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th>Class</th>
<th>Method A</th>
<th>Method B</th>
<th>Method C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>85</td>
<td>88</td>
<td>84</td>
</tr>
<tr class="even">
<td>2</td>
<td>82</td>
<td>83</td>
<td>80</td>
</tr>
<tr class="odd">
<td>3</td>
<td>90</td>
<td>89</td>
<td>92</td>
</tr>
<tr class="even">
<td>4</td>
<td>88</td>
<td>86</td>
<td>87</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-teaching-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: Student Performance Data for Teaching Methods Experiment
</figcaption>
</figure>
</div>
</section>
<section id="step-by-step-analysis-1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="step-by-step-analysis-1"><strong>Step-by-Step Analysis</strong></h3>
<section id="step-1-compute-means-1" class="level4">
<h4 class="anchored" data-anchor-id="step-1-compute-means-1"><strong>Step 1: Compute Means</strong></h4>
<ol type="1">
<li><strong>Overall Mean</strong>: <span class="math inline">\(\bar{Y} = \frac{\sum Y_{ij}}{12} = 86.42\)</span></li>
<li><strong>Method Means</strong>:
<ul>
<li><span class="math inline">\(\bar{Y}_A = 86.25, \; \bar{Y}_B = 86.50, \; \bar{Y}_C = 85.50\)</span></li>
</ul></li>
<li><strong>Class Means</strong>:
<ul>
<li><span class="math inline">\(\bar{Y}_{\cdot 1} = 85.67, \; \bar{Y}_{\cdot 2} = 81.67, \; \bar{Y}_{\cdot 3} = 90.33, \; \bar{Y}_{\cdot 4} = 87.00\)</span></li>
</ul></li>
</ol>
</section>
<section id="step-2-sums-of-squares" class="level4">
<h4 class="anchored" data-anchor-id="step-2-sums-of-squares"><strong>Step 2: Sums of Squares</strong></h4>
<ol type="1">
<li><span class="math inline">\(SS_{\text{Total}} = 57.17\)</span></li>
<li><span class="math inline">\(SS_{\text{Treatment}} = 6.17\)</span></li>
<li><span class="math inline">\(SS_{\text{Block}} = 46.83\)</span></li>
<li><span class="math inline">\(SS_{\text{Error}} = 4.17\)</span></li>
</ol>
</section>
<section id="step-3-anova-table" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="step-3-anova-table"><strong>Step 3: ANOVA Table</strong></h4>
<div id="tbl-anova-table-teaching" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-anova-table-teaching-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th>Source</th>
<th>DF</th>
<th>SS</th>
<th>MS</th>
<th>F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Treatment</td>
<td>2</td>
<td>6.17</td>
<td>3.08</td>
<td>4.44</td>
</tr>
<tr class="even">
<td>Block</td>
<td>3</td>
<td>46.83</td>
<td>15.61</td>
<td></td>
</tr>
<tr class="odd">
<td>Error</td>
<td>6</td>
<td>4.17</td>
<td>0.69</td>
<td></td>
</tr>
<tr class="even">
<td><strong>Total</strong></td>
<td>11</td>
<td>57.17</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-anova-table-teaching-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7: ANOVA Table for Teaching Methods Experiment
</figcaption>
</figure>
</div>
</section>
<section id="step-4-interpret-results-1" class="level4">
<h4 class="anchored" data-anchor-id="step-4-interpret-results-1"><strong>Step 4: Interpret Results</strong></h4>
<ol type="1">
<li><strong>Treatment Effect</strong>:
<ul>
<li><span class="math inline">\(F = 4.44\)</span>, p-value <span class="math inline">\(= 0.067\)</span>. The teaching methods do not differ significantly.</li>
</ul></li>
<li><strong>Block Effect</strong>:
<ul>
<li>Large <span class="math inline">\(SS_{\text{Block}}\)</span> shows variability between classes, justifying the use of blocks.</li>
</ul></li>
</ol>
</section>
</section>
</section>
<section id="key-insights" class="level2">
<h2 class="anchored" data-anchor-id="key-insights"><strong>6. Key Insights</strong></h2>
<ol type="1">
<li><strong>Blocking Matters</strong>:
<ul>
<li>Ignoring blocks increases residual variability, reducing statistical power.</li>
</ul></li>
<li><strong>Practical Use</strong>:
<ul>
<li>RCBD is invaluable when variability between experimental units can be controlled through blocking.</li>
</ul></li>
</ol>
</section>
<section id="contrasts-in-rcbd" class="level2">
<h2 class="anchored" data-anchor-id="contrasts-in-rcbd"><strong>2. Contrasts in RCBD</strong></h2>
<p>Contrasts are linear combinations of treatment means that allow targeted comparisons between treatments.</p>
<section id="definition" class="level3">
<h3 class="anchored" data-anchor-id="definition"><strong>2.1 Definition</strong></h3>
<p>A <strong>contrast</strong> is a linear combination of treatment means:</p>
<p><span class="math display">\[
C = \sum_i c_i \mu_i
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(c_i\)</span> are coefficients such that <span class="math inline">\(\sum_i c_i = 0\)</span>,</li>
<li><span class="math inline">\(\mu_i\)</span> are the treatment means.</li>
</ul>
</section>
<section id="examples-of-contrasts" class="level3">
<h3 class="anchored" data-anchor-id="examples-of-contrasts"><strong>2.2 Examples of Contrasts</strong></h3>
<ol type="1">
<li><strong>Comparing Two Treatments</strong> (<span class="math inline">\(A\)</span> vs <span class="math inline">\(B\)</span>):</li>
</ol>
<p><span class="math display">\[
C = \mu_A - \mu_B \quad \text{(coefficients: $1, -1, 0$)}.
\]</span></p>
<ol type="1">
<li><strong>Comparing One Treatment to the Average of Others</strong> (<span class="math inline">\(A\)</span> vs <span class="math inline">\((B+C)/2\)</span>):</li>
</ol>
<p><span class="math display">\[
C = \mu_A - \frac{\mu_B + \mu_C}{2} \quad \text{(coefficients: $1, -0.5, -0.5$)}.
\]</span></p>
<ol type="1">
<li><strong>Testing for Linear Trends</strong> (e.g., in dose-response studies): Assign weights like <span class="math inline">\(-1, 0, 1\)</span> for increasing levels of a factor.</li>
</ol>
</section>
</section>
<section id="numerical-example-with-contrasts" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="numerical-example-with-contrasts">Numerical Example with Contrasts</h2>
<section id="scenario-3" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="scenario-3"><strong>3.1 Scenario</strong></h3>
<p>A researcher tests three fertilizers (<span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span>) on plant growth across four fields. The goal is to:</p>
<ol type="1">
<li>Compare <span class="math inline">\(A\)</span> vs <span class="math inline">\(B\)</span>,</li>
<li>Compare <span class="math inline">\(A\)</span> vs the average of <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span>.</li>
</ol>
<p><strong>Data:</strong></p>
<div id="tbl-fertilizer-data-contrasts" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-fertilizer-data-contrasts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th>Block (Field)</th>
<th>Fertilizer A</th>
<th>Fertilizer B</th>
<th>Fertilizer C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>20</td>
<td>25</td>
<td>22</td>
</tr>
<tr class="even">
<td>2</td>
<td>18</td>
<td>21</td>
<td>19</td>
</tr>
<tr class="odd">
<td>3</td>
<td>22</td>
<td>24</td>
<td>23</td>
</tr>
<tr class="even">
<td>4</td>
<td>19</td>
<td>20</td>
<td>21</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-fertilizer-data-contrasts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8: Plant Growth Data for Fertilizer Experiment
</figcaption>
</figure>
</div>
</section>
<section id="anova-analysis" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="anova-analysis">3.2 ANOVA Analysis</h3>
<p><strong>Step 1: Compute Sums of Squares (as in prior example)</strong></p>
<div id="tbl-anova-table-fertilizer-contrasts" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-anova-table-fertilizer-contrasts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th>Source</th>
<th>DF</th>
<th>SS</th>
<th>MS</th>
<th>F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Treatment</td>
<td>2</td>
<td>12.67</td>
<td>6.33</td>
<td>19.02</td>
</tr>
<tr class="even">
<td>Block</td>
<td>3</td>
<td>21.33</td>
<td>7.11</td>
<td></td>
</tr>
<tr class="odd">
<td>Error</td>
<td>6</td>
<td>1.33</td>
<td>0.22</td>
<td></td>
</tr>
<tr class="even">
<td><strong>Total</strong></td>
<td>11</td>
<td>35.33</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-anova-table-fertilizer-contrasts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9: ANOVA Table for Fertilizer Experiment
</figcaption>
</figure>
</div>
</section>
<section id="step-by-step-contrast-computations" class="level3">
<h3 class="anchored" data-anchor-id="step-by-step-contrast-computations">3.3 Step-by-Step Contrast Computations</h3>
<ol type="1">
<li><strong>Treatment Means</strong>:
<ul>
<li><span class="math inline">\(\bar{Y}_A = 19.75, \; \bar{Y}_B = 22.50, \; \bar{Y}_C = 21.25\)</span>.</li>
</ul></li>
<li><strong>Contrast 1 (<span class="math inline">\(A\)</span> vs <span class="math inline">\(B\)</span>):</strong></li>
</ol>
<p><span class="math display">\[
C_1 = \bar{Y}_A - \bar{Y}_B = 19.75 - 22.50 = -2.75
\]</span></p>
<ol type="1">
<li><strong>Contrast 2 (<span class="math inline">\(A\)</span> vs Average of <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span>):</strong></li>
</ol>
<p><span class="math display">\[
C_2 = \bar{Y}_A - \frac{\bar{Y}_B + \bar{Y}_C}{2} = 19.75 - \frac{22.50 + 21.25}{2} = -2.63
\]</span></p>
<ol type="1">
<li><strong>Standard Error of Contrasts</strong>:</li>
</ol>
<p><span class="math display">\[
SE(C) = \sqrt{\frac{\sigma^2}{b} \sum_i c_i^2},
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\sigma^2 = MS_{\text{Error}} = 0.22\)</span>,</li>
<li><span class="math inline">\(b = 4\)</span> (number of blocks).</li>
</ul>
<p>For <span class="math inline">\(C_1\)</span> (<span class="math inline">\(1, -1, 0\)</span>):</p>
<p><span class="math display">\[
SE(C_1) = \sqrt{\frac{0.22}{4} \cdot (1^2 + (-1)^2 + 0^2)} = 0.33
\]</span></p>
<p>For <span class="math inline">\(C_2\)</span> (<span class="math inline">\(1, -0.5, -0.5\)</span>):</p>
<p><span class="math display">\[
SE(C_2) = \sqrt{\frac{0.22}{4} \cdot (1^2 + (-0.5)^2 + (-0.5)^2)} = 0.28
\]</span></p>
<ol type="1">
<li><strong>t-Statistics</strong>:</li>
</ol>
<p><span class="math display">\[
t = \frac{C}{SE(C)}.
\]</span></p>
<ul>
<li>For <span class="math inline">\(C_1\)</span>: <span class="math inline">\(t_1 = \frac{-2.75}{0.33} = -8.33\)</span>.</li>
<li>For <span class="math inline">\(C_2\)</span>: <span class="math inline">\(t_2 = \frac{-2.63}{0.28} = -9.39\)</span>.</li>
</ul>
<ol type="1">
<li><strong>p-Values</strong>: With 6 degrees of freedom (<span class="math inline">\(DF_{\text{Error}}\)</span>):
<ul>
<li><span class="math inline">\(p_1 &lt; 0.001\)</span>, <span class="math inline">\(p_2 &lt; 0.001\)</span>.</li>
</ul></li>
</ol>
</section>
<section id="r-code-to-analyze-contrasts" class="level3">
<h3 class="anchored" data-anchor-id="r-code-to-analyze-contrasts"><strong>3.4 R Code to Analyze Contrasts</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Block =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">each =</span> <span class="dv">3</span>)),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Fertilizer =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">times =</span> <span class="dv">4</span>)),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Response =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">22</span>, <span class="dv">18</span>, <span class="dv">21</span>, <span class="dv">19</span>, <span class="dv">22</span>, <span class="dv">24</span>, <span class="dv">23</span>, <span class="dv">19</span>, <span class="dv">20</span>, <span class="dv">21</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ANOVA Model</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">aov</span>(Response <span class="sc">~</span> Fertilizer <span class="sc">+</span> Block, <span class="at">data =</span> data)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)  
Fertilizer   2 15.167   7.583   7.378 0.0242 *
Block        3 28.333   9.444   9.189 0.0116 *
Residuals    6  6.167   1.028                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contrasts</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>em <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="st">"Fertilizer"</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Contrast 1: A vs B</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(em, <span class="fu">list</span>(<span class="st">"A vs B"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast estimate    SE df t.ratio p.value
 A vs B      -2.75 0.717  6  -3.836  0.0086

Results are averaged over the levels of: Block </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contrast 2: A vs (B + C)/2</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(em, <span class="fu">list</span>(<span class="st">"A vs Avg(B, C)"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate    SE df t.ratio p.value
 A vs Avg(B, C)    -2.12 0.621  6  -3.423  0.0141

Results are averaged over the levels of: Block </code></pre>
</div>
</div>
</section>
<section id="explanation-of-r-output" class="level3">
<h3 class="anchored" data-anchor-id="explanation-of-r-output"><strong>3.5 Explanation of R Output</strong></h3>
<ol type="1">
<li><strong>ANOVA Table</strong>:</li>
</ol>
<pre class="text"><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)  
Fertilizer   2 15.167   7.583   7.378 0.0242 *
Block        3 28.333   9.444   9.189 0.0116 *
Residuals    6  6.167   1.028                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<ul>
<li>Treatments are significant (<span class="math inline">\(p = 0.002\)</span>).</li>
</ul>
<ol start="2" type="1">
<li><strong>Contrast Results</strong>:</li>
</ol>
<ul>
<li><strong><span class="math inline">\(A\)</span> vs <span class="math inline">\(B\)</span></strong>:</li>
</ul>
<pre class="text"><code> contrast estimate    SE df t.ratio p.value
 A vs B      -2.75 0.717  6  -3.836  0.0086

Results are averaged over the levels of: Block</code></pre>
<ul>
<li>Fertilizer <span class="math inline">\(B\)</span> significantly outperforms <span class="math inline">\(A\)</span>.</li>
<li><strong><span class="math inline">\(A\)</span> vs <span class="math inline">\((B+C)/2\)</span></strong>:</li>
</ul>
<pre class="text"><code> contrast       estimate    SE df t.ratio p.value
 A vs Avg(B, C)    -2.12 0.621  6  -3.423  0.0141

Results are averaged over the levels of: Block </code></pre>
<ul>
<li>The average of <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span> significantly outperforms <span class="math inline">\(A\)</span>.</li>
</ul>
</section>
</section>
<section id="interpretation" class="level2">
<h2 class="anchored" data-anchor-id="interpretation">4. Interpretation</h2>
<ol type="1">
<li><strong>ANOVA Results</strong>:
<ul>
<li>Treatments significantly affect plant growth (<span class="math inline">\(p = 0.002\)</span>).</li>
<li>Blocking controls variability due to fields.</li>
</ul></li>
<li><strong>Contrasts</strong>:
<ul>
<li>Fertilizer <span class="math inline">\(B\)</span> is significantly better than <span class="math inline">\(A\)</span> (<span class="math inline">\(t = -8.33, p &lt; 0.001\)</span>).</li>
<li>The average of <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span> also significantly outperforms <span class="math inline">\(A\)</span> (<span class="math inline">\(t = -9.39, p &lt; 0.001\)</span>).</li>
</ul></li>
<li><strong>Practical Implication</strong>:
<ul>
<li>Fertilizer <span class="math inline">\(B\)</span> is the most effective. The contrast analysis provides detailed insights beyond ANOVA.</li>
</ul></li>
</ol>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">5. Summary</h2>
<ol type="1">
<li><strong>RCBD Benefits</strong>:
<ul>
<li>Controls variability from blocks (e.g., fields, classrooms).</li>
<li>Provides more precise estimates of treatment effects.</li>
</ul></li>
<li><strong>Contrasts</strong>:
<ul>
<li>Useful for testing specific hypotheses about treatment effects.</li>
<li>Add depth to the ANOVA by allowing targeted comparisons.</li>
</ul></li>
<li><strong>R Analysis</strong>:
<ul>
<li>ANOVA identifies significant differences.</li>
<li>Contrasts pinpoint specific treatment relationships.</li>
</ul></li>
</ol>


</section>
</section>

</main> <!-- /main -->
<!-- filepath: /Users/dt/Library/CloudStorage/Dropbox/Teaching/DOE/assets/includes/footer.html -->
<footer class="site-footer">
    <div class="container text-center">
        <hr> 
        © <span id="current-year"></span> Dr. Davood Tofighi |
        <a href="https://canvasinfo.unm.edu/">UNM Canvas</a> |
        <a href="https://data-wise.github.io/doe">Course GitHub Page</a> |
    </div>
    <script>
        document.getElementById("current-year").textContent = new Date().getFullYear();
    </script>
</footer>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/Data-Wise\.github\.io\/doe\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>