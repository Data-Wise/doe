<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Davood Tofighi, Ph.D.">

<title>Factorial ANOVA – STAT 454/545 - Analysis of Variance and Experimental Design</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../assets/images/favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-1092c56c6cadf2eb47b1bc8063ab382a.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-68b729f92b170261f1b1556cc4834a67.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&amp;family=Montserrat:wght@400;700&amp;family=Fira+Code:wght@400;700&amp;display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Factorial ANOVA – STAT 454/545 - Analysis of Variance and Experimental Design">
<meta property="og:description" content="Analysis of Variance and Experimental Design">
<meta property="og:image" content="https://Data-Wise.github.io/doe/lectures/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta property="og:site_name" content="STAT 454/545 - Analysis of Variance and Experimental Design">
</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">STAT 545</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus/syllabus-final.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_lectures.html"> 
<span class="menu-text">Lecture Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus/schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_assignments.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../r_help.html"> 
<span class="menu-text">R Help</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../home_appendix.html"> 
<span class="menu-text">Appendix</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../contents.html"> 
<span class="menu-text">Contents</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Factorial ANOVA</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Factorial ANOVA</h1>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://Data-Wise.github.io/doe">Davood Tofighi, Ph.D.</a> <a href="mailto:dtofighi@unm.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0001-8523-7776" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Department of Mathematics and Statistics, University of New Mexico
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">11-Jan-2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Course Overview</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/syllabus-final.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Course Materials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../home_lectures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../home_assignments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignments</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">R Code and Datasets</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../r_help.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Help</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../r-code-data-book.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Code and Datasets from the Book</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data-files-book.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets from the Book</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Resources</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../home_appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contents</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="-1">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#objectives" id="toc-objectives" class="nav-link active" data-scroll-target="#objectives">Objectives</a></li>
  <li><a href="#r-packages" id="toc-r-packages" class="nav-link" data-scroll-target="#r-packages">R Packages</a></li>
  <li><a href="#checking-the-assumptions-on-the-model" id="toc-checking-the-assumptions-on-the-model" class="nav-link" data-scroll-target="#checking-the-assumptions-on-the-model">Checking the Assumptions on the Model</a>
  <ul class="collapse">
  <li><a href="#standardized-residuals" id="toc-standardized-residuals" class="nav-link" data-scroll-target="#standardized-residuals">Standardized Residuals</a></li>
  </ul></li>
  <li><a href="#contrasts" id="toc-contrasts" class="nav-link" data-scroll-target="#contrasts">Contrasts</a>
  <ul class="collapse">
  <li><a href="#contrasts-for-main-effects-and-interactions" id="toc-contrasts-for-main-effects-and-interactions" class="nav-link" data-scroll-target="#contrasts-for-main-effects-and-interactions">Contrasts for Main Effects and Interactions</a></li>
  <li><a href="#writing-contrasts-as-coefficient-lists" id="toc-writing-contrasts-as-coefficient-lists" class="nav-link" data-scroll-target="#writing-contrasts-as-coefficient-lists">Writing Contrasts as Coefficient Lists</a></li>
  </ul></li>
  <li><a href="#analysis-of-the-two-way-complete-model" id="toc-analysis-of-the-two-way-complete-model" class="nav-link" data-scroll-target="#analysis-of-the-two-way-complete-model">Analysis of the Two-Way Complete Model</a>
  <ul class="collapse">
  <li><a href="#least-squares-estimators" id="toc-least-squares-estimators" class="nav-link" data-scroll-target="#least-squares-estimators">Least Squares Estimators</a></li>
  <li><a href="#estimation-of-sigma2" id="toc-estimation-of-sigma2" class="nav-link" data-scroll-target="#estimation-of-sigma2">Estimation of <span class="math inline">\(\sigma^2\)</span></a>
  <ul class="collapse">
  <li><a href="#multiple-comparisons-with-unequal-variances" id="toc-multiple-comparisons-with-unequal-variances" class="nav-link" data-scroll-target="#multiple-comparisons-with-unequal-variances">Multiple Comparisons with Unequal Variances</a></li>
  </ul></li>
  <li><a href="#analysis-of-variance-for-the-complete-model" id="toc-analysis-of-variance-for-the-complete-model" class="nav-link" data-scroll-target="#analysis-of-variance-for-the-complete-model">Analysis of Variance for the Complete Model</a></li>
  </ul></li>
  <li><a href="#analysis-of-the-two-way-main-effects-model" id="toc-analysis-of-the-two-way-main-effects-model" class="nav-link" data-scroll-target="#analysis-of-the-two-way-main-effects-model">Analysis of the Two-Way Main-Effects Model</a>
  <ul class="collapse">
  <li><a href="#least-squares-estimators-equal-r" id="toc-least-squares-estimators-equal-r" class="nav-link" data-scroll-target="#least-squares-estimators-equal-r">Least Squares Estimators (Equal <span class="math inline">\(r\)</span>)</a></li>
  <li><a href="#estimation-of-sigma2-main-effects-model" id="toc-estimation-of-sigma2-main-effects-model" class="nav-link" data-scroll-target="#estimation-of-sigma2-main-effects-model">Estimation of <span class="math inline">\(\sigma^2\)</span> (Main-Effects Model)</a></li>
  <li><a href="#multiple-comparisons-in-the-main-effects-model" id="toc-multiple-comparisons-in-the-main-effects-model" class="nav-link" data-scroll-target="#multiple-comparisons-in-the-main-effects-model">Multiple Comparisons in the Main-Effects Model</a></li>
  <li><a href="#analysis-of-variance-for-equal-sample-sizes" id="toc-analysis-of-variance-for-equal-sample-sizes" class="nav-link" data-scroll-target="#analysis-of-variance-for-equal-sample-sizes">Analysis of Variance for Equal Sample Sizes</a></li>
  <li><a href="#calculating-sample-sizes" id="toc-calculating-sample-sizes" class="nav-link" data-scroll-target="#calculating-sample-sizes">Calculating Sample Sizes</a></li>
  </ul></li>
  <li><a href="#small-experiments" id="toc-small-experiments" class="nav-link" data-scroll-target="#small-experiments">Small Experiments</a>
  <ul class="collapse">
  <li><a href="#one-observation-per-cell" id="toc-one-observation-per-cell" class="nav-link" data-scroll-target="#one-observation-per-cell">One Observation Per Cell</a></li>
  <li><a href="#analysis-based-on-orthogonal-contrasts" id="toc-analysis-based-on-orthogonal-contrasts" class="nav-link" data-scroll-target="#analysis-based-on-orthogonal-contrasts">Analysis Based on Orthogonal Contrasts</a></li>
  <li><a href="#tukeys-test-for-additivity" id="toc-tukeys-test-for-additivity" class="nav-link" data-scroll-target="#tukeys-test-for-additivity">Tukey’s Test for Additivity</a></li>
  <li><a href="#a-real-experimentair-velocity-experiment" id="toc-a-real-experimentair-velocity-experiment" class="nav-link" data-scroll-target="#a-real-experimentair-velocity-experiment">A Real Experiment—Air Velocity Experiment</a></li>
  </ul></li>
  <li><a href="#r-examples" id="toc-r-examples" class="nav-link" data-scroll-target="#r-examples">R Examples</a>
  <ul class="collapse">
  <li><a href="#model-checking-and-residual-diagnostics" id="toc-model-checking-and-residual-diagnostics" class="nav-link" data-scroll-target="#model-checking-and-residual-diagnostics">Model Checking and Residual Diagnostics</a></li>
  </ul></li>
  <li><a href="#two-way-anova-models-in-r" id="toc-two-way-anova-models-in-r" class="nav-link" data-scroll-target="#two-way-anova-models-in-r">Two-Way ANOVA Models in R</a>
  <ul class="collapse">
  <li><a href="#fitting-the-two-way-complete-model" id="toc-fitting-the-two-way-complete-model" class="nav-link" data-scroll-target="#fitting-the-two-way-complete-model">Fitting the Two-Way Complete Model</a></li>
  <li><a href="#type-i-vs.-type-iii-sums-of-squares" id="toc-type-i-vs.-type-iii-sums-of-squares" class="nav-link" data-scroll-target="#type-i-vs.-type-iii-sums-of-squares">Type I vs.&nbsp;Type III Sums of Squares</a></li>
  <li><a href="#fitting-the-cell-means-model" id="toc-fitting-the-cell-means-model" class="nav-link" data-scroll-target="#fitting-the-cell-means-model">Fitting the Cell-Means Model</a></li>
  <li><a href="#example-reaction-time-experiment" id="toc-example-reaction-time-experiment" class="nav-link" data-scroll-target="#example-reaction-time-experiment">Example: Reaction Time Experiment</a></li>
  </ul></li>
  <li><a href="#contrasts-and-multiple-comparisons" id="toc-contrasts-and-multiple-comparisons" class="nav-link" data-scroll-target="#contrasts-and-multiple-comparisons">Contrasts and Multiple Comparisons</a>
  <ul class="collapse">
  <li><a href="#main-effect-contrasts" id="toc-main-effect-contrasts" class="nav-link" data-scroll-target="#main-effect-contrasts">Main-Effect Contrasts</a></li>
  <li><a href="#multiple-comparison-procedures" id="toc-multiple-comparison-procedures" class="nav-link" data-scroll-target="#multiple-comparison-procedures">Multiple Comparison Procedures</a>
  <ul class="collapse">
  <li><a href="#tukey-example" id="toc-tukey-example" class="nav-link" data-scroll-target="#tukey-example">Tukey Example</a></li>
  </ul></li>
  <li><a href="#dunnett-example" id="toc-dunnett-example" class="nav-link" data-scroll-target="#dunnett-example">Dunnett Example</a></li>
  <li><a href="#handling-unequal-sample-sizes" id="toc-handling-unequal-sample-sizes" class="nav-link" data-scroll-target="#handling-unequal-sample-sizes">Handling Unequal Sample Sizes</a></li>
  <li><a href="#one-observation-per-cell-small-experiments" id="toc-one-observation-per-cell-small-experiments" class="nav-link" data-scroll-target="#one-observation-per-cell-small-experiments">One Observation per Cell (Small Experiments)</a></li>
  </ul></li>
  <li><a href="#advanced-topics" id="toc-advanced-topics" class="nav-link" data-scroll-target="#advanced-topics">Advanced Topics</a>
  <ul class="collapse">
  <li><a href="#orthogonal-contrasts" id="toc-orthogonal-contrasts" class="nav-link" data-scroll-target="#orthogonal-contrasts">Orthogonal Contrasts</a></li>
  <li><a href="#model-building-and-type-i-ss" id="toc-model-building-and-type-i-ss" class="nav-link" data-scroll-target="#model-building-and-type-i-ss">Model Building and Type I SS</a></li>
  <li><a href="#r-code-examples-for-plotting" id="toc-r-code-examples-for-plotting" class="nav-link" data-scroll-target="#r-code-examples-for-plotting">R Code Examples for Plotting</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#assignments" id="toc-assignments" class="nav-link" data-scroll-target="#assignments">Assignments</a></li>
  <li><a href="#exams" id="toc-exams" class="nav-link" data-scroll-target="#exams">Exams</a></li>
  <li><a href="#visual-aids" id="toc-visual-aids" class="nav-link" data-scroll-target="#visual-aids">Visual Aids</a></li>
  <li><a href="#appendix-advanced-proofs-and-derivations" id="toc-appendix-advanced-proofs-and-derivations" class="nav-link" data-scroll-target="#appendix-advanced-proofs-and-derivations">Appendix: Advanced Proofs and Derivations</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives</h2>
<ol type="1">
<li>Understand the structure and terminology of two-factor factorial designs.</li>
<li>Distinguish between main effects and interaction effects in a two-way ANOVA.</li>
<li>Conduct a two-way ANOVA, interpret results, and create interaction plots in R.</li>
<li>Handle complexities such as unbalanced designs and understand different types of sums of squares.</li>
</ol>
</section>
<section id="r-packages" class="level2">
<h2 class="anchored" data-anchor-id="r-packages">R Packages</h2>
<p>To run the R code examples in these notes, we recommend installing the following packages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Required R Packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr, ggplot2, lsmeans, emmeans, here, readr)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><strong><code>dplyr</code></strong>: Data manipulation and summarization.</li>
<li><strong><code>ggplot2</code></strong>: Data visualization.</li>
<li><strong><code>lsmeans</code></strong> and <strong><code>emmeans</code></strong>: Post hoc comparisons and multiple comparisons.</li>
<li><strong><code>pacman</code></strong>: Package management.</li>
<li><strong><code>here</code></strong>: File path management.</li>
<li><strong><code>readr</code></strong>: Reading data files.</li>
</ul>
</section>
<section id="checking-the-assumptions-on-the-model" class="level2">
<h2 class="anchored" data-anchor-id="checking-the-assumptions-on-the-model">Checking the Assumptions on the Model</h2>
<p>The assumptions for both the two-way complete model and the two-way main-effects model are that the error random variables have equal variances, are mutually independent, and are normally distributed. The strategy for checking these assumptions follows the procedures outlined in Chapter 5 (see Dean et al.&nbsp;2017).</p>
<section id="standardized-residuals" class="level3">
<h3 class="anchored" data-anchor-id="standardized-residuals">Standardized Residuals</h3>
<p>The standardized residuals are computed as</p>
<p><span class="math display">\[
z_{ijt} = \frac{y_{ijt} - \hat{y}_{ijt}}{\sqrt{SS_{Error}/(n - 1)}},
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(\hat{y}_{ijt} = \hat{\tau}_{ij} = \hat{\alpha}_i + \hat{\beta}_j + (\alpha\beta)_{ij}\)</span> (two-way complete model), or</li>
<li><span class="math inline">\(\hat{y}_{ijt} = \hat{\tau}_{ij} = \hat{\alpha}_i + \hat{\beta}_j\)</span> (two-way main-effects model),</li>
</ul>
<p>depending on which model is used. A “hat” denotes a least squares estimate.</p>
<p>Typical residual plots to check:</p>
<ul>
<li><strong>Observation Order vs.&nbsp;Residuals</strong> to assess independence.</li>
<li><strong>Levels of Each Factor (and possibly <span class="math inline">\(\hat{y}_{ijt}\)</span>) vs.&nbsp;Residuals</strong> to detect outliers and variance inhomogeneity.</li>
<li><strong>Normal Q-Q Plot (Normal Scores)</strong> to assess normality.</li>
</ul>
<p>When using the main-effects model, interaction plots (e.g., Figures 6.1, 6.2 in reference texts) help visualize any potential interaction. Another method is to plot standardized residuals against one factor’s levels while labeling or grouping by the second factor’s levels.</p>
</section>
</section>
<section id="contrasts" class="level1">
<h1>Contrasts</h1>
<section id="contrasts-for-main-effects-and-interactions" class="level2">
<h2 class="anchored" data-anchor-id="contrasts-for-main-effects-and-interactions">Contrasts for Main Effects and Interactions</h2>
<p>Recalling the cell-means model</p>
<p><span class="math display">\[
y_{ijt} = \mu + \tau_{ij} + \varepsilon_{ijt},
\]</span></p>
<p>equivalent to a one-way ANOVA model with <span class="math inline">\(ab\)</span> treatments, we have that all contrasts in <span class="math inline">\(\tau_{ij}\)</span> are estimable. In two-way layouts, common contrasts include:</p>
<ol type="1">
<li><strong>Treatment Contrasts</strong> <span class="math inline">\(\sum_{i,j} d_{ij}\,\tau_{ij}\)</span>.</li>
<li><strong>Interaction Contrasts</strong> measure non-parallelism in interaction plots. For instance,</li>
</ol>
<p><span class="math display">\[
(\tau_{sh} - \tau_{(s+1)h}) - (\tau_{sq} - \tau_{(s+1)q}).
\]</span></p>
<p>Using the two-way complete model <span class="math inline">\(\tau_{ij} = \alpha_i + \beta_j + (\alpha\beta)_{ij}\)</span>, an interaction contrast zeroes out if <span class="math inline">\((\alpha\beta)_{ij}=0\)</span> for all <span class="math inline">\(i,j\)</span>.</p>
</section>
<section id="writing-contrasts-as-coefficient-lists" class="level2">
<h2 class="anchored" data-anchor-id="writing-contrasts-as-coefficient-lists">Writing Contrasts as Coefficient Lists</h2>
<p>When working in the two-way complete model, we can express contrasts in two ways:</p>
<ul>
<li>As a list of coefficients of <span class="math inline">\(\alpha_i^*\)</span>, <span class="math inline">\(\beta_j^*\)</span>, and <span class="math inline">\((\alpha\beta)_{ij}\)</span>.</li>
<li>As a list of coefficients of the <span class="math inline">\(\tau_{ij}\)</span>.</li>
</ul>
<p><strong>Example 6.3.1 (Battery Experiment)</strong> A two-factor experiment with two levels each: “duty” (1 = alkaline, 2 = heavy duty) and “brand” (1 = name brand, 2 = store brand). Treatment combinations are <span class="math inline">\((1,1)\)</span>, <span class="math inline">\((1,2)\)</span>, <span class="math inline">\((2,1)\)</span>, and <span class="math inline">\((2,2)\)</span>, each with <span class="math inline">\(r=4\)</span> observations. An interaction contrast might be</p>
<p><span class="math display">\[
\tau_{11} - \tau_{12} - \tau_{21} + \tau_{22}
\;=\; (\alpha\beta)_{11} - (\alpha\beta)_{12} - (\alpha\beta)_{21} + (\alpha\beta)_{22}.
\]</span></p>
</section>
</section>
<section id="analysis-of-the-two-way-complete-model" class="level1">
<h1>Analysis of the Two-Way Complete Model</h1>
<p>When two factors may interact, we often begin with:</p>
<ol type="1">
<li><strong>Two-Way Complete Model</strong> (also called the full cell-means model),</li>
</ol>
<p><span class="math display">\[
y_{ijt} = \mu + \alpha_i + \beta_j + (\alpha\beta)_{ij} + \varepsilon_{ijt}, \quad \varepsilon_{ijt}\sim \text{N}(0,\sigma^2).
\]</span></p>
<ol type="1">
<li><strong>Hypothesis Test for No Interaction</strong>. If there is insufficient evidence of interaction, we proceed to examine main effects under the same complete model. If interaction is significant, we return to the cell-means perspective to compare treatment combinations directly.</li>
</ol>
<section id="least-squares-estimators" class="level2">
<h2 class="anchored" data-anchor-id="least-squares-estimators">Least Squares Estimators</h2>
<p>From standard ANOVA theory,</p>
<ul>
<li><span class="math inline">\(\hat{\mu} + \hat{\tau}_{ij} = \hat{\mu} + \hat{\alpha}_i + \hat{\beta}_j + \widehat{(\alpha\beta)}_{ij} = \bar{Y}_{ij\cdot}\)</span>,</li>
<li><span class="math inline">\(\text{Var}(\bar{Y}_{ij\cdot}) = \sigma^2 / r_{ij}\)</span>.</li>
</ul>
<p>An interaction contrast <span class="math inline">\(\sum_{i,j} d_{ij}\,\tau_{ij}\)</span> has LSE <span class="math inline">\(\sum_{i,j} d_{ij}\,\bar{Y}_{ij\cdot}\)</span> with variance <span class="math inline">\(\sigma^2 \sum d_{ij}^2/r_{ij}\)</span>.</p>
</section>
<section id="estimation-of-sigma2" class="level2">
<h2 class="anchored" data-anchor-id="estimation-of-sigma2">Estimation of <span class="math inline">\(\sigma^2\)</span></h2>
<p>Because the two-way complete model is equivalent to a one-way ANOVA with <span class="math inline">\(ab\)</span> cells, an unbiased estimate of <span class="math inline">\(\sigma^2\)</span> is obtained via the error sum of squares:</p>
<p><span class="math display">\[
SS_{Error} = \sum_{i,j,t} (y_{ijt} - \bar{Y}_{ij\cdot})^2,
\]</span></p>
<p>with <span class="math inline">\(v = ab\)</span> levels and <span class="math inline">\(n = \sum_{i,j} r_{ij}\)</span> total observations. The corresponding mean square error is</p>
<p><span class="math display">\[
MS_{Error} = \frac{SS_{Error}}{n - v}.
\]</span></p>
<p><strong>Example 6.4.2 (Reaction Time Experiment)</strong> A pilot experiment with <span class="math inline">\(a=2\)</span> levels of “Cue Stimulus” and <span class="math inline">\(b=3\)</span> levels of “Cue Time,” each having <span class="math inline">\(r=3\)</span> replications, yields data in Table 6.2. The sum of squares for error is computed as</p>
<p><span class="math display">\[
SS_{Error} = \sum_{i,j,t} y_{ijt}^2 \;-\; \sum_{i,j} \frac{r_{ij}\,\bar{Y}_{ij\cdot}^2}{\cdot} \;=\; 0.00347,
\]</span></p>
<p>and hence <span class="math inline">\(MS_{Error} = SS_{Error}/(n-ab)\)</span>.</p>
<section id="multiple-comparisons-with-unequal-variances" class="level3">
<h3 class="anchored" data-anchor-id="multiple-comparisons-with-unequal-variances">Multiple Comparisons with Unequal Variances</h3>
<p>If variance heterogeneity persists and cannot be corrected by transformations, one can use Satterthwaite’s approximation (Christensen 2018).</p>
</section>
</section>
<section id="analysis-of-variance-for-the-complete-model" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-variance-for-the-complete-model">Analysis of Variance for the Complete Model</h2>
<p>We commonly examine three hypotheses:</p>
<ol type="1">
<li><strong>Interaction</strong> <span class="math inline">\(H_{0}^{AB}\)</span>: <span class="math inline">\((\alpha\beta)_{ij} = 0\)</span> for all <span class="math inline">\(i,j\)</span>.</li>
<li><strong>Main Effect of A</strong> <span class="math inline">\(H_{0}^{A}\)</span>: <span class="math inline">\(\alpha_1^* = \alpha_2^* = \cdots = \alpha_a^*\)</span>.</li>
<li><strong>Main Effect of B</strong> <span class="math inline">\(H_{0}^{B}\)</span>: <span class="math inline">\(\beta_1^* = \beta_2^* = \cdots = \beta_b^*\)</span>.</li>
</ol>
<p>If <span class="math inline">\(H_{0}^{AB}\)</span> is not rejected, we then focus on main effects. Otherwise, the cell-means model is typically used to compare all <span class="math inline">\(ab\)</span> treatment combinations.</p>
<p><strong>Example 6.4.5 (Reaction Time Experiment, continued)</strong> An ANOVA table yields:</p>
<ul>
<li><span class="math inline">\(MS_{AB}/MS_{Error} = 1.46 &lt; F_{2,12,0.01} = 6.93\)</span> (Fail to reject interaction)</li>
<li><span class="math inline">\(MS_{A}/MS_{Error} = 81.38 &gt; 9.33\)</span> (Reject <span class="math inline">\(H_{0}^{A}\)</span>)</li>
<li><span class="math inline">\(MS_{B}/MS_{Error} = 2.00 &lt; 6.93\)</span> (Fail to reject <span class="math inline">\(H_{0}^{B}\)</span>)</li>
</ul>
</section>
</section>
<section id="analysis-of-the-two-way-main-effects-model" class="level1">
<h1>Analysis of the Two-Way Main-Effects Model</h1>
<p>When the interaction is deemed negligible (or theoretically disallowed), the <strong>two-way main-effects model</strong> is:</p>
<p><span class="math display">\[
y_{ijt} = \mu + \alpha_i + \beta_j + \varepsilon_{ijt},
\quad \varepsilon_{ijt} \sim \text{N}(0,\sigma^2).
\]</span></p>
<section id="least-squares-estimators-equal-r" class="level2">
<h2 class="anchored" data-anchor-id="least-squares-estimators-equal-r">Least Squares Estimators (Equal <span class="math inline">\(r\)</span>)</h2>
<p>If <span class="math inline">\(r\)</span> is constant across all <span class="math inline">\(ab\)</span> cells, the LSE of <span class="math inline">\(E[y_{ijt}] = \mu + \alpha_i + \beta_j\)</span> is</p>
<p><span class="math display">\[
\hat{\mu} + \hat{\alpha}_i + \hat{\beta}_j = \bar{Y}_{i\cdot\cdot} + \bar{Y}_{\cdot j \cdot} - \bar{Y}_{\cdot\cdot\cdot}.
\]</span></p>
<p>Pairwise comparisons (e.g., <span class="math inline">\(\alpha_p - \alpha_s\)</span>) become <span class="math inline">\(\bar{Y}_{p\cdot\cdot} - \bar{Y}_{s\cdot\cdot}\)</span>.</p>
<p><strong>Example 6.5.1 (Nail Varnish Experiment)</strong> Two solvents (<span class="math inline">\(A\)</span>) and three brands of varnish (<span class="math inline">\(B\)</span>), each with <span class="math inline">\(r=5\)</span>. From the data, the difference in solvents is estimated as</p>
<p><span class="math display">\[
\hat{\alpha}_1 - \hat{\alpha}_2 = \bar{Y}_{1\cdot\cdot} - \bar{Y}_{2\cdot\cdot} \approx -3.6040.
\]</span></p>
</section>
<section id="estimation-of-sigma2-main-effects-model" class="level2">
<h2 class="anchored" data-anchor-id="estimation-of-sigma2-main-effects-model">Estimation of <span class="math inline">\(\sigma^2\)</span> (Main-Effects Model)</h2>
<p>With <span class="math inline">\(n = abr\)</span>, the sum of squares of errors is</p>
<p><span class="math display">\[
SS_{Error} = \sum_{i=1}^a \sum_{j=1}^b \sum_{t=1}^{r}
\left( y_{ijt} - \bar{Y}_{i\cdot\cdot} - \bar{Y}_{\cdot j \cdot} + \bar{Y}_{\cdot\cdot\cdot}\right)^2.
\]</span></p>
<p>Then</p>
<p><span class="math display">\[
MS_{Error} = \frac{SS_{Error}}{n - a - b + 1}.
\]</span></p>
<p><strong>Example 6.5.2 (Nail Varnish Experiment, continued)</strong> With <span class="math inline">\(a=2\)</span>, <span class="math inline">\(b=3\)</span>, <span class="math inline">\(r=5\)</span>, the sum of squares <span class="math inline">\(SS_{Error}=216.7762\)</span> and <span class="math inline">\(MS_{Error} = 216.7762/(30-2-3+1) \approx 8.3375\)</span>.</p>
</section>
<section id="multiple-comparisons-in-the-main-effects-model" class="level2">
<h2 class="anchored" data-anchor-id="multiple-comparisons-in-the-main-effects-model">Multiple Comparisons in the Main-Effects Model</h2>
<p>For equal sample sizes, Tukey, Bonferroni, and Scheffé methods still apply to main-effect contrasts. For example, a set of 100<span class="math inline">\((1-\alpha)\%\)</span> simultaneous CIs for factor-A contrasts has the form:</p>
<p><span class="math display">\[
\sum_i c_i \alpha_i \;\in\; \sum_i c_i \bar{Y}_{i\cdot\cdot}
\;\pm\; w \; \sqrt{MS_{Error} \,\sum_i \frac{c_i^2}{br}},
\]</span></p>
<p>where <span class="math inline">\(w\)</span> depends on the chosen procedure (Dean et al.&nbsp;2017).</p>
<p><strong>Example 6.5.3 (Nail Varnish Experiment, continued)</strong> Simultaneous confidence intervals for differences among three varnishes can be constructed via Tukey’s HSD with <span class="math inline">\(q_{3,26,0.01} = 4.54\)</span>.</p>
</section>
<section id="analysis-of-variance-for-equal-sample-sizes" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-variance-for-equal-sample-sizes">Analysis of Variance for Equal Sample Sizes</h2>
<p>When <span class="math inline">\(r\)</span> is constant:</p>
<ul>
<li><span class="math inline">\(H_{0}^B: \{\beta_1 = \beta_2 = \dots = \beta_b\}\)</span> is tested via</li>
</ul>
<p><span class="math display">\[
\text{reject if}\;\; \frac{MS_{B}}{MS_{Error}} &gt; F_{b-1,\,n-a-b+1,\,\alpha}.
\]</span></p>
<ul>
<li><span class="math inline">\(H_{0}^A: \{\alpha_1 = \alpha_2 = \dots = \alpha_a\}\)</span> analogously.</li>
</ul>
<p><strong>Example 6.5.4 (Nail Varnish Experiment)</strong> An ANOVA table yields <span class="math inline">\(F\)</span>-ratios for factor <span class="math inline">\(A\)</span> (solvent) and factor <span class="math inline">\(B\)</span> (varnish). Solvent is significant while varnish is not.</p>
</section>
<section id="calculating-sample-sizes" class="level2">
<h2 class="anchored" data-anchor-id="calculating-sample-sizes">Calculating Sample Sizes</h2>
<p>Both the power-based approach (Sections 3.6) and confidence-interval-width approach (Sections 4.5) can be extended to two-way designs (Montgomery 2020). For main-effect differences of size <span class="math inline">\(A\)</span> or <span class="math inline">\(B\)</span>, formulas such as</p>
<p><span class="math display">\[
r = \frac{2a\,\sigma^2\,\phi^2}{b\,A^2}, \quad
r = \frac{2b\,\sigma^2\,\phi^2}{a\,B^2}
\]</span></p>
<p>may be used to assure adequate power, where <span class="math inline">\(\phi\)</span> is a function of the noncentral <span class="math inline">\(F\)</span>-distribution (see also Christensen 2018).</p>
</section>
</section>
<section id="small-experiments" class="level1">
<h1>Small Experiments</h1>
<section id="one-observation-per-cell" class="level2">
<h2 class="anchored" data-anchor-id="one-observation-per-cell">One Observation Per Cell</h2>
<p>When <span class="math inline">\(r=1\)</span> per cell, if an interaction is possible, we cannot estimate <span class="math inline">\(\sigma^2\)</span> directly (because <span class="math inline">\(\text{df for error} = ab(r-1) = 0\)</span>). The study design must:</p>
<ul>
<li>Assume interaction is negligible (use main-effects model), <strong>or</strong></li>
<li>Have <span class="math inline">\(\sigma^2\)</span> known in advance, <strong>or</strong></li>
<li>Model only a reduced set of contrasts (sparsity of effects).</li>
</ul>
</section>
<section id="analysis-based-on-orthogonal-contrasts" class="level2">
<h2 class="anchored" data-anchor-id="analysis-based-on-orthogonal-contrasts">Analysis Based on Orthogonal Contrasts</h2>
<p>Two contrasts <span class="math inline">\(c_i\tau_i\)</span> and <span class="math inline">\(k_i\tau_i\)</span> are <strong>orthogonal</strong> if</p>
<p><span class="math display">\[
\sum_i \frac{c_i\,k_i}{r_i} = 0.
\]</span></p>
<p>A <strong>complete set</strong> of <span class="math inline">\(v-1\)</span> orthogonal contrasts partitions the treatment sum of squares:</p>
<p><span class="math display">\[
SS_{Total} = \sum_{q=1}^{v-1} SS_{c_q}.
\]</span></p>
<p><strong>Example 6.7.1 (Battery Experiment, continued)</strong> Duty, brand, and interaction contrasts form a complete set of <span class="math inline">\(3\)</span> orthogonal contrasts for <span class="math inline">\(4\)</span> total treatments, and their sums of squares add to the total.</p>
</section>
<section id="tukeys-test-for-additivity" class="level2">
<h2 class="anchored" data-anchor-id="tukeys-test-for-additivity">Tukey’s Test for Additivity</h2>
<p>When the interaction is thought to be of the form <span class="math inline">\((\alpha\beta)_{ij} = \gamma\,\alpha_i\,\beta_j\)</span>, Tukey’s test uses only 1 df. The decision rule is</p>
<p><span class="math display">\[
\text{reject } H_0^\gamma \text{ if }
\frac{ss_{AB}^*}{SS_{Error}/e} &gt; F_{1,e,\alpha},
\]</span></p>
<p>where <span class="math inline">\(ss_{AB}^*\)</span> is a computed sum of squares specifically for that parametric form of interaction.</p>
</section>
<section id="a-real-experimentair-velocity-experiment" class="level2">
<h2 class="anchored" data-anchor-id="a-real-experimentair-velocity-experiment">A Real Experiment—Air Velocity Experiment</h2>
<p>Table 6.11 shows data on air velocity for three rib heights (<span class="math inline">\(A\)</span>) and six Reynolds numbers (<span class="math inline">\(B\)</span>) with <span class="math inline">\(r=1\)</span> per cell. Investigators suspected some interaction but believed certain higher-order trends would be negligible. They pooled those negligible interaction contrasts for an error estimate with 3 df, then tested the remaining contrasts individually. See Table 6.12 for the resulting ANOVA.</p>
</section>
</section>
<section id="r-examples" class="level1 page-columns page-full">
<h1>R Examples</h1>
<p>Below are some step-by-step R code fragments illustrating how to fit these two-way ANOVA models and check assumptions.</p>
<div id="tbl-react-example" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-react-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Reaction Time Experiment</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose 'df' is a Data Frame with Columns: CueStim, CueTime, ReactionTime</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># CueStim Has 2 Levels (Auditory, Visual); CueTime Has 3 Levels (5s, 10s, 15s).</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>react_df <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_table</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"dean2017"</span>, <span class="st">"reaction.time.txt"</span>))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create trtmt combo vbl TC and factors fTC, fA, and fB within data set</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>react_df <span class="ot">&lt;-</span> <span class="fu">within</span>(react_df, {</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    TC <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">*</span> A <span class="sc">+</span> B</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    fTC <span class="ot">&lt;-</span> <span class="fu">factor</span>(TC)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    fA <span class="ot">&lt;-</span> <span class="fu">factor</span>(A)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    fB <span class="ot">&lt;-</span> <span class="fu">factor</span>(B)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(react_df[, <span class="fu">c</span>(<span class="st">"fA"</span>, <span class="st">"fB"</span>, <span class="st">"fTC"</span>, <span class="st">"y"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> fA    fB    fTC          y         
 1:9   1:6   11:3   Min.   :0.1670  
 2:9   2:6   12:3   1st Qu.:0.1898  
       3:6   13:3   Median :0.2355  
             21:3   Mean   :0.2281  
             22:3   3rd Qu.:0.2595  
             23:3   Max.   :0.2830  </code></pre>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-react-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Reaction Time Experiment
</figcaption>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Fit the Two-way ANOVA (full model)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>modelAB <span class="ot">&lt;-</span> <span class="fu">aov</span>(y <span class="sc">~</span> fA <span class="sc">+</span> fB <span class="sc">+</span> fA<span class="sc">:</span>fB, <span class="at">data =</span> react_df)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelAB) <span class="co"># Type I ANOVA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">Sum Sq</th>
<th style="text-align: right;">Mean Sq</th>
<th style="text-align: right;">F value</th>
<th style="text-align: right;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">fA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0235445</td>
<td style="text-align: right;">0.0235445</td>
<td style="text-align: right;">81.375000</td>
<td style="text-align: right;">0.0000011</td>
</tr>
<tr class="even">
<td style="text-align: left;">fB</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0011581</td>
<td style="text-align: right;">0.0005791</td>
<td style="text-align: right;">2.001344</td>
<td style="text-align: right;">0.1777992</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fA:fB</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0008463</td>
<td style="text-align: right;">0.0004232</td>
<td style="text-align: right;">1.462558</td>
<td style="text-align: right;">0.2701353</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.0034720</td>
<td style="text-align: right;">0.0002893</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(modelAB, <span class="sc">~</span>., <span class="at">test =</span> <span class="st">"F"</span>) <span class="co"># Type III ANOVA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">Sum of Sq</th>
<th style="text-align: right;">RSS</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">F value</th>
<th style="text-align: right;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><none></none></td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.0034720</td>
<td style="text-align: right;">-141.9611</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">fA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0104167</td>
<td style="text-align: right;">0.0138887</td>
<td style="text-align: right;">-119.0070</td>
<td style="text-align: right;">36.002304</td>
<td style="text-align: right;">0.0000621</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fB</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0018802</td>
<td style="text-align: right;">0.0053522</td>
<td style="text-align: right;">-138.1711</td>
<td style="text-align: right;">3.249232</td>
<td style="text-align: right;">0.0745201</td>
</tr>
<tr class="even">
<td style="text-align: left;">fA:fB</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0008463</td>
<td style="text-align: right;">0.0043183</td>
<td style="text-align: right;">-142.0346</td>
<td style="text-align: right;">1.462558</td>
<td style="text-align: right;">0.2701353</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>modelTC <span class="ot">&lt;-</span> <span class="fu">aov</span>(y <span class="sc">~</span> fTC, <span class="at">data =</span> react_df)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelTC) <span class="co"># Model F-test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">Sum Sq</th>
<th style="text-align: right;">Mean Sq</th>
<th style="text-align: right;">F value</th>
<th style="text-align: right;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">fTC</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.0255489</td>
<td style="text-align: right;">0.0051098</td>
<td style="text-align: right;">17.66056</td>
<td style="text-align: right;">3.66e-05</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.0034720</td>
<td style="text-align: right;">0.0002893</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Reaction Time Example</p>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Post-hoc Contrasts</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Main-effect-of-B contrast: B1-B2</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>lsmB <span class="ot">&lt;-</span> lsmeans<span class="sc">::</span><span class="fu">lsmeans</span>(modelAB, <span class="sc">~</span>fB)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">contrast</span>(lsmB, <span class="fu">list</span>(<span class="at">B12 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>))), <span class="at">infer =</span> <span class="fu">c</span>(T, T))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># AB-interaction contrast: AB11-AB13-AB21+AB23</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>lsmAB <span class="ot">&lt;-</span> <span class="fu">lsmeans</span>(modelAB, <span class="sc">~</span> fB<span class="sc">:</span>fA) <span class="co"># Using "fB:fA" yields AB lex order</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>lsmAB <span class="co"># Display to see order of AB combos for contrast coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> fB fA lsmean      SE df lower.CL upper.CL
 1  1   0.185 0.00982 12    0.164    0.206
 2  1   0.179 0.00982 12    0.157    0.200
 3  1   0.212 0.00982 12    0.191    0.233
 1  2   0.268 0.00982 12    0.247    0.290
 2  2   0.259 0.00982 12    0.238    0.281
 3  2   0.265 0.00982 12    0.244    0.286

Confidence level used: 0.95 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">contrast</span>(lsmAB, <span class="fu">list</span>(<span class="at">AB =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))), <span class="at">infer =</span> <span class="fu">c</span>(T, T))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple comparisons: B</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lsmB, <span class="at">level =</span> <span class="fl">0.99</span>) <span class="co"># lsmeans for B and 99% CIs</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Tukey’s method</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">contrast</span>(lsmB, <span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>), <span class="at">infer =</span> <span class="fu">c</span>(T, T), <span class="at">level =</span> <span class="fl">0.99</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Dunnett’s method</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">contrast</span>(lsmB, <span class="at">method =</span> <span class="st">"trt.vs.ctrl"</span>, <span class="at">adj =</span> <span class="st">"mvt"</span>, <span class="at">ref =</span> <span class="dv">1</span>), <span class="at">infer =</span> <span class="fu">c</span>(T, T), <span class="at">level =</span> <span class="fl">0.99</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># # 3. Extract Residuals and Fitted Values</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># res &lt;- residuals(model_full)</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># fits &lt;- fitted(model_full)</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># # 4. Diagnostic Plots</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(res ~ fits, main = "Residuals vs. Fitted")</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># qqnorm(res)</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co"># qqline(res)</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co"># # 5. If Interaction is Negligible, Refit Main-effects Model</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co"># model_main &lt;- aov(ReactionTime ~ CueStim + CueTime, data = df)</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(model_main)</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co"># # 6. Multiple Comparisons for CueStim or CueTime if Needed</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co"># # (Tukey's HSD example)</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co"># TukeyHSD(model_main, "CueStim")</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co"># TukeyHSD(model_main, "CueTime")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-contrast-example" class="cell quarto-float quarto-figure quarto-figure-left anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<div aria-describedby="tbl-contrast-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="kable-table">
<table class="do-not-create-environment cell table table-sm table-striped small">
<colgroup>
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 4%">
<col style="width: 15%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">contrast</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">lower.CL</th>
<th style="text-align: right;">upper.CL</th>
<th style="text-align: right;">t.ratio</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">B12</td>
<td style="text-align: right;">0.0076667</td>
<td style="text-align: right;">0.0098206</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">-0.0137306</td>
<td style="text-align: right;">0.0290639</td>
<td style="text-align: right;">0.7806709</td>
<td style="text-align: right;">0.4501222</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output-display">
<div class="kable-table">
<table class="do-not-create-environment cell table table-sm table-striped small">
<colgroup>
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 4%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">contrast</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">lower.CL</th>
<th style="text-align: right;">upper.CL</th>
<th style="text-align: right;">t.ratio</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">AB</td>
<td style="text-align: right;">-0.0303333</td>
<td style="text-align: right;">0.0196412</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">-0.0731279</td>
<td style="text-align: right;">0.0124612</td>
<td style="text-align: right;">-1.544371</td>
<td style="text-align: right;">0.1484504</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output-display">
<div class="kable-table">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">fB</th>
<th style="text-align: right;">lsmean</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">lower.CL</th>
<th style="text-align: right;">upper.CL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.2266667</td>
<td style="text-align: right;">0.0069442</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.2054553</td>
<td style="text-align: right;">0.2478781</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.2190000</td>
<td style="text-align: right;">0.0069442</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.1977886</td>
<td style="text-align: right;">0.2402114</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.2385000</td>
<td style="text-align: right;">0.0069442</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.2172886</td>
<td style="text-align: right;">0.2597114</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output-display">
<div class="kable-table">
<table class="do-not-create-environment cell table table-sm table-striped small">
<colgroup>
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 3%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">contrast</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">lower.CL</th>
<th style="text-align: right;">upper.CL</th>
<th style="text-align: right;">t.ratio</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">fB1 - fB2</td>
<td style="text-align: right;">0.0076667</td>
<td style="text-align: right;">0.0098206</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">-0.0273734</td>
<td style="text-align: right;">0.0427068</td>
<td style="text-align: right;">0.7806709</td>
<td style="text-align: right;">0.7214544</td>
</tr>
<tr class="even">
<td style="text-align: left;">fB1 - fB3</td>
<td style="text-align: right;">-0.0118333</td>
<td style="text-align: right;">0.0098206</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">-0.0468734</td>
<td style="text-align: right;">0.0232068</td>
<td style="text-align: right;">-1.2049485</td>
<td style="text-align: right;">0.4727382</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fB2 - fB3</td>
<td style="text-align: right;">-0.0195000</td>
<td style="text-align: right;">0.0098206</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">-0.0545401</td>
<td style="text-align: right;">0.0155401</td>
<td style="text-align: right;">-1.9856194</td>
<td style="text-align: right;">0.1581646</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output-display">
<div class="kable-table">
<table class="do-not-create-environment cell table table-sm table-striped small">
<colgroup>
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 3%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">contrast</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">lower.CL</th>
<th style="text-align: right;">upper.CL</th>
<th style="text-align: right;">t.ratio</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">fB2 - fB1</td>
<td style="text-align: right;">-0.0076667</td>
<td style="text-align: right;">0.0098206</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">-0.0409348</td>
<td style="text-align: right;">0.0256015</td>
<td style="text-align: right;">-0.7806709</td>
<td style="text-align: right;">0.6611256</td>
</tr>
<tr class="even">
<td style="text-align: left;">fB3 - fB1</td>
<td style="text-align: right;">0.0118333</td>
<td style="text-align: right;">0.0098206</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">-0.0214348</td>
<td style="text-align: right;">0.0451015</td>
<td style="text-align: right;">1.2049485</td>
<td style="text-align: right;">0.4032893</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-contrast-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Reaction Time Example
</figcaption>
</figure>
</div>
</div>
<section id="model-checking-and-residual-diagnostics" class="level2">
<h2 class="anchored" data-anchor-id="model-checking-and-residual-diagnostics">Model Checking and Residual Diagnostics</h2>
<p>Before finalizing an ANOVA conclusion, we must check:</p>
<ul>
<li><strong>Independence</strong>: Plot residuals vs.&nbsp;observation order.</li>
<li><strong>Constant Variance</strong>: Plot residuals (or standardized residuals) vs.&nbsp;fitted values, factor levels, or treatment combos.</li>
<li><strong>Normality</strong>: Use a Normal Q-Q plot of residuals.</li>
</ul>
<p>The <strong>standardized residual</strong> often used is:</p>
<p><span class="math display">\[
z_{ijt} = \frac{y_{ijt} - \hat{y}_{ijt}}{\sqrt{\tfrac{SS_{Error}}{n - 1}}}.
\]</span></p>
<p>Depending on whether we assume a complete or main-effects model, <span class="math inline">\(\hat{y}_{ijt}\)</span> includes:</p>
<ul>
<li><span class="math inline">\(\hat{\tau}_{ij} = \hat{\alpha}_i + \hat{\beta}_j + \widehat{(\alpha\beta)}_{ij}\)</span> (complete model), or</li>
<li><span class="math inline">\(\hat{\tau}_{ij} = \hat{\alpha}_i + \hat{\beta}_j\)</span> (main-effects model).</li>
</ul>
</section>
</section>
<section id="two-way-anova-models-in-r" class="level1">
<h1>Two-Way ANOVA Models in R</h1>
<p>This section demonstrates how to fit and interpret two-way ANOVA models in R, focusing on attached code examples. We assume a data frame such as <code>react.data</code> containing:</p>
<ul>
<li><code>A</code>, <code>B</code>: numerical or factor-coded levels of Factors A and B,</li>
<li><code>y</code>: the response,</li>
<li>potentially additional identifying information (observation order, treatment codes, etc.).</li>
</ul>
<section id="fitting-the-two-way-complete-model" class="level2">
<h2 class="anchored" data-anchor-id="fitting-the-two-way-complete-model">Fitting the Two-Way Complete Model</h2>
<p>A typical R formula for the two-way complete model is:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>modelAB <span class="ot">=</span> <span class="fu">aov</span>(y <span class="sc">~</span> fA <span class="sc">+</span> fB <span class="sc">+</span> fA<span class="sc">:</span>fB, <span class="at">data =</span> react_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>or equivalently:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>modelAB <span class="ot">=</span> <span class="fu">aov</span>(y <span class="sc">~</span> fA <span class="sc">*</span> fB, <span class="at">data =</span> react_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Here, <code>fA</code> and <code>fB</code> are <strong>factor variables</strong> in R. The operator <code>*</code> adds both main effects and the interaction term. We often check:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelAB)        <span class="co"># "Type I" sums of squares</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(modelAB, <span class="sc">~</span>., <span class="at">test =</span> <span class="st">"F"</span>)  <span class="co"># "Type III" sums of squares</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="type-i-vs.-type-iii-sums-of-squares" class="level2">
<h2 class="anchored" data-anchor-id="type-i-vs.-type-iii-sums-of-squares">Type I vs.&nbsp;Type III Sums of Squares</h2>
<ul>
<li><strong>Type I</strong> (Sequential) sums of squares: Variation explained by adding each term in sequence.</li>
<li><strong>Type III</strong> sums of squares: Variation explained by each term after adjusting for all other terms in the model.
<ul>
<li>Requires <code>options(contrasts = c("contr.sum", "contr.poly"))</code> for balanced constraints.</li>
</ul></li>
</ul>
</section>
<section id="fitting-the-cell-means-model" class="level2">
<h2 class="anchored" data-anchor-id="fitting-the-cell-means-model">Fitting the Cell-Means Model</h2>
<p>An alternative is the <strong>cell-means model</strong>, which estimates each τij_{ij} directly:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>modelTC <span class="ot">=</span> <span class="fu">aov</span>(y <span class="sc">~</span> fTC, <span class="at">data =</span> react_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>where <code>fTC</code> is a factor that indicates each treatment combination (i,j)(i,j). This approach is ideal for more direct comparisons of the individual cell means.</p>
</section>
<section id="example-reaction-time-experiment" class="level2">
<h2 class="anchored" data-anchor-id="example-reaction-time-experiment">Example: Reaction Time Experiment</h2>
<p>In the pasted notes, an experiment with Factor A = “Cue Stimulus” (a=2a=2 levels), Factor B = “Cue Time” (b=3b=3 levels), and unequal replicates is demonstrated. Output from <code>anova(modelAB)</code>, <code>drop1(modelAB, ~., test="F")</code>, and <code>anova(modelTC)</code>:</p>
<ul>
<li><strong>Interaction</strong> not significant,</li>
<li><strong>Factor A</strong> is significant,</li>
<li><strong>Factor B</strong> is not significant.</li>
</ul>
</section>
</section>
<section id="contrasts-and-multiple-comparisons" class="level1">
<h1>Contrasts and Multiple Comparisons</h1>
<p>Once we fit the model, we often need <strong>post hoc</strong> comparisons among factor levels or interactions. R packages like <strong><code>lsmeans</code></strong> (or <code>emmeans</code> in newer versions) facilitate this.</p>
<section id="main-effect-contrasts" class="level2">
<h2 class="anchored" data-anchor-id="main-effect-contrasts">Main-Effect Contrasts</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>lsmB <span class="ot">=</span> <span class="fu">lsmeans</span>(modelAB, <span class="sc">~</span> fB)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">contrast</span>(lsmB, <span class="fu">list</span>(<span class="at">B12 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>))), <span class="at">infer =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This obtains the contrast β1−β2_1 - _2 for Factor B. We can similarly construct more complex contrasts or even interaction contrasts:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>lsmAB <span class="ot">=</span> <span class="fu">lsmeans</span>(modelAB, <span class="sc">~</span> fB<span class="sc">:</span>fA)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">contrast</span>(lsmAB, <span class="fu">list</span>(<span class="at">AB =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))), <span class="at">infer=</span><span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="multiple-comparison-procedures" class="level2">
<h2 class="anchored" data-anchor-id="multiple-comparison-procedures">Multiple Comparison Procedures</h2>
<p>Several methods adjust for <strong>familywise error</strong>:</p>
<ul>
<li><strong>Tukey’s HSD</strong></li>
<li><strong>Bonferroni</strong></li>
<li><strong>Scheffé</strong></li>
<li><strong>Dunnett</strong> (comparing all treatments to a control)</li>
</ul>
<section id="tukey-example" class="level3">
<h3 class="anchored" data-anchor-id="tukey-example">Tukey Example</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(lsmB, <span class="at">method=</span><span class="st">"pairwise"</span>, <span class="at">adjust=</span><span class="st">"tukey"</span>),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">infer =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fl">0.99</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Generates pairwise comparisons among the levels of B with Tukey’s adjustment at 99% confidence.</p>
</section>
</section>
<section id="dunnett-example" class="level2">
<h2 class="anchored" data-anchor-id="dunnett-example">Dunnett Example</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(lsmB, <span class="at">method=</span><span class="st">"trt.vs.ctrl"</span>, <span class="at">adj=</span><span class="st">"mvt"</span>, <span class="at">ref=</span><span class="dv">1</span>),</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">infer =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fl">0.99</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Compares each level of B to the control (the first factor level by default).</p>
</section>
<section id="handling-unequal-sample-sizes" class="level2">
<h2 class="anchored" data-anchor-id="handling-unequal-sample-sizes">Handling Unequal Sample Sizes</h2>
<p>When the sample sizes rijr_{ij} differ, Type I and Type III sums of squares can produce different inferences. <strong>Type III</strong> is standard for “unbalanced” data when we interpret each effect adjusted for the others. The same code is used:</p>
<ul>
<li><code>aov(y ~ fA + fB + fA:fB, data=…)</code></li>
<li><code>drop1(model, ~., test="F")</code></li>
</ul>
<p>but we must ensure <code>contrasts</code> are set to impose consistent constraints.</p>
</section>
<section id="one-observation-per-cell-small-experiments" class="level2">
<h2 class="anchored" data-anchor-id="one-observation-per-cell-small-experiments">One Observation per Cell (Small Experiments)</h2>
<p>When r=1r=1 per cell, there is no direct error estimate under the full <strong>two-way complete model</strong>—the error df is zero. One can:</p>
<ol type="1">
<li>Assume interaction is negligible (use main-effects model only),</li>
<li>Know <span class="math inline">\(\sigma^2\)</span> a priori,</li>
<li>Use <strong>orthogonal contrasts</strong> to identify “negligible” components of the interaction, thereby pooling them to form an error estimate.</li>
</ol>
</section>
</section>
<section id="advanced-topics" class="level1">
<h1>Advanced Topics</h1>
<section id="orthogonal-contrasts" class="level2">
<h2 class="anchored" data-anchor-id="orthogonal-contrasts">Orthogonal Contrasts</h2>
<p>Two contrasts are <strong>orthogonal</strong> if their corresponding sums of squares are uncorrelated. Equivalently, for equal rij=rr_{ij}=r, the sum of products of coefficients must be zero.</p>
</section>
<section id="model-building-and-type-i-ss" class="level2">
<h2 class="anchored" data-anchor-id="model-building-and-type-i-ss">Model Building and Type I SS</h2>
<p>For building or refining a model, <strong>Type I</strong> SS can be used to see how adding each effect in sequence explains residual variation.</p>
</section>
<section id="r-code-examples-for-plotting" class="level2">
<h2 class="anchored" data-anchor-id="r-code-examples-for-plotting">R Code Examples for Plotting</h2>
<ul>
<li><strong>Residual plots</strong>:</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">residuals</span>(modelAB)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>fits <span class="ot">&lt;-</span> <span class="fu">fitted</span>(modelAB)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res <span class="sc">~</span> fits)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(res); <span class="fu">qqline</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>Interaction plots</strong>:</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction.plot</span>(<span class="at">x.factor =</span> react.data<span class="sc">$</span>fA, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trace.factor =</span> react.data<span class="sc">$</span>fB,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">response =</span> react.data<span class="sc">$</span>y, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type=</span><span class="st">"b"</span>, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">xlab=</span><span class="st">"A"</span>, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trace.label=</span><span class="st">"B"</span>, </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab=</span><span class="st">"Mean of y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In these lecture notes, we have explored:</p>
<ol type="1">
<li><strong>Two-way ANOVA models</strong> (complete, main-effects) and their key assumptions.</li>
<li><strong>Model checking</strong> via residual diagnostics to confirm normality, equal variances, and independence.</li>
<li><strong>Contrasts and multiple comparisons</strong> in R using <code>lsmeans</code> (or <code>emmeans</code>), including Type I vs.&nbsp;Type III sums of squares for unbalanced designs.</li>
<li><strong>Handling special cases</strong>, such as one observation per cell, by leveraging orthogonal contrasts or known variance assumptions.</li>
</ol>
<p>These methods allow us to make rigorous inferences about factor main effects and interactions in a two-factor experimental setup. In practice, thorough model checking (especially when cell counts are unequal) ensures valid scientific conclusions and properly calibrated multiple comparisons.</p>
</section>
<section id="assignments" class="level2">
<h2 class="anchored" data-anchor-id="assignments">Assignments</h2>
<ol type="1">
<li><p><strong>Residual Diagnostics</strong></p>
<ul>
<li>Simulate a two-way ANOVA dataset in R, fit the complete model, and produce diagnostic plots for normality, equal variances, and independence.</li>
</ul></li>
<li><p><strong>Interaction Plot Interpretation</strong></p>
<ul>
<li>Provide a small dataset with potential interaction. Plot the interaction and propose how you would test the no-interaction hypothesis.</li>
</ul></li>
<li><p><strong>Orthogonal Contrasts</strong></p>
<ul>
<li>For a <span class="math inline">\(2\times 3\)</span> experiment, list a complete set of orthogonal contrasts for the interaction. Verify their orthogonality.</li>
</ul></li>
<li><p><strong>Power Calculation</strong></p>
<ul>
<li>Assume a <span class="math inline">\(2\times 2\)</span> design with equal sample size <span class="math inline">\(r\)</span> per cell and desired power 0.80 to detect a main-effect difference of 2 (with <span class="math inline">\(\sigma^2\)</span> estimated at 3). Use the power-based formula to find <span class="math inline">\(r\)</span>.</li>
</ul></li>
</ol>
</section>
<section id="exams" class="level2">
<h2 class="anchored" data-anchor-id="exams">Exams</h2>
<p>Consider an exam scenario with both conceptual and computational questions:</p>
<ol type="1">
<li><p><strong>Conceptual</strong></p>
<ul>
<li>Define the assumptions of the two-way complete model. How do you test them?</li>
<li>Explain why we typically test interaction first before examining main effects.</li>
</ul></li>
<li><p><strong>Computational</strong></p>
<ul>
<li>Given raw data for a <span class="math inline">\(3 \times 4\)</span> design, compute and fill in an ANOVA table. Perform an <span class="math inline">\(F\)</span>-test for interaction at <span class="math inline">\(\alpha=0.05\)</span>.</li>
</ul></li>
<li><p><strong>Short Essay</strong></p>
<ul>
<li>Compare and contrast the two-way complete model and the two-way main-effects model. Include real-world examples.</li>
</ul></li>
</ol>
</section>
<section id="visual-aids" class="level2">
<h2 class="anchored" data-anchor-id="visual-aids">Visual Aids</h2>
<ul>
<li><strong>Figure: Interaction Plots</strong> for typical data sets showing:
<ul>
<li>Parallel lines (no interaction).</li>
<li>Clearly crossing lines (significant interaction).</li>
</ul></li>
<li><strong>Figure: Residual Plots</strong> illustrating typical patterns (equal vs.&nbsp;unequal variances, outliers).</li>
<li><strong>Table Templates</strong> for summarizing sample means, sum of squares, and mean squares.</li>
</ul>
</section>
<section id="appendix-advanced-proofs-and-derivations" class="level2">
<h2 class="anchored" data-anchor-id="appendix-advanced-proofs-and-derivations">Appendix: Advanced Proofs and Derivations</h2>
<ol type="1">
<li><strong>Proof of Orthogonality Condition</strong>
<ul>
<li>Show that two contrasts are uncorrelated <span class="math inline">\(\iff \sum (d_{ij} , h_{ij} / r_{ij}) = 0\)</span>.</li>
</ul></li>
<li><strong>Derivation of LSE under Main-Effects Model (Unequal <span class="math inline">\(r\)</span>)</strong>
<ul>
<li>Solve the normal equations for <span class="math inline">\(\hat{\alpha}_i, \hat{\beta}_j\)</span> when <span class="math inline">\(r_{ij}\)</span> differ.</li>
</ul></li>
</ol>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ol type="1">
<li>Dean, A., Voss, D., &amp; Draguljić, D. (2017). <em>Design and Analysis of Experiments</em>. Springer International Publishing. <a href="https://doi.org/10.1007/978-3-319-52250-0">https://doi.org/10.1007/978-3-319-52250-0</a></li>
<li>Christensen, R. (2018). <em>Analysis of Variance, Design, and Regression: Linear Modeling for Unbalanced Data</em> (Second Edition). Chapman and Hall/CRC, imprint of Taylor &amp; Francis.</li>
<li>Montgomery, D. C. (2020). <em>Design and Analysis of Experiments</em> (10th ed.). Wiley.</li>
</ol>


</section>
</section>

</main> <!-- /main -->
<!-- filepath: /Users/dt/Library/CloudStorage/Dropbox/Teaching/DOE/assets/includes/footer.html -->
<footer class="site-footer">
    <div class="container text-center">
        <hr> 
        © <span id="current-year"></span> Dr. Davood Tofighi |
        <a href="https://canvasinfo.unm.edu/">UNM Canvas</a> |
        <a href="https://data-wise.github.io/doe">Course GitHub Page</a> |
    </div>
    <script>
        document.getElementById("current-year").textContent = new Date().getFullYear();
    </script>
</footer>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/Data-Wise\.github\.io\/doe\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>